<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [9]ï¼šå¾ªç¯ç¥ç»ç½‘ç»œRNN</title>
      <link href="/2021/12/08/AI-Algorithm-9-RNN/"/>
      <url>/2021/12/08/AI-Algorithm-9-RNN/</url>
      
        <content type="html"><![CDATA[<h1>å‰è¨€</h1><p>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Networksï¼ŒRNNï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå¸¸å¸¸è¢«ç”¨æ¥å¤„ç†åºåˆ—æ•°æ®ã€‚</p><h1>åŸºæœ¬åŸç†</h1><h2 id="æ„Ÿæ€§è®¤è¯†">æ„Ÿæ€§è®¤è¯†</h2><p>ä¼ ç»Ÿçš„å·ç§¯ç¥ç»ç½‘ç»œçš„ç»“æ„æ¯”è¾ƒç®€å•ï¼šè¾“å…¥å±‚ â€“ éšè—å±‚ â€“ è¾“å‡ºå±‚ã€‚å±‚ä¸å±‚ä¹‹é—´æ˜¯å…¨è¿æ¥çš„ï¼Œå±‚ä¸­å„ç¥ç»å…ƒä¹‹é—´æ²¡æœ‰è¿æ¥ã€‚è€Œå¾ªç¯ç¥ç»ç½‘ç»œä¸­éšè—å±‚çš„ç¥ç»å…ƒç»“ç‚¹ä¹‹é—´æ˜¯æœ‰è¿æ¥çš„ã€‚å‰ä¸€æ¬¡çš„è¾“å‡ºç»“æœï¼Œå¸¦åˆ°ä¸‹ä¸€æ¬¡çš„éšè—å±‚ä¸­ï¼Œä¸€èµ·è®­ç»ƒã€‚ä¸€ä¸ªNLPçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><p>å‡è®¾è¾“å…¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²åæœ‰è‹¥å¹²æœ‰å…ˆåé¡ºåºçš„å•è¯ä½œä¸ºç½‘ç»œè¾“å…¥ï¼š</p><p><img src="/2021/12/08/AI-Algorithm-9-RNN/1.gif" alt="1"></p><p>å…ˆå°† â€œwhatâ€ä½œä¸º RNN çš„è¾“å…¥ï¼Œå¾—åˆ°è¾“å‡º<code>O1</code></p><p><img src="/2021/12/08/AI-Algorithm-9-RNN/2.gif" alt="2.gif"></p><p>å†å°†â€œtimeâ€è¾“å…¥åˆ° RNN ç½‘ç»œï¼Œå¾—åˆ°è¾“å‡º<code>O2</code>ï¼Œè¿™æ—¶<strong>å‰é¢ â€œwhatâ€ çš„è¾“å‡ºä¹Ÿäº§ç”Ÿäº†å½±å“ï¼ˆéšè—å±‚ä¸­æœ‰ä¸€åŠï¼ˆå®šæ€§éå®šé‡ï¼‰æ˜¯é»‘è‰²ï¼‰</strong></p><p><img src="/2021/12/08/AI-Algorithm-9-RNN/3.gif" alt="3.gif"></p><p>ä»¥æ­¤ç±»æ¨ï¼Œåç»­å„è¾“å…¥éƒ½ä¼šå—åˆ°ä¹‹å‰è¾“å‡ºç»“æœçš„å½±å“</p><p><img src="/2021/12/08/AI-Algorithm-9-RNN/4.gif" alt="4.gif"></p><p>æˆ‘ä»¬åªéœ€è¦å…³å¿ƒæœ€ç»ˆçš„è¾“å‡º<code>O5</code></p><p><img src="/2021/12/08/AI-Algorithm-9-RNN/5.gif" alt="5.gif"></p><p>å½“ç„¶RNNçš„ç¼ºç‚¹ä¹Ÿæ˜¾è€Œæ˜“è§ï¼šéšç€æ—¶é—´åºåˆ—çš„å¢åŠ ï¼Œå‰åä¿¡æ¯å…³è”åº¦ä¼šé€æ¸å‡å°ï¼Œå­˜åœ¨æ¨ªå‘æ¢¯åº¦æ¶ˆå¤±ç°è±¡ã€‚è¯´äººè¯å°±æ˜¯è¶Šæ—©è¾“å…¥çš„ä¿¡æ¯å¯¹åç»­çš„å½±å“è¶Šå°ã€‚çŸ­æœŸçš„è®°å¿†å½±å“è¾ƒå¤§ï¼ˆå¦‚æ©™è‰²åŒºåŸŸï¼‰ï¼Œä½†æ˜¯é•¿æœŸçš„è®°å¿†å½±å“å°±å¾ˆå°ï¼ˆå¦‚é»‘è‰²å’Œç»¿è‰²åŒºåŸŸï¼‰ã€‚è¿™å°±æ˜¯ RNN å­˜åœ¨çš„<strong>çŸ­æœŸè®°å¿†</strong>é—®é¢˜ã€‚</p><p><img src="/2021/12/08/AI-Algorithm-9-RNN/1.jpg" alt="1"></p><h2 id="å…¬å¼æ¨å¯¼">å…¬å¼æ¨å¯¼</h2><p>ä¸€ä¸ªç®€å•çš„ RNNç»“æ„å®ä¾‹å¦‚å›¾ï¼š</p><p><img src="/2021/12/08/AI-Algorithm-9-RNN/1.png" alt="1"></p><p>ä¸Šå›¾ä¸­çš„ RNN æ¨¡å‹æœ‰ä¸€ä¸ªè¾“å…¥å±‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span>ï¼Œä¸€ä¸ªéšè—å±‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>å’Œä¸€ä¸ªè¾“å‡ºå±‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>ä¸ºè¿æ¥è¾“å…¥å±‚ä¸éšè—å±‚çš„æƒé‡çŸ©é˜µï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>ä¸ºè¿æ¥éšè—å±‚ä¸è¾“å‡ºå±‚çš„æƒé‡çŸ©é˜µï¼Œè€Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>ä¸ºéšè—å±‚ä¸­å‰èŠ‚ç‚¹åˆ°åèŠ‚ç‚¹çš„æƒé‡çŸ©é˜µã€‚å°†éšè—å±‚çš„ç»“æ„å±•å¼€åï¼Œå¯ä»¥çœ‹å‡ºå¯¹åº”äºä¸åŒæ—¶åˆ»<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>ï¼Œå…¶è¾“å‡º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‘‚</mi><mi>ğ‘¡</mi></msub></mrow><annotation encoding="application/x-tex">ğ‘‚_ğ‘¡</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸ä»…ä»…ä¸å½“å‰æ—¶åˆ»çš„è¾“å…¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‘¥</mi><mi>ğ‘¡</mi></msub></mrow><annotation encoding="application/x-tex">ğ‘¥_ğ‘¡</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>æœ‰å…³ï¼Œè¿˜ä¸ä¸Šä¸€æ—¶åˆ»çš„éšè—å±‚è¾“å‡º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‘†</mi><mrow><mi>ğ‘¡</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">ğ‘†_{ğ‘¡âˆ’1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>æœ‰å…³ã€‚æ€»ç»“ä¸ºå…¬å¼æœ‰ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>O</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>V</mi><msub><mi>S</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>S</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>U</mi><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><mi>W</mi><msub><mi>S</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}O_t&amp;=g(VS_t) \\S_t&amp;=f(Ux_t+WS_{t-1})\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‘”</mi></mrow><annotation encoding="application/x-tex">ğ‘”</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‘“</mi></mrow><annotation encoding="application/x-tex">ğ‘“</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>å‡ä»£è¡¨æ¿€æ´»å‡½æ•°ï¼Œå…¶ä¸­RNNæ¿€æ´»å‡½æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>å¸¸ç”¨ä¸ºtanhï¼Œè‡³äºä¸ºä»€ä¹ˆä¸ç”¨Reluï¼Ÿå¯ä»¥çœ‹<a href="https://www.zhihu.com/question/61265076">è¿™é‡Œ</a></p><p>å°†ä¸Šè¿°ä¸¤ä¸ªå¼å­åˆå¹¶å¯å¾—ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>O</mi><mi>t</mi></msub><mo>=</mo><mi>g</mi><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">(</mo><mi>V</mi><mi>f</mi><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><mi>U</mi><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><mi>W</mi><mi>f</mi><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">(</mo><mi>U</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>W</mi><mi>f</mi><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mi>U</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>2</mn></mrow></msub><mo>+</mo><mi>W</mi><mi>f</mi><mo stretchy="false">(</mo><mi>U</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>3</mn></mrow></msub><mo>+</mo><mo separator="true">â‹…</mo><mo separator="true">â‹…</mo><mo separator="true">â‹…</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">)</mo><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo><mo fence="false" stretchy="true" minsize="3em" maxsize="3em">)</mo></mrow><annotation encoding="application/x-tex">O_t=g\Bigg(Vf\bigg(Ux_t+Wf\Big(Ux_{t-1}+Wf\big(Ux_{t-2}+Wf(Ux_{t-3}+Â·Â·Â·)\big)\Big)\bigg)\Bigg)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord"><span class="delimsizing size4">(</span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord"><span class="delimsizing size1">(</span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">+</span><span class="mpunct">â‹…â‹…â‹…</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">)</span></span><span class="mord"><span class="delimsizing size2">)</span></span><span class="mord"><span class="delimsizing size3">)</span></span><span class="mord"><span class="delimsizing size4">)</span></span></span></span></span></span></p><p>ç”±æ­¤å¯è§ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>æ—¶åˆ»çš„è¾“å‡º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‘‚</mi><mi>ğ‘¡</mi></msub></mrow><annotation encoding="application/x-tex">ğ‘‚_ğ‘¡</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¼šå—åˆ°å½“å‰åŠä»¥å‰è‹¥å¹²æ¬¡çš„è¾“å…¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‘¥</mi><mi>ğ‘¡</mi></msub></mrow><annotation encoding="application/x-tex">ğ‘¥_ğ‘¡</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‘¥</mi><mrow><mi>ğ‘¡</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">ğ‘¥_{ğ‘¡âˆ’1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ‘¥</mi><mrow><mi>ğ‘¡</mi><mo>âˆ’</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">ğ‘¥_{ğ‘¡âˆ’2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>ç­‰çš„å½±å“ï¼Œä¸”åŒä¸€éšè—å±‚ä¼šå…±äº« <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>ç­‰æƒé‡å‚æ•°ï¼Œå³ RNN ä¼šå¯¹ä¸åŒæ—¶åˆ»çš„è¾“å…¥åšç›¸åŒçš„ç‰¹å¾æå–å·¥ä½œï¼Œè¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘å‚æ•°æ•°é‡ã€‚è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œåœ¨å®é™…åº”ç”¨ä¸­åªéœ€è¦æœ€åä¸€å¸§åºåˆ—çš„è¯†åˆ«ç»“æœï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦å°†æ¯ä¸€æ—¶åˆ»çš„éšè—å±‚éƒ½ä¸ä¸€ä¸ªè¾“å‡ºå±‚ç›¸è¿ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥å‡å°‘ä¸å¿…è¦çš„è®¡ç®—ã€‚</p><h1>ä¼˜åŒ–ç®—æ³•ä¹‹LSTM</h1><p>é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆ Long Short-Term Memory networkï¼ŒLSTMï¼‰æ˜¯å¯¹RNNçš„æ”¹è¿›ï¼Œå…¶èƒ½å¤Ÿé¿å…RNNå­˜åœ¨çš„çŸ­æœŸè®°å¿†é—®é¢˜ã€‚å…·ä½“ç®—æ³•åŸç†åç»­æ–‡ç« å†å±•å¼€ã€‚</p><h1>ä¼˜åŒ–ç®—æ³•ä¹‹GRU</h1><p>é—¨æ§é€’å½’å•å…ƒï¼ˆGated Recurrent Unitï¼ŒGRUï¼‰æ˜¯LSTMçš„ä¸€ä¸ªå˜ä½“ã€‚ä¸»è¦æ˜¯åœ¨LSTMæ¨¡å‹çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›ç®€åŒ–å’Œè°ƒæ•´ï¼Œèƒ½å¤Ÿæœ‰æ›´å¥½çš„æ€§èƒ½ã€‚åŒæ ·å…·ä½“ç®—æ³•åŸç†åç»­æ–‡ç« å†å±•å¼€ã€‚</p><h1>å‚è€ƒ</h1><p>[1] <a href="https://easyai.tech/ai-definition/rnn/">https://easyai.tech/ai-definition/rnn/</a></p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Algorithm </tag>
            
            <tag> RNN </tag>
            
            <tag> LSTM </tag>
            
            <tag> GRU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·æ€AIå¼€å‘ [5]ï¼šä¸€èˆ¬é—®é¢˜è®°å½•</title>
      <link href="/2021/12/07/Hi3559AV100-5-NormalQA/"/>
      <url>/2021/12/07/Hi3559AV100-5-NormalQA/</url>
      
        <content type="html"><![CDATA[<h1>Upsample è¾“å…¥é—®é¢˜</h1><p>åœ¨è½¬æ¢SDKä¸­è‡ªå¸¦çš„yolov3æ¨¡å‹ï¼ˆ<code>HiSVP_PC_V1.1.4.0\software\data\detection\yolov3\model\yolov3.prototxt</code>ï¼‰æ—¶ï¼ŒæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š</p><blockquote><p>F0817 15:32:17.480885  1352 layer.hpp:349] Check failed: ExactNumBottomBlobs() == bottom.size() (2 vs. 1) Upsample Layer takes 2 bottom blob(s) as input.</p></blockquote><h2 id="åŸå› ï¼š">åŸå› ï¼š</h2><p>RuyiStudioä¸­caffe Upsampleçš„å®ç°éœ€è¦ä¸¤ä¸ªbottomï¼Œä½†å®é™…æ¨¡å‹prototxtä¸­è¯¥å±‚åªæœ‰ä¸€ä¸ªbottom</p><blockquote><p>one for feature maps, and one for the max-pooling indeices;</p></blockquote><h2 id="è§£å†³æ–¹æ¡ˆï¼š">è§£å†³æ–¹æ¡ˆï¼š</h2><ul><li><ol><li>å¯¹caffe windowçš„æºç è¿›è¡Œä¿®æ”¹ï¼Œç¼–è¯‘ï¼Œå¹¶æ›¿æ¢RuyiStudioçš„å·¥å…·ï¼ˆ<a href="https://blog.csdn.net/jiadongfengyahoo/article/details/117336122">ä¼ é€é—¨</a>ï¼Œè¦é«˜è´µçš„CSDN VIPæ‰èƒ½çœ‹ï¼Œæ²¡å®è·µï¼‰</li></ol></li><li><ol start="2"><li>æœ‰ä¸€è¯´ï¼Œç”¨deconvæ›¿æ¢upsampleï¼Œçœ‹åˆ°æˆ‘ä»¬è‡ªå·±çš„æ¨¡å‹æ˜¯è¿™æ ·åšçš„</li></ol></li></ul><h2 id="å»¶ä¼¸ï¼š">å»¶ä¼¸ï¼š</h2><p>åœ¨ä½¿ç”¨Get Caffe OutputåŠŸèƒ½æ—¶ï¼Œyolov3ä¹Ÿé‡åˆ°åŒæ ·çš„é—®é¢˜</p><h1>pythonç¼ºå°‘rpnæ¨¡å—</h1><p>åœ¨è½¬æ¢æ¨¡å‹æ—¶æŠ¥ä»¥ä¸‹é”™è¯¯</p><blockquote><p>File â€œD:\software\RuyiStudio\Resources\pythonScript\get_caffe_shape.pyâ€, line 28,<br>in <module><br>import rpn<br>ImportError: No module named â€˜rpnâ€™</module></p></blockquote><h2 id="åŸå› ï¼š-2">åŸå› ï¼š</h2><p>å­—é¢æ„æ€ï¼Œpythonè„šæœ¬ä¸­æ‰¾ä¸åˆ°ä¸€ä¸ªå«<code>rpn</code>çš„æ¨¡å—</p><h2 id="è§£å†³æ–¹æ¡ˆï¼š-2">è§£å†³æ–¹æ¡ˆï¼š</h2><ol><li><p>ç›´æ¥<code>pip install rpn</code> ï¼ˆå¦‚æœç”µè„‘ä¸Šæœ‰å¤šä¸ªç‰ˆæœ¬çš„pythonï¼Œç¡®ä¿æ˜¯å®‰è£…åˆ°RuyiStudioæ‰€ä¾èµ–çš„py35ä¸‹ï¼‰</p></li><li><p>å…¶å®å°±æ˜¯å®‰è£…æ—¶ç•¥è¿‡äº†æ‰‹åŠ¨å®‰è£…æ­¥éª¤7å’Œ8å¯¼è‡´çš„ï¼Œrpnåœ¨è¿™ä¸ªroi_poolingç›®å½•ä¸‹</p></li></ol><p><img src="/2021/12/07/Hi3559AV100-5-NormalQA/1.png" alt="1"><br>é‚£å°±å®‰è£…vs2015åæ‰§è¡Œ<code>setup_roi_caffe.bat</code>ï¼Œä¸‹è½½<code>py-faster-rcnn-windows-master.zip</code>ã€‚è¿˜æ˜¯æœ‰ç½‘ç»œçš„è€é—®é¢˜ï¼Œé‚£å°±è‡ªå·±åœ¨è„šæœ¬ä¸­æ‰¾urlæ‰‹åŠ¨ä¸‹è½½å’Œè§£å‹ï¼Œæ³¨é‡Šæ‰wgetå’Œ7zçš„è¯­å¥ï¼Œå†æ¬¡æ‰§è¡Œbatè„šæœ¬ï¼Œ<s>æˆåŠŸç”Ÿæˆã€‚</s> å¹¶æ²¡æœ‰= =</p><p><img src="/2021/12/07/Hi3559AV100-5-NormalQA/2.png" alt="2"></p><ul><li><p>é¦–å…ˆï¼Œsedæ“ä½œçš„æƒé™é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ç”¨ç®¡ç†å‘˜æƒé™æ‰“å¼€ä¸€ä¸ªcmdï¼Œå†<code>cd D:\software\ruyi_env_setup</code>ä¸‹ï¼Œæ‰§è¡Œ<code>setup_roi_caffe.bat</code>è„šæœ¬è§£å†³ï¼›</p></li><li><p>å…¶æ¬¡ï¼Œbuildæ“ä½œå¹¶æ²¡æœ‰æˆåŠŸï¼Œé”™è¯¯å¦‚ä¸‹ï¼Œåªä¼šæ‹·è´å·²æœ‰çš„ä¸€äº›æ–‡ä»¶åˆ°<code>roi_pooling</code>ç›®å½•ä¸‹ï¼ˆè™½ç„¶è¿™ä¹Ÿèƒ½è§£å†³rpnæ¨¡å—æ‰¾ä¸åˆ°çš„é—®é¢˜ï¼‰ï¼Œä½†é€ä½›é€åˆ°è¥¿å˜›</p></li></ul><blockquote><p>D:\software\Microsoft Visual Studio\2019\Professional\VC\Tools\MSVC\14.28.29910\bin\Hostx64\x64\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MT -ID:\software\ruyi_env_setup\python35\lib\site-packages\numpy\core\include -ID:\software\ruyi_env_setup\python35\include -ID:\software\ruyi_env_setup\python35\include â€œ-ID:\software\Microsoft Visual Studio\2015\Community\VC\Includeâ€ â€œ-ID:\Windows Kits\10\include\10.0.19041.0\sharedâ€ â€œ-ID:\Windows Kits\10\include\10.0.19041.0\umâ€ â€œ-ID:\Windows Kits\10\include\10.0.19041.0\winrtâ€ â€œ-ID:\Windows Kits\10\include\10.0.19041.0\ucrtâ€ â€œ-IC:\Program Files (x86)\Windows Kits\NETFXSDK\4.6.1\include\umâ€ /Tcutils\bbox.c /Fobuild\temp.win-amd64-3.5\Release\utils\bbox.obj<br>bbox.c<br>D:\Windows Kits\10\include\10.0.19041.0\ucrt\corecrt.h(10): fatal error C1083: æ— æ³•æ‰“å¼€åŒ…æ‹¬æ–‡ä»¶: â€œvcruntime.hâ€: No such file or directory<br>error: command â€˜D:\software\Microsoft Visual Studio\2019\Professional\VC\Tools\MSVC\14.28.29910\bin\Hostx64\x64\cl.exeâ€™ failed with exit status 2</p></blockquote><ul><li>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œè°ƒç”¨çš„è¿˜æ˜¯vs2019çš„cl.exeï¼Œè€Œä¸æ˜¯vs2015ï¼Œé€šè¿‡everythingæœç´¢å¹¶æ²¡æœ‰æ‰¾åˆ°vs2015ç‰ˆæœ¬çš„cl.exeï¼Œæ ¹æœ¬æ²¡æœ‰<code>Tools</code>æ–‡ä»¶å¤¹ï¼Œå›çœ‹æ­¥éª¤7ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªvsç»„ä»¶æ²¡æœ‰å®‰è£…ï¼Œé‡æ–°æ‰“å¼€å®‰è£…ç¨‹åºï¼Œé€‰ä¸Š<code>Common Tools for Visual C++ 2015</code>å’Œ<code>Windows 8.1 SDK and Universal CRT SDK</code>ç»„ä»¶ï¼Œè°ƒæ•´å®‰è£…ã€‚</li><li>é‡æ–°æ‰§è¡Œ<code>setup_roi_caffe.bat</code>è„šæœ¬ï¼Œå¯ä»¥çœ‹åˆ°æ²¡æœ‰errorï¼Œå¹¶åœ¨<code>D:\software\ruyi_env_setup\py-faster-rcnn-windows-master\lib\build\temp.win-amd64-3.5\Release</code>ç›®å½•ä¸‹ç”Ÿæˆäº†è‹¥å¹²åº“ï¼Œå¹¶ä¸”åœ¨<code>nms</code> <code>pycocotools</code> <code>utils</code>æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†.cå’Œ.pydæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šä¸€å¹¶è¢«æ‹·è´åˆ°<code>roi_pooling</code>ç›®å½•ä¸‹</li></ul><p><img src="/2021/12/07/Hi3559AV100-5-NormalQA/3.png" alt="3"></p><h1>RuyiStudioç¼–è¯‘å·¥ç¨‹å¼¹å‡ºé”™è¯¯çª—å£</h1><p><img src="/2021/12/07/Hi3559AV100-5-NormalQA/4.png" alt="4"></p><p>Consoleçª—å£å¹¶æ²¡æœ‰æç¤ºä»£ç æœ‰errorï¼Œåº”è¯¥æ˜¯å·¥ç¨‹æˆ–IDEçš„é”™è¯¯ï¼Œæš‚æ—¶ä¸å½±å“åç»­ä»£ç ï¼Œä¹Ÿgoogleä¸åˆ°æœ‰æ•ˆçš„è§£å†³æ–¹æ³•ï¼Œæš‚æ—¶æç½®ã€‚</p><h1>Detect ResultåŠŸèƒ½ä¸èƒ½åŒ¹é…ç»“æœæ–‡ä»¶</h1><p>ç»“æœæ–‡ä»¶ä¸­æ ¹æ®åç§°å»è·Ÿå›¾ç‰‡åŒ¹é…ï¼Œå®Œå…¨ä¸€è‡´åˆ™å¯ä»¥åŒ¹é…ä¸Šï¼Œåˆ†è¾¨ç‡ä¸åŒä¹Ÿæ²¡å…³ç³»</p><p><img src="/2021/12/07/Hi3559AV100-5-NormalQA/5.png" alt="5"></p><p><img src="/2021/12/07/Hi3559AV100-5-NormalQA/6.png" alt="6"></p><h1>ç¼–è¯‘è‡ªå·±demoé‡åˆ°çš„é—®é¢˜</h1><h2 id="éœ€è¦äº¤å‰ç¼–è¯‘OpenCV">éœ€è¦äº¤å‰ç¼–è¯‘OpenCV</h2><p>å‚è€ƒ <a href="https://no5-aaron-wu.github.io/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/"><strong>äº¤å‰ç¼–è¯‘OpenCV</strong></a> ç¬”è®°</p><h2 id="å­˜åœ¨æœªå®šä¹‰å¼•ç”¨">å­˜åœ¨æœªå®šä¹‰å¼•ç”¨</h2><blockquote><p><a href="http://libnnie.so">libnnie.so</a>: undefined reference to memset_s</p></blockquote><p><code>memset_s</code>å‡½æ•°ç”±<code>libsecurec.so</code>åº“æä¾›ï¼Œé“¾æ¥è¯¥åº“å³å¯</p><p>å¦‚ä½•ç¡®å®šæŸä¸ªåº“ä¸­æ˜¯å¦å«æœ‰æŸä¸ªå‡½æ•°ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">readelf -s libsecurec.so | grep memset_s</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><blockquote><p>40: 0000000000002908  3284 FUNC    GLOBAL DEFAULT   11 memcpy_sOptTc<br>67: 0000000000001bb8   112 FUNC    GLOBAL DEFAULT   11 memcpy_s<br>75: 0000000000001c28  3292 FUNC    GLOBAL DEFAULT   11 memcpy_sOptAsm<br>81: 000000000000dd58   100 FUNC    GLOBAL DEFAULT   11 wmemcpy_s</p></blockquote><blockquote><p><a href="http://libnnie.so">libnnie.so</a>:  undefined reference to HI_MPI_SYS_MmzAlloc_Cached</p></blockquote><p>é“¾æ¥<code>libmpi.so</code>åº“</p><h1>è¿è¡Œè‡ªå·±demoé‡åˆ°çš„é—®é¢˜</h1><h2 id="æ— æ³•æ˜¾ç¤ºå›¾ç‰‡">æ— æ³•æ˜¾ç¤ºå›¾ç‰‡</h2><blockquote><p>terminate called after throwing an instance of â€˜cv::Exceptionâ€™<br>what():  OpenCV(4.1.0) /home/aaron-wu/opencv/opencv-4.1.0/modules/highgui/src/window.cpp:627: error: (-2:Unspecified error) The function is not implemented. Rebuild the library with Windows, GTK+ 2.x or Cocoa support. If you are on Ubuntu or Debian, install libgtk2.0-dev and pkg-config, then re-run cmake or configure script in function â€˜cvShowImageâ€™</p></blockquote><p>æ³¨é‡Šæ‰<code>cv::imshow()</code>ç›¸å…³è¯­å¥</p><h2 id="åˆ†é…å†…å­˜é”™è¯¯">åˆ†é…å†…å­˜é”™è¯¯</h2><blockquote><p>ERROR: MMAP ADDR: 0x7fb5e791e0-0x7fb64140b0</p></blockquote><p>åœ¨CMakeLists.txt å¢åŠ å®å®šä¹‰</p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span>(CMAKE_CXX_FLAGS <span class="string">&quot;$&#123;CMAKE_CXX_FLAGS&#125; -DHISI_CHIP&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¯¥å®æ§åˆ¶å†…å­˜åˆ†é…å’Œé‡Šæ”¾æ‰€è°ƒç”¨çš„å‡½æ•°æ˜¯<code>HI_MPI_SYS_MmzFree</code>ï¼Œ<code>HI_MPI_SYS_MmzAlloc</code>è¿˜æ˜¯<code>malloc</code>ï¼Œ<code>free</code>ã€‚</p><p>æŸ¥çœ‹MMZå†…å­˜ä½¿ç”¨æƒ…å†µ</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /proc/umap/media-mem</span><br></pre></td></tr></table></figure><h2 id="ç–‘ä¼¼å†…å­˜æ³„éœ²">ç–‘ä¼¼å†…å­˜æ³„éœ²</h2><p>åœ¨ç¨‹åºæ‰§è¡Œå®Œæ¯•åæœ‰è¿™äº›æ‰“å°ä¿¡æ¯</p><blockquote><p>mmz_userdev:mmz_userdev_release:<br>MMB LEAK(pid=1596): 0xDCF9E000, 6082560 bytes, â€˜â€™<br>mmz_userdev:mmz_userdev_release:<br>mmb&lt;0xdcf9e000&gt; mapped to userspace 0x00000000ffd25912 will be unmaped!<br>mmz_userdev:mmz_userdev_release:<br>MMB LEAK(pid=1596): 0xDD56B000, 4034560 bytes, â€˜â€™<br>mmz_userdev:mmz_userdev_release:<br>mmb&lt;0xdd56b000&gt; mapped to userspace 0x00000000e10a0392 will be unmaped!<br>mmz_userdev:mmz_userdev_release:<br>MMB LEAK(pid=1596): 0xDD944000, 4096 bytes, â€˜â€™<br>mmz_userdev:mmz_userdev_release:<br>mmb&lt;0xdd944000&gt; mapped to userspace 0x00000000bdd4e59c will be unmaped!<br>mmz_userdev:mmz_userdev_release:<br>MMB LEAK(pid=1596): 0xDD945000, 520192 bytes, â€˜â€™<br>mmz_userdev:mmz_userdev_release:<br>mmb&lt;0xdd945000&gt; mapped to userspace 0x00000000051ec222 will be unmaped!<br>mmz_userdev:mmz_userdev_release:<br>MMB LEAK(pid=1596): 0xDD9C4000, 20480 bytes, â€˜â€™<br>mmz_userdev:mmz_userdev_release:<br>mmb&lt;0xdd9c4000&gt; mapped to userspace 0x0000000051b58146 will be unmaped!<br>mmz_userdev:mmz_userdev_release:<br>MMB LEAK(pid=1596): 0xDD9C9000, 73728 bytes, â€˜â€™<br>mmz_userdev:mmz_userdev_release:<br>mmb&lt;0xdd9c9000&gt; mapped to userspace 0x00000000cf2d5fe3 will be unmaped!<br>mmz_userdev:mmz_userdev_release:<br>MMB LEAK(pid=1596): 0xDD9DB000, 262144 bytes, â€˜â€™<br>mmz_userdev:mmz_userdev_release:<br>mmb&lt;0xdd9db000&gt; mapped to userspace 0x00000000a8baa11a will be unmaped!</p></blockquote><p>ç¡®ä¸ºå†…å­˜æ³„éœ²ï¼Œæ²¡æœ‰freeå†…å­˜å¯¼è‡´çš„</p><h2 id="NNIEçš„é¢„å¤„ç†">NNIEçš„é¢„å¤„ç†</h2><p>æŒ‰ç…§demoçš„ä»£ç é€»è¾‘ä»¥åŠç›¸å…³æ–‡æ¡£çš„æè¿°ï¼ŒNNIEçš„Forwardæ˜¯åŒ…å«éƒ¨åˆ†é¢„å¤„ç†æ“ä½œçš„ï¼š</p><ul><li><ol><li>è¿™éƒ¨åˆ†é¢„å¤„ç†æ“ä½œæ€ä¹ˆåšæ˜¯ç”±è½¬æ¢wkæ—¶çš„é…ç½®ç¡®å®šçš„ï¼ŒåŒ…æ‹¬é‡åŒ–æ“ä½œå’ŒBGR-&gt;RGBçš„é€šé“é¡ºåºè½¬æ¢ï¼›</li></ol></li><li><ol start="2"><li>å¦‚æœé€‰æ‹©<code>image_type</code>ä¸º<code>U8</code>ï¼Œåˆ™åªæ¥å—BGR_planarç±»å‹çš„è¾“å…¥ï¼Œå¤–éƒ¨ä»…éœ€è¦å…³æ³¨resizeå’Œpacked-&gt;planarè½¬æ¢æ“ä½œï¼Œå¦æ”¾åˆ°src_blobä¸­æ—¶ï¼Œæ³¨æ„strideçš„å¯¹é½ï¼›</li></ol></li><li><ol start="3"><li>è½¬æ¢æ—¶çš„é¢„å¤„ç†å½’ä¸€åŒ–meanå€¼å¦‚æœå„é€šé“ä¸åŒï¼Œåˆ™meanå€¼é¡ºåºä¸<code>RGB_order</code>çš„é¡ºåºä¿æŒä¸€è‡´ï¼›</li></ol></li></ul>]]></content>
      
      
      <categories>
          
          <category> HISI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> HISI </tag>
            
            <tag> NNIE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·æ€AIå¼€å‘ [4]ï¼šNNIE Mapper æ¨¡å‹è½¬æ¢é—®é¢˜è®°å½•</title>
      <link href="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/"/>
      <url>/2021/12/03/Hi3559AV100-4-NNIEMapperQA/</url>
      
        <content type="html"><![CDATA[<h1>é—®é¢˜1 poolingå±‚å°ºå¯¸ä¸ä¸€è‡´</h1><p>poolingå±‚è¾“å‡ºå°ºå¯¸çš„è®¡ç®—å…¬å¼å¦‚ä¸‹:</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>h</mi><mi>o</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>h</mi><mi>i</mi></msub><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mi>p</mi><mi>a</mi><mi>d</mi><mo>âˆ’</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>w</mi><mi>o</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><mn>2</mn><mo>âˆ—</mo><mi>p</mi><mi>a</mi><mi>d</mi><mo>âˆ’</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>d</mi><mi>e</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}h_o=(h_i+2*pad-kernel)/stride+1\\w_o=(w_i+2*pad-kernel)/stride+1\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>å½“ä¸èƒ½æ•´é™¤ï¼ˆè¾“å…¥æˆ–å·ç§¯æ ¸ä¸ºå¥‡æ•°ï¼‰æ—¶ï¼Œpytorché»˜è®¤æ˜¯<code>floor</code>ï¼Œè€Œcaffeé»˜è®¤æ˜¯<code>ceil</code>ï¼Œå› æ­¤ä¼šå‡ºç°onnx2caffeè½¬æ¢åè¾“å‡ºå°ºå¯¸æ¯”pytorchå¤§1çš„æƒ…å†µã€‚</p><h2 id="è§£å†³åŠæ³•ï¼šSliceå±‚åˆ‡å‰²poolingå±‚çš„è¾“å‡º">è§£å†³åŠæ³•ï¼šSliceå±‚åˆ‡å‰²poolingå±‚çš„è¾“å‡º</h2><ul><li><p>å¦‚æœè®­ç»ƒç«¯å‘ç°è¯¥é—®é¢˜ï¼Œå¯ä»¥pytorchçš„poolingè®¾ç½®ä¸º<code>ceil_mode=True</code></p></li><li><p>å¦‚æœéƒ¨ç½²ç«¯å‘ç°è¯¥é—®é¢˜ï¼Œä¸æƒ³é‡æ–°ä¿®æ”¹æ¨¡å‹retrainï¼Œåˆ™éœ€è¦æ‰‹åŠ¨ä¿®æ”¹prototxt</p><ul><li>é¦–å…ˆï¼Œä¸èƒ½é‡‡ç”¨å°†paddingç½®ä¸º0çš„æ–¹å¼ï¼Œè™½ç„¶èƒ½è·å¾—ç›¸åŒçš„sizeï¼Œä½†è®¡ç®—æ–¹å¼ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå®æµ‹ä¹Ÿæ˜¯ä¼šå‡ºç°æ‰ç‚¹çš„ã€‚å…·ä½“å¯ä»¥çœ‹ä¸‹å›¾ï¼›</li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/1.png" alt="1"></p><ul><li>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œå¯ä»¥å°†caffe ceilæ¨¡å¼è¾“å‡ºçš„ç»“æœçš„æœ€åä¸€è¡Œå’Œæœ€åä¸€åˆ—åˆ‡æ‰ï¼Œä»è€Œè·å¾—ä¸pytorchç›¸åŒçš„è¾“å‡ºï¼›</li><li>æœ€åï¼Œå…¶å®ä¹Ÿå¯ä»¥ä¿®æ”¹caffeç«¯poolingå±‚ä¸º<code>floor</code>æ¨¡å¼ï¼Œä½†åœ¨å½“å‰æƒ…æ™¯ä¸‹ï¼Œcaffeåªæ˜¯ä½œä¸ºä¸­è½¬ï¼Œè¿˜è¦è½¬æ¢åˆ°nnieæ¨¡å‹ï¼Œå¯èƒ½è¿˜ä¼šå‡ºç°ä¸åŒ¹é…çš„æƒ…å†µï¼Œæ•…è¿™é‡Œä¸é€‚ç”¨ã€‚</li></ul></li></ul><h2 id="ä»£ä»·ï¼šæ— æ•ˆè¾“å‡ºå¢å¤š">ä»£ä»·ï¼šæ— æ•ˆè¾“å‡ºå¢å¤š</h2><p>ç”±äºsliceåˆ†å‰²äº†poolingå±‚çš„è¾“å‡ºï¼Œæ•…æ¯æ¬¡sliceéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ— ç”¨çš„tensorè¾“å‡ºï¼ˆæœ€åä¸€è¡Œ/åˆ—ï¼‰ï¼Œnnieæ¯ä¸ªæ¨¡å‹segçš„æœ€å¤§è¾“å‡ºä¸ªæ•°ä¸º16ï¼ˆhi_nnie.hä¸­å®šä¹‰äº†<code>#define SVP_NNIE_MAX_OUTPUT_NUM 16</code>ï¼‰ï¼Œæ•…å¦‚æœæœ‰äº›æ¨¡å‹sliceåŠ çš„å¤šï¼Œè¿˜å¾—å°†è¿™äº›æ— ç”¨è¾“å‡ºåˆå¹¶æˆä¸€ä¸ªã€‚</p><h1>é—®é¢˜2 ä¸æ”¯æŒrelu6</h1><h2 id="è§£å†³åŠæ³•ï¼šå¤šä¸ªopç»„åˆè¿›è¡Œæ›¿ä»£">è§£å†³åŠæ³•ï¼šå¤šä¸ªopç»„åˆè¿›è¡Œæ›¿ä»£</h2><p>relu6å³åœ¨reluçš„åŸºç¡€ä¸Šï¼Œå°†æœ€å¤§å€¼é’³åˆ¶åˆ°6ï¼Œå›¾åƒå¦‚ä¸‹ï¼š</p><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/2.png" alt="2"></p><p>caffeå’Œnnieæ²¡æœ‰ç°æˆçš„opæ”¯æŒï¼Œå¦‚éç”¨relu6ä¸å¯ï¼Œå¯ä»¥ç”¨å‡ ä¸ªcaffeæ”¯æŒçš„opç»„åˆè¿›è¡Œä»£æ›¿ï¼Œå…¬å¼å¦‚ä¸‹ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>t</mi><mi>h</mi><mi>r</mi><msub><mi>e</mi><mi>o</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>0</mn><mspace width="1em"><mi>r</mi><mi>e</mi><mi>l</mi><mi>u</mi><mo>&lt;</mo><mo>=</mo><mn>6</mn></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>1</mn><mspace width="1em"><mi>r</mi><mi>e</mi><mi>l</mi><mi>u</mi><mo>&gt;</mo><mn>6</mn></mspace></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">thre_o=\left\{\begin{aligned}&amp;0 \quad relu&lt;=6 \\&amp;1 \quad relu&gt;6\end{aligned}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.75em;"><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">6</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>r</mi><mi>e</mi><mi>l</mi><mi>u</mi><msub><mn>6</mn><mi>o</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>t</mi><mi>h</mi><mi>r</mi><msub><mi>e</mi><mi>o</mi></msub><mo stretchy="false">)</mo><mo>âˆ—</mo><mi>r</mi><mi>e</mi><mi>l</mi><mi>u</mi><mo>+</mo><mi>t</mi><mi>h</mi><mi>r</mi><msub><mi>e</mi><mi>o</mi></msub><mo>âˆ—</mo><mn>6</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}relu6_o = (1 - thre_o) * relu + thre_o * 6\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord">6</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">re</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li>é˜ˆå€¼åˆ¤æ–­ç”¨<code>threshold</code>ï¼Œä¹˜å’Œåç½®ä½œå¯ä»¥ç”¨<code>power</code>ï¼Œtensorç›¸åŠ çš„æ“ä½œå¯ä»¥ç”¨<code>eltwise</code>ï¼Œå…·ä½“ç»„åˆæ–¹å¼è§ä¸‹å›¾</li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/3.png" alt="3"></p><h2 id="è¡ç”Ÿé—®é¢˜ï¼šPower-å±‚shift-1-0æ— æ³•æ­£å¸¸åŠ 1">è¡ç”Ÿé—®é¢˜ï¼šPower å±‚<code>shift=1.0</code>æ— æ³•æ­£å¸¸åŠ 1</h2><p>ä¸Šè¿°è½¬æ¢éªŒè¯onnx-&gt;caffeæ¨¡å‹æ˜¯å¯ä»¥æ­£å¸¸è½¬æ¢çš„ï¼Œä½†å†è½¬æ¢åˆ°nnieæ¨¡å‹æ—¶å‡ºäº†é—®é¢˜ï¼›</p><p>æµ‹è¯•å‘ç°nnieçš„power op æ— æ³•æ­£å¸¸æ‰§è¡Œ<code>shift=1.0</code>çš„åç½®æ“ä½œï¼Œä¸Šå›¾å·¦è¾¹çš„powerç®—å­çš„è¾“å‡ºåº”å½“æ˜¯0å’Œ1çš„maskï¼Œç»“æœå´è¾“å‡ºçš„æ˜¯-1å’Œ0ï¼Œé‚åšäº†ä»¥ä¸‹æµ‹è¯•ï¼š</p><ul><li>å½“<code>shift=2.0</code>æ—¶ï¼Œå¯ä»¥æ­£å¸¸åŠ 2ï¼›</li><li>å½“<code>shift=1.1</code>æ—¶ï¼Œå¯ä»¥æ­£å¸¸åŠ 1.1ï¼›</li><li>å½“<code>shift=1.0001</code>ï¼ˆæˆ–æ›´å°ï¼‰æ—¶ï¼Œå¯ä»¥æ­£å¸¸åŠ 1ï¼›</li></ul><p><s>æ•…å¯ä»¥é€šè¿‡å°†shiftè®¾ç½®ä¸ºå¸¦ä¸Šä¸€ä¸ªå¾ˆå°çš„ä½™é‡è§„é¿ä¸Šè¿°é—®é¢˜ï¼ˆä¼°è®¡æ˜¯ç²¾åº¦èˆå…¥çš„é—®é¢˜ï¼‰ï¼Œå®Œæˆæ­£å¸¸åŠ 1çš„æ“ä½œï¼›</s></p><p>ä¸HISIçš„FAEæ²Ÿé€šåå¾—åˆ°çš„æœ€ç»ˆç­”æ¡ˆæ˜¯ï¼ŒGPUç‰ˆæœ¬çš„mapperå·¥å…·ç¡®å®å­˜åœ¨bugï¼Œå¯ä»¥æš‚æ—¶ä½¿ç”¨CPUç‰ˆæœ¬è¿›è¡Œè§„é¿ã€‚</p><h2 id="ä»£ä»·ï¼šç”±æ­¤å¸¦æ¥çš„æ€§èƒ½æŸå¤±">ä»£ä»·ï¼šç”±æ­¤å¸¦æ¥çš„æ€§èƒ½æŸå¤±</h2><p>æµ‹è¯•è‡ªç”¨äººè„¸æ£€æµ‹æ¨¡å‹ï¼š</p><ul><li>ç”¨ä¸Šè¿°opæ›¿æ¢çš„æ–¹å¼å®ç°relu6ï¼Œé‡åŒ–æ–¹å¼è®¾ç½®ä¸º16bitï¼Œæµ‹è¯•ä¸Šæ¿æ¨ç†æ—¶é—´ä¸º162ms</li><li>ä¸è€ƒè™‘ç²¾åº¦å˜åŒ–çš„æƒ…å†µä¸‹ï¼Œå°†relu6ç›´æ¥æ›¿æ¢ä¸ºreluï¼Œå…¶ä»–é…ç½®ä¸å˜ï¼Œæµ‹è¯•ä¸Šæ¿æ¨ç†æ—¶é—´ä¸º54ms</li></ul><p>å³å¢åŠ çš„<code>power</code>ã€<code>threshold</code> ã€<code>eltwise</code>ç­‰opå¸¦æ¥äº†3å€çš„æ—¶é—´æ¶ˆè€—</p><h2 id="æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼šè®­ç»ƒç«¯ä¿®æ­£">æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼šè®­ç»ƒç«¯ä¿®æ­£</h2><p>è®­ç»ƒç«¯è°ƒæ•´ï¼Œä¸ä½¿ç”¨relu6</p><h1>nnie opè°ƒè¯•æ–¹æ³•</h1><h2 id="ï¼ˆoptionalï¼‰è‡ªå·±æ„å»ºå•opæ¨¡å‹">ï¼ˆoptionalï¼‰è‡ªå·±æ„å»ºå•opæ¨¡å‹</h2><ul><li>é€šè¿‡pytorchæ„å»ºä¸€ä¸ªè‡ªå·±æ‰€è¦éªŒè¯çš„å•opæ¨¡å‹ï¼Œè¾“å‡ºä¸ºonnxï¼›</li><li>å¥½å¤„å°±æ˜¯å¯ä»¥æ„å»ºæ›´çº¯ç²¹çš„æµ‹è¯•ç¯å¢ƒï¼Œæ‘’é™¤æ— å…³å› ç´ çš„å¹²æ‰°ï¼Œå¯ä»¥è‡ªå®šä¹‰è¾“å…¥å°ºå¯¸å’Œå€¼ï¼Œæ›´å®¹æ˜“è§‚å¯Ÿç°è±¡ï¼Œæ¨¡å‹è½¬æ¢ï¼Œå‘é‡æ¯”è¾ƒç­‰æ“ä½œä¹Ÿä¼šæ›´å¿«ï¼›</li><li>é€šè¿‡<a href="https://github.com/no5-aaron-wu/onnx2caffe"><code>onnx2caffe</code>è„šæœ¬å·¥ç¨‹</a>å°†onnxè½¬æ¢åˆ°caffeæ¨¡å‹ï¼›<ul><li>å®æµ‹python3.5 + onnx 1.6.0 + protobuf 3.16.0 + hisi caffe ç¯å¢ƒ å¯ä»¥æ­£å¸¸è¿è¡Œ</li><li>å¦‚æœç¨‹åºæ‰¾ä¸åˆ°caffeåº“ï¼Œå¯ä»¥åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®PYTHONPATHï¼Œæˆ–è€…åœ¨IDEï¼ˆPycharmä¸ºä¾‹ï¼‰ä¸­è®¾ç½®æœç´¢è·¯å¾„</li></ul></li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/4.png" alt="4"></p><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/5.png" alt="5"></p><h2 id="è·å¾—nnieæ¨¡å‹çš„æ¨ç†ç»“æœ">è·å¾—nnieæ¨¡å‹çš„æ¨ç†ç»“æœ</h2><p>nnie mapperçš„è®¾ç½®å¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/6.png" alt="6"></p><ul><li>å°†<code>log_level</code>è®¾ç½®ä¸º<code>Function level</code>ï¼Œé‡åŒ–è½¬æ¢æ¨¡å‹ç»“æŸåä¼šè·‘ä¸€éæ¨ç†ï¼Œå°†æ¨ç†çš„å„å±‚ä¸­é—´ç»“æœä¿å­˜åˆ°å·¥ç¨‹ç›®å½•çš„<code>mapper_quant</code>æ–‡ä»¶å¤¹ä¸‹ï¼›</li><li>é‚£ä¹ˆæ¨ç†çš„è¾“å…¥æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯<code>image_list</code>ï¼Œå¦‚æœlistä¸­åªæœ‰ä¸€ä¸ªå›¾ï¼Œé‚£å°±æ˜¯è¿™ä¸ªå›¾ï¼Œå¦‚æœæœ‰å¤šå¼ å›¾ï¼Œä¼šè·‘listä¸­æœ€åä¸€å¼ å›¾ï¼›</li><li>ä¸­é—´ç»“æœä¼šä¿å­˜ä¸º<code>*.hex</code>æ ¼å¼çš„æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªå…ƒç´ ï¼Œå…±è¯¥å±‚çš„è¾“å‡ºå°ºå¯¸<code>n*c*h*w</code>è¡Œï¼Œå…ƒç´ ç”¨32bitå®šç‚¹æ•°ï¼ˆ20.12ï¼‰çš„16è¿›åˆ¶è¡¥ç è¡¨ç¤ºï¼Œå³é«˜20ä½ä¸ºæ•´æ•°éƒ¨åˆ†ï¼Œä½12ä½ä¸ºå°æ•°éƒ¨åˆ†ï¼Œè‡³äºè¡¥ç åˆ°floatæ•°çš„è½¬æ¢ï¼Œå¯ä»¥è‡ªè¡Œè®¡ç®—ï¼Œä¹Ÿå¯ä»¥ç”¨vector comparisonå·¥å…·çš„è½¬æ¢åŠŸèƒ½ï¼›</li><li>é‡åŒ–æ ¡æ­£æ•°æ®<code>image_list</code>å¯ä»¥æ˜¯å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ˜¯è‡ªå®šä¹‰çš„tensorï¼Œå³å¦‚å›¾ä¸­æ‰€ç¤ºï¼Œå°†<code>image_type</code>è®¾ç½®ä¸º<code>S32</code>ï¼Œ<code>image_list</code>ä¸ºå¼ é‡æ–‡ä»¶ï¼Œå¼ é‡æ–‡ä»¶ä¸­ä¸€ä¸ªå®Œæ•´çš„å¼ é‡ï¼ˆ<code>c*h*w</code>ä¸ªç‚¹ï¼‰ä¸ºä¸€è¡Œï¼Œä»¥æµ®ç‚¹æ–‡æœ¬è¡¨ç¤ºï¼Œç‚¹ä¸ç‚¹ä¹‹é—´ä»¥ç©ºæ ¼æˆ–é€—å·åˆ†å‰²ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆæŸ¥çœ‹å¼€äº†è‡ªåŠ¨æ¢è¡Œï¼Œå®é™…ä¸º1è¡Œï¼‰</li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/7.png" alt="7"></p><h2 id="è·å¾—caffeæ¨¡å‹çš„æ¨ç†ç»“æœ">è·å¾—caffeæ¨¡å‹çš„æ¨ç†ç»“æœ</h2><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/8.png" alt="8"></p><ul><li>å·¥å…·å¦‚å›¾è¿›è¡Œé…ç½®ï¼Œå…³é”®é¢„å¤„ç†æ–¹å¼ä¸nnie mapperè®¾ä¸ºä¸€è‡´ï¼Œåˆ™ä¼šå°†ä¸­é—´ç»“æœè¾“å‡ºåˆ°æŒ‡å®šç›®å½•</li><li>ä¸­é—´ç»“æœä¿å­˜ä¸º<code>*.float</code>æ–‡ä»¶ï¼Œä¸<code>*.hex</code>ä¸€æ ·ï¼Œæ¯è¡Œä¸€ä¸ªå…ƒç´ ï¼Œå…±è¾“å‡ºå°ºå¯¸<code>n*c*h*w</code>è¡Œï¼Œä½†å…ƒç´ ä¸ºç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºçš„å°æ•°ã€‚</li><li>è¿™ä¸ªå·¥å…·åªèƒ½é€‰æ‹©å›¾åƒä½œä¸ºè¾“å…¥ï¼Œå¦‚æœè¦å¯¹æ¯”è‡ªå®šä¹‰tensorä½œä¸ºè¾“å…¥çš„ç»“æœåˆ™éœ€è¦ç”Ÿæˆtensorå¯¹åº”çš„jpgï¼Œä¸”é€‰æ‹©åˆé€‚çš„é¢„å¤„ç†ä»¥è½¬åŒ–æˆåŸtensorï¼Œæ–¹ä¾¿ä¸nnieé‡åŒ–ä¸­é—´ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Œç†è®ºä¸Šå¯è¡Œï¼Œä½†é¢‡ä¸ºä¸ä¾¿ï¼Œæ­¤å¤„æœªåšå°è¯•ã€‚</li><li>æ­¤å·¥å…·å¯¹åº”<code>RuyiStudio\Resources\pythonScript\cnn_convert_bin_and_print_featuremap.py</code>è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹è„šæœ¬ï¼Œåº”è¯¥ä¹Ÿå¯ä»¥å®ç°è‡ªå®šä¹‰tensorä½œä¸ºè¾“å…¥ï¼ŒåŒæ ·æœªåšå°è¯•ã€‚</li></ul><h2 id="å¯¹æ¯”ä¸åŒæ¨¡å‹çš„ä¸­é—´ç»“æœ">å¯¹æ¯”ä¸åŒæ¨¡å‹çš„ä¸­é—´ç»“æœ</h2><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/9.png" alt="9"></p><ul><li><code>Prototxt Has Inplace Layers</code>ï¼šå¦‚æœprototxtä¸­å­˜åœ¨<code>inplace</code>å†™æ³•ï¼ˆå³ä¸ºç›¸äº’è¿æ¥çš„å‡ ä¸ªå±‚ä¸­ï¼Œtopæ˜¯ç›¸åŒçš„ï¼Œbottomæ˜¯ä¸å®Œå…¨ç›¸åŒçš„ï¼‰åˆ™éœ€è¦å‹¾é€‰ï¼Œå¹¶é€‰æ‹©ç›¸åº”çš„prototxtæ–‡ä»¶ï¼Œè¿™äº›å±‚ä¼šè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªæ¡†ï¼Œä¸€èˆ¬é€šè¿‡nnie mapperçš„è‡ªåŠ¨æ ‡è®°åŠŸèƒ½ç”Ÿæˆçš„<code>*nnie_mark_*.prototxt</code>ä¼šæŠŠåˆé€‚çš„å±‚ç»„æˆ<code>inplace</code>ç»“æ„ï¼Œåº”è¯¥æ˜¯èƒ½ä¼˜åŒ–æ€§èƒ½å§ã€‚å…·ä½“å¦‚ä¸‹å›¾ï¼›</li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/10.png" alt="10"></p><ul><li><code>Parse Dot File</code>ï¼šå¦‚æœæ˜¯å¯¹æ¯”çš„ç»“æœä¸€ä¸ªæ˜¯caffeæˆ–nnie mapperçš„æ¨ç†ç»“æœï¼Œå¦ä¸€ä¸ªæ˜¯ä»¿çœŸæ•°æ®ï¼Œåˆ™éœ€è¦å‹¾é€‰å¹¶é€‰æ‹©å·¥ç¨‹ç›®å½•ä¸‹ç”Ÿæˆçš„<code>cnn_net_tree.dot</code>æ–‡ä»¶ï¼Œä»¥è¿›è¡Œå±‚çš„åŒ¹é…ï¼›</li><li><code>Left Folder</code>/<code>Right Folder</code>ï¼šé€‰æ‹©è¦å¯¹æ¯”çš„ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œæ³¨æ„nnie mapperçš„ä¸­é—´ç»“æœä¼šéå¸¸å¤šï¼Œå¾ˆå¤šéƒ½æ˜¯ä¸éœ€è¦çš„ï¼Œå¯ä»¥æ ¹æ®caffeç»“æœçš„æ–‡ä»¶åç­›é€‰å‡ºå¯¹åº”çš„æ–‡ä»¶å•ç‹¬æ”¾åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œå¦åˆ™å•æ˜¯è¯»å–æ–‡ä»¶çš„æ—¶é—´å°±ä¼šæ…¢åˆ°è®©ä½ å´©æºƒï¼ˆå› ä¸ºå®ƒä¼šä¸€è¾¹è¯»æ–‡ä»¶ï¼Œä¸€éè¿›è¡Œå±‚åŒ¹é…ï¼‰ï¼›</li><li><code>Algorithm Setting</code>ï¼šæ˜¯ä¸€äº›è¯¯å·®å‚æ•°çš„é˜ˆå€¼è®¾å®šï¼Œè¶…è¿‡é˜ˆå€¼çš„ä¼šè¢«æ ‡çº¢ï¼Œé»˜è®¤å°±å¥½ï¼›</li><li>ç‚¹å‡»<code>Compare</code>ï¼Œæ¯”è¾ƒå‘é‡ç›¸ä¼¼åº¦ï¼Œä¸€èˆ¬çœ‹ä½™å¼¦ç›¸ä¼¼åº¦<code>CosineSimilarity</code>ï¼Œå¤§äº0.99ä¸€èˆ¬é—®é¢˜ä¸å¤§ï¼Œ0.95-0.99ä¹‹é—´æœ‰ç‚¹é—®é¢˜ï¼Œ0.95ä»¥ä¸‹å°±å¯èƒ½ä¼šå¯¼è‡´æ¯”è¾ƒä¸¥é‡çš„æ‰ç‚¹äº†ï¼›</li><li>ç‚¹å‡»<code>Show Result</code>ï¼šä¼šå°†è¯¯å·®æ ‡æ³¨çš„æ‹“æ‰‘å›¾ä¸Šï¼Œå¹¶ç”¨é¢œè‰²åŒºåˆ†ä¸¥é‡ç¨‹åº¦ï¼Œæ–¹ä¾¿å®šä½å“ªäº›å±‚é—®é¢˜é—®é¢˜æ¯”è¾ƒå¤§ï¼›</li><li>åŒå‡»éœ€è¦æŸ¥çœ‹çš„è¡Œï¼Œä¼šå¼¹å‡ºæ¯ä¸ªå…ƒç´ å¯¹æ¯”çš„çª—å£ï¼Œè¿™é‡Œæœ‰ä¸ªæ¯”è¾ƒå¥½ç”¨åŠŸèƒ½å°±æ˜¯<code>Convert To Float</code>ï¼Œå½“ä½ ä¸çŸ¥é“æ€ä¹ˆä»è¡¥ç è½¬æ¢åˆ°floatæ—¶ï¼Œè¿™é‡Œå¯ä»¥ç»™ä½ ä¸€ä¸ªå‚è€ƒï¼Œä½†ä¸å»ºè®®åŒå‡»å°ºå¯¸è¾ƒå¤§çš„è¡Œï¼ŒåŠ è½½çš„é€Ÿåº¦æ…¢åˆ°æ€€ç–‘äººç”Ÿï¼›</li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/11.png" alt="11"></p><ul><li>å¯¹æ¯”çœ‹ä»€ä¹ˆå‘¢ï¼Ÿ</li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/12.png" alt="12"></p><h1>é—®é¢˜3 low-bandwidth é‡åŒ–ç²¾åº¦ä¸‹é™</h1><h2 id="ç°è±¡1ï¼šbenchmark-AP-ä¸‹é™æ˜æ˜¾">ç°è±¡1ï¼šbenchmark AP ä¸‹é™æ˜æ˜¾</h2><p>è‡ªç”¨äººè½¦ç‹—æ¨¡å‹ï¼š</p><p>mnnç»“æœ</p><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/13.png" alt="13"></p><p>nnie-high-precisionç»“æœ</p><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/14.png" alt="14"></p><p>nnie-low-bandwidthç»“æœ</p><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/15.png" alt="15"></p><h2 id="ç°è±¡2ï¼švector-comparison-ä½™å¼¦ç›¸ä¼¼åº¦ä½">ç°è±¡2ï¼švector comparison ä½™å¼¦ç›¸ä¼¼åº¦ä½</h2><p>æ¯”è¾ƒnnie-high-precisionä¸caffeä¸­é—´ç»“æœï¼Œä½™å¼¦ç›¸ä¼¼åº¦ è¾“å…¥=1ï¼Œåç»­å„å±‚å‡&gt;0.99ï¼Œä¸‹å›¾å±•ç¤ºäº†éƒ¨åˆ†å±‚çš„è¯¯å·®æƒ…å†µï¼Œç°è‰²ä»£è¡¨â‰¥0.99</p><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/16.png" alt="16"></p><p>æ¯”è¾ƒnnie-low-precisionä¸caffeä¸­é—´ç»“æœï¼Œä½™å¼¦ç›¸ä¼¼åº¦ è¾“å…¥=1ï¼Œåç»­å‡ºç°ä¸‹é™æƒ…å†µï¼Œéƒ¨åˆ†å±‚é™åˆ°0.9ä»¥ä¸‹ï¼Œè¾“å‡ºå±‚åœ¨0.95å·¦å³ï¼Œä¸‹å›¾å±•ç¤ºäº†éƒ¨åˆ†å±‚çš„è¯¯å·®æƒ…å†µï¼Œæ©˜è‰²ä¸º0.95~0.99ï¼Œçº¢è‰²ä¸º&lt;0.95</p><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/17.png" alt="17"></p><h2 id="è§£å†³åŠæ³•ï¼šhigh-precision-ç²¾åº¦æ¢å¤">è§£å†³åŠæ³•ï¼šhigh-precision ç²¾åº¦æ¢å¤</h2><p>å¦‚ä¸Šæ‰€è¿°ï¼Œå½“æŠŠé‡åŒ–æ–¹å¼æ”¹ä¸º16bitçš„high-precisionæ¨¡å¼æ—¶ï¼Œç²¾åº¦çš„ä¸‹é™åœ¨å¯æ¥å—çš„èŒƒå›´å†…ï¼ˆAPâ†“0.5%ï¼‰</p><h2 id="è¡ç”Ÿé—®é¢˜ï¼šspecify-ï¼ˆFP16-INT8æ··åˆé‡åŒ–ï¼‰æ— æ³•è¾¾åˆ°é¢„æœŸçš„æŠ˜ä¸­æ•ˆæœ">è¡ç”Ÿé—®é¢˜ï¼šspecify ï¼ˆFP16+INT8æ··åˆé‡åŒ–ï¼‰æ— æ³•è¾¾åˆ°é¢„æœŸçš„æŠ˜ä¸­æ•ˆæœ</h2><p>æŒ‰ç…§ä¸Šé¢ç²¾åº¦é—®é¢˜çš„å®šä½æ­¥éª¤å›¾ä¸­<code>ç¬¬3æ­¥-case1</code>çš„å»ºè®®ï¼Œåšäº†å¦‚ä¸‹å°è¯•</p><ul><li><strong>å°†ç¬¬ä¸€ä¸ªå·ç§¯å±‚ç½®ä¸º<code>_hp</code></strong>ï¼šAPå’Œå‘é‡ç›¸ä¼¼åº¦æœ‰ä¸€ç‚¹æå‡ï¼Œä½†ä¸æ˜æ˜¾</li><li><strong>ä»å‰å¾€åé€å±‚ç½®ä¸º<code>_hp</code></strong>ï¼šé¦–å…ˆï¼Œå®æµ‹åƒbnï¼Œreluè¿™æ ·æ²¡æœ‰æƒé‡çš„å±‚ï¼Œå³ä½¿è®¾ä¸º<code>_hp</code>ä¹Ÿæ²¡æœ‰å½±å“ï¼Œä¸”é€šè¿‡Ruyistudioçš„<code>Graph View</code>å·¥å…·çœ‹åˆ°çš„<code>Layer Info</code>ï¼Œè¿™äº›å±‚ä¹Ÿæ²¡æœ‰<code>High precision layer</code>å‚æ•°ï¼ˆè§ä¸‹å›¾ï¼‰ï¼Œä¾§é¢å°è¯äº†è¿™ä¸€ç‚¹ã€‚å…¶æ¬¡ï¼Œå½“æŠŠç¬¬äºŒä¸ªå·ç§¯å±‚ï¼ˆ437ï¼‰ç½®ä¸º<code>_hp</code>åï¼Œå°±å‡ºé—®é¢˜äº†ï¼Œè¯¥å±‚çš„ä½™å¼¦ç›¸ä¼¼åº¦é™åˆ°0.81ï¼Œåç»­æ‰€æœ‰å±‚çš„ä½™å¼¦ç›¸ä¼¼åº¦éƒ½æ–­å´–å¼ä¸‹é™ã€‚</li></ul><p><img src="/2021/12/03/Hi3559AV100-4-NNIEMapperQA/18.png" alt="18"></p><ul><li><strong>æ‰€æœ‰å±‚ï¼ˆå¸¦<code>High precision layer</code>ï¼‰å…¨éƒ¨ç½®ä¸º<code>_hp</code></strong>ï¼šç†è®ºä¸Šè¯¥æ“ä½œåº”å½“ä¸<code>compile_mode=High-precision</code>è·å¾—åŒæ ·çš„ç»“æœï¼Œä½†æ˜¯å´ä¸ä¸Šé¢ç¬¬äºŒç‚¹ç±»ä¼¼ï¼Œä»437å¼€å§‹ï¼Œç²¾åº¦æ–­å´–å¼ä¸‹é™ã€‚å°è¯•åœ¨æ­¤åŸºç¡€ä¸Šï¼ŒæŠŠ437è¸¢å‡º<code>_hp</code>çš„é˜Ÿä¼ï¼Œå‘ç°ï¼Œç²¾åº¦ä»445å¼€å§‹å‡ºç°æ–­å´–å¼ä¸‹é™ã€‚å†æŠŠ445è¸¢å‡º<code>_hp</code>é˜Ÿä¼ï¼Œåˆä»453å¼€å§‹é‡è¹ˆè¦†è¾™ã€‚åé¢è¿˜æ˜¯å†å²çš„è½®å›ï¼Œæ²¡æœ‰å†è¿›ä¸€æ­¥éªŒè¯ã€‚</li></ul><h2 id="ä»£ä»·ï¼šç”±æ­¤å¸¦æ¥çš„æ€§èƒ½æŸå¤±-2">ä»£ä»·ï¼šç”±æ­¤å¸¦æ¥çš„æ€§èƒ½æŸå¤±</h2><p>ç›®å‰é‡‡ç”¨16bité‡åŒ–æ¨¡å¼å¯ä»¥è§£å†³ç²¾åº¦é—®é¢˜ï¼Œä½†å¸¦æ¥äº†æ€§èƒ½çš„æŸå¤±ï¼Œå®æµ‹è‡ªç”¨äººè½¦ç‹—æ¨¡å‹çš„æ¨ç†æ—¶é—´ç”±20ms-&gt;30ms</p><h2 id="æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼šFP16-INT8æ··åˆé‡åŒ–">æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼šFP16+INT8æ··åˆé‡åŒ–</h2><p>specifyçš„bugå®šä½åˆ°äº†ï¼Œhisi FAEåé¦ˆå½“å·ç§¯å±‚çš„groupä¸ä¸º1ï¼Œé«˜ç²¾åº¦é‡åŒ–å­˜åœ¨bugï¼Œå¯ä»¥ç”¨DepthwiseConvåšæ›¿æ¢è¿›è¡Œè§„é¿ï¼Œæ®è¯´DepthwiseConvçš„æ€§èƒ½è¿˜æ›´å¥½ä¸€äº›ã€‚</p><figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">layer &#123;</span><br><span class="line">  name: <span class="string">&quot;437_hp&quot;</span></span><br><span class="line">  type: <span class="string">&quot;Convolution&quot;</span></span><br><span class="line">  bottom: <span class="string">&quot;434&quot;</span></span><br><span class="line">  top: <span class="string">&quot;437&quot;</span></span><br><span class="line">  convolution_param &#123;</span><br><span class="line">    num_output: <span class="number">32</span></span><br><span class="line">    bias_term: <span class="literal">false</span></span><br><span class="line">    <span class="keyword">group</span>: <span class="number">32</span></span><br><span class="line">    pad_h: <span class="number">1</span></span><br><span class="line">    pad_w: <span class="number">1</span></span><br><span class="line">    kernel_h: <span class="number">3</span></span><br><span class="line">    kernel_w: <span class="number">3</span></span><br><span class="line">    stride_h: <span class="number">1</span></span><br><span class="line">    stride_w: <span class="number">1</span></span><br><span class="line">    dilation: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›¿æ¢ä¸º</p><figure class="highlight protobuf"><table><tr><td class="code"><pre><span class="line">layer &#123;</span><br><span class="line">  name: <span class="string">&quot;437_hp&quot;</span></span><br><span class="line">  type: <span class="string">&quot;DepthwiseConv&quot;</span></span><br><span class="line">  bottom: <span class="string">&quot;434&quot;</span></span><br><span class="line">  top: <span class="string">&quot;437&quot;</span></span><br><span class="line">  convolution_param &#123;</span><br><span class="line">    num_output: <span class="number">32</span></span><br><span class="line">    bias_term: <span class="literal">false</span></span><br><span class="line">    # <span class="keyword">group</span>: <span class="number">32</span></span><br><span class="line">    pad_h: <span class="number">1</span></span><br><span class="line">    pad_w: <span class="number">1</span></span><br><span class="line">    kernel_h: <span class="number">3</span></span><br><span class="line">    kernel_w: <span class="number">3</span></span><br><span class="line">    stride_h: <span class="number">1</span></span><br><span class="line">    stride_w: <span class="number">1</span></span><br><span class="line">    dilation: <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®æµ‹åœ¨ä»…å°†å‰ä¸¤ä¸ªå·ç§¯å±‚ç”¨FP16é‡åŒ–çš„æƒ…å†µä¸‹ï¼Œä¸Šè¿°äººè½¦ç‹—æ¨¡å‹æ··åˆé‡åŒ–çš„æ€§èƒ½ä¸INT8é‡åŒ–æ¥è¿‘ï¼ˆ&lt;1msï¼‰ï¼Œç²¾åº¦æ‰ç‚¹åœ¨å¯æ¥å—çš„èŒƒå›´å†…ï¼ˆ1-2ä¸ªç‚¹ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> HISI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> HISI </tag>
            
            <tag> NNIE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·æ€AIå¼€å‘ [3]ï¼šäº¤å‰ç¼–è¯‘OpenCV</title>
      <link href="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/"/>
      <url>/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/</url>
      
        <content type="html"><![CDATA[<h1>ä¸‹è½½</h1><p>ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„<a href="https://github.com/opencv/opencv/tree/4.1.0">opencv-4.1.0</a>å’Œ<a href="https://github.com/opencv/opencv_contrib/tree/4.1.0">opencv_contrib-4.1.0</a>çš„æºç <br><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/1.png" alt="1"><br><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/2.png" alt="2"><br>ä¸‹è½½çš„å‹ç¼©åŒ…æ‹·è´åˆ°linuxæœåŠ¡å™¨ä¸Šï¼Œè§£å‹</p><h1>å®‰è£…cmake-gui</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install cmake-gui</span><br></pre></td></tr></table></figure><h1>è¿è¡Œcmake-gui</h1><h2 id="é€‰æ‹©source-codeè·¯å¾„å’Œbuildè·¯å¾„ï¼Œç‚¹å‡»Configure">é€‰æ‹©source codeè·¯å¾„å’Œbuildè·¯å¾„ï¼Œç‚¹å‡»Configure</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/3.png" alt="3"></p><h2 id="é€‰æ‹©äº¤å‰ç¼–è¯‘é…ç½®é€‰é¡¹">é€‰æ‹©äº¤å‰ç¼–è¯‘é…ç½®é€‰é¡¹</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/4.png" alt="4"></p><h2 id="é…ç½®cå’Œc-çš„ç¼–è¯‘å™¨">é…ç½®cå’Œc++çš„ç¼–è¯‘å™¨</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/5.png" alt="5"></p><h2 id="ç‚¹å‡»finishä¼šè¿›è¡Œåˆæ­¥çš„é…ç½®">ç‚¹å‡»finishä¼šè¿›è¡Œåˆæ­¥çš„é…ç½®</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/6.png" alt="6"></p><h2 id="è¿›ä¸€æ­¥é…ç½®">è¿›ä¸€æ­¥é…ç½®</h2><h3 id="é…ç½®buildç±»å‹">é…ç½®buildç±»å‹</h3><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/7.png" alt="7"></p><h3 id="é…ç½®å®‰è£…è·¯å¾„">é…ç½®å®‰è£…è·¯å¾„</h3><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/8.png" alt="8"></p><h3 id="å°†opencv-contribæ¨¡å—ä¹Ÿç¼–è¯‘è¿›æ¥">å°†opencv_contribæ¨¡å—ä¹Ÿç¼–è¯‘è¿›æ¥</h3><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/9.png" alt="9"></p><h3 id="ä¿é™©èµ·è§ï¼Œæ·»åŠ äº¤å‰ç¼–è¯‘å™¨çš„æ ¹ç›®å½•">ä¿é™©èµ·è§ï¼Œæ·»åŠ äº¤å‰ç¼–è¯‘å™¨çš„æ ¹ç›®å½•</h3><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/10.png" alt="10"></p><h3 id="å‹¾é€‰BUILD-opencv-world">å‹¾é€‰BUILD_opencv_world</h3><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/11.png" alt="11"></p><h2 id="å†æ¬¡ç‚¹å‡»Configureï¼Œå¼€å§‹è§£é—®é¢˜å§">å†æ¬¡ç‚¹å‡»Configureï¼Œå¼€å§‹è§£é—®é¢˜å§ ( :</h2><h3 id="é—®é¢˜1-ç¼ºå°‘boostdesc-bgm-i">é—®é¢˜1 ç¼ºå°‘boostdesc_bgm.i</h3><p>cmakeå°è¯•ä¸‹è½½è¯¥æ–‡ä»¶ï¼Œä½†ç½‘ç»œé—®é¢˜å¡ä½<br><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/12.png" alt="12"><br>æ‰“å¼€<code>opencv_contrib-4.1.0\modules\xfeatures2d\CMakeLists.txt</code>ï¼Œæ³¨é‡Šæ‰ä¸‹è½½çš„å‘½ä»¤<br><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/13.png" alt="13"></p><p>è¯¥æ¨¡å—ä¹Ÿä¼šå› æ­¤è¢«disableï¼Œç›®å‰ç”¨ä¸åˆ°ï¼Œå…ˆå…³äº†å§</p><p>ä¹Ÿå¯ä»¥è‡ªè¡Œä¸‹è½½å¯¹åº”çš„æ–‡ä»¶æ”¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œè¿™é‡Œå…ˆä¸ç®¡äº†(æ˜¯ç¦ä¸æ˜¯ç¥¸ï¼Œæ˜¯ç¥¸èº²ä¸è¿‡ ( : )</p><h3 id="é—®é¢˜2-ç¼ºå°‘face-landmark-model-dat">é—®é¢˜2 ç¼ºå°‘face_landmark_model.dat</h3><p>æ‰“å¼€<code>opencv_contrib-4.1.0\modules\face\CMakeLists.txt</code>ï¼Œæ³¨é‡Šæ‰ä¸‹è½½çš„å‘½ä»¤<br><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/14.png" alt="14"></p><p>åŒæ ·ï¼Œå½±å“æš‚æ—¶æœªçŸ¥</p><p>å†æ¬¡ç‚¹å‡»Configureï¼ŒConfiguring done</p><p>ç‚¹å‡»Generateï¼ŒGenerating done</p><h1>å¼€å§‹make</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> build_hisi</span><br><span class="line">make -j8</span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜1">é—®é¢˜1</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/15.png" alt="15"></p><p>åœ¨<code>common.cc</code>ä¸­å¢åŠ å®å®šä¹‰<code>#define HAVE_PTHREAD</code></p><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/16.png" alt="16"></p><h2 id="é—®é¢˜2-ç±»å‹è½¬æ¢é”™è¯¯">é—®é¢˜2 ç±»å‹è½¬æ¢é”™è¯¯</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/17.png" alt="17"></p><p>æ‰“å¼€<code>opencv-4.1.0\build_hisi\CMakeCache.txt</code>ï¼Œæ·»åŠ  <code>-fpermissive</code> ç¼–è¯‘é€‰é¡¹</p><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/18.png" alt="18"></p><h2 id="é—®é¢˜3-ç¼ºå°‘boostdesc-bgm-i">é—®é¢˜3 ç¼ºå°‘boostdesc_bgm.i</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/19.png" alt="19"></p><ul><li><p>ç»ˆç©¶é€ƒä¸æ‰ï¼Œè‡ªå·±ä¸‹è½½å§</p></li><li><p>æ‰“å¼€<code>\opencv_contrib-4.1.0\modules\xfeatures2d\cmake\download_boostdesc.cmake</code>ï¼Œå‚ç…§é‡Œé¢çš„ä¸‹è½½å†…å®¹æ‰“å¼€urlï¼Œå³é”®å¦å­˜ä¸ºæ–‡ä»¶ã€‚</p></li></ul><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/20.png" alt="20"></p><ul><li>åŒç†æ‰“å¼€<code>\opencv_contrib-4.1.0\modules\xfeatures2d\cmake\download_vgg.cmake</code>ï¼Œä¸‹è½½æ‰€éœ€å†…å®¹</li><li>å°†è¿™äº›ä¸‹è½½çš„æ–‡ä»¶æ‹·è´åˆ°<code>opencv_contrib-4.1.0\modules\xfeatures2d\src</code>ä¸‹</li></ul><h2 id="é—®é¢˜4-undefined-reference-to-â€œpthread-key-createâ€">é—®é¢˜4 undefined reference to â€œpthread_key_createâ€</h2><p>æ‰“å¼€<code>opencv-4.1.0\build_hisi\CMakeCache.txt</code>ï¼Œ<code>CMAKE_EXE_LINKER_FLAGS</code>æ·»åŠ  <code>-lpthread -lrt -ldl</code> é“¾æ¥é€‰é¡¹</p><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/21.png" alt="21"></p><h2 id="é—®é¢˜5">é—®é¢˜5</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/22.png" alt="22"></p><p>æ‰“å¼€<code>\opencv-4.1.0\3rdparty\libpng\pngpriv.h</code>ï¼Œåšå¦‚ä¸‹æ›¿æ¢</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#  <span class="meta-keyword">if</span> (defined(__ARM_NEON__) || defined(__ARM_NEON)) &amp;&amp; \</span></span><br></pre></td></tr></table></figure><p>æ›¿æ¢ä¸º</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> defined(PNG_ARM_NEON) &amp;&amp; (defined(__ARM_NEON__) || defined(__ARM_NEON)) &amp;&amp; \</span></span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜6">é—®é¢˜6</h2><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/23.png" alt="23"></p><p>å¤´æ–‡ä»¶includeåœ°å€ä¸å¯¹ï¼Œ<code>features2d/test/test_detectors_regression.impl.hpp</code>åœ¨opencv-4.1.0çš„<code>opencv-4.1.0/modules/</code>è€Œä¸æ˜¯<code>opencv_contrib-4.1.0/modules/</code></p><p>å°†ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ä»<code>opencv-4.1.0\modules\features2d\test</code>ç›®å½•æ‹·è´åˆ°<code>opencv_contrib-4.1.0\modules\xfeatures2d\test</code>ç›®å½•ä¸‹</p><blockquote><p>test_descriptors_invariance.impl.hpp<br>test_descriptors_regression.impl.hpp<br>test_detectors_invariance.impl.hpp<br>test_detectors_regression.impl.hpp<br>test_invariance_utils.hpp</p></blockquote><p>æ‰“å¼€<code>\opencv_contrib-4.1.0\modules\xfeatures2d\test\test_features2d.cpp</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;features2d/test/test_detectors_regression.impl.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;features2d/test/test_descriptors_regression.impl.hpp&quot;</span></span></span><br></pre></td></tr></table></figure><p>æ›¿æ¢ä¸º</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;test_detectors_regression.impl.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;test_descriptors_regression.impl.hpp&quot;</span></span></span><br></pre></td></tr></table></figure><p>æ‰“å¼€<code>\opencv_contrib-4.1.0\modules\xfeatures2d\test\test_rotation_and_scale_invariance.cpp</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;features2d/test/test_detectors_invariance.impl.hpp&quot;</span> <span class="comment">// main OpenCV repo</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;features2d/test/test_descriptors_invariance.impl.hpp&quot;</span> <span class="comment">// main OpenCV repo</span></span></span><br></pre></td></tr></table></figure><p>æ›¿æ¢ä¸º</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;test_detectors_invariance.impl.hpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;test_descriptors_invariance.impl.hpp&quot;</span></span></span><br></pre></td></tr></table></figure><h1>make install</h1><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">make install</span><br></pre></td></tr></table></figure><p><img src="/2021/12/01/Hi3559AV100-3-CrossCompileOpenCV/24.png" alt="24"></p><h1>æµ‹è¯•åº“</h1><ul><li>åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š</li></ul><p><code>cvtColor.cpp</code></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    Mat img = <span class="built_in">imread</span>(<span class="string">&quot;./dog.jpg&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (img.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;reading image fails \n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Mat gray;</span><br><span class="line">    <span class="built_in">cvtColor</span>(img, gray, COLOR_BGR2GRAY);</span><br><span class="line">    <span class="built_in">imwrite</span>(<span class="string">&quot;./dog_gray.png&quot;</span>, gray);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;cvtColor done\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>CMakeLists.txt</code></p><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.0</span>.<span class="number">0</span> FATAL_ERROR)</span><br><span class="line"><span class="keyword">find_package</span>(OpenCV REQUIRED opencv_world)</span><br><span class="line"><span class="comment"># SET(OpenCV_LIBS &quot;/home/aaron-wu/opencv/arm-linux-hisi/lib/libopencv_world.so&quot;)</span></span><br><span class="line"><span class="comment"># SET(OpenCV_INCLUDE_DIRS &quot;/home/aaron-wu/opencv/arm-linux-hisi/include/opencv4&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># skip rpath</span></span><br><span class="line"><span class="comment"># SET(CMAKE_SKIP_RPATH TRUE)</span></span><br><span class="line"><span class="comment"># SET(CMAKE_SKIP_BUILD_RPATH TRUE)</span></span><br><span class="line"><span class="comment"># SET(CMAKE_SKIP_INSTALL_RPATH TRUE)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set rpath self</span></span><br><span class="line"><span class="keyword">SET</span>(CMAKE_BUILD_WITH_INSTALL_RPATH <span class="keyword">TRUE</span>)</span><br><span class="line"><span class="keyword">SET</span>(CMAKE_INSTALL_RPATH <span class="string">&quot;/lib&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_executable</span>(demo cvtColor.cpp)</span><br><span class="line"><span class="keyword">SET</span>(CMAKE_EXE_LINKER_FLAGS <span class="string">&quot;$&#123;CMAKE_EXE_LINKER_FLAGS&#125; -lpthread -lrt -ldl&quot;</span>)</span><br><span class="line"><span class="keyword">message</span>(STATUS <span class="variable">$&#123;OpenCV_LIBS&#125;</span>)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(demo PUBLIC <span class="variable">$&#123;OpenCV_LIBS&#125;</span>)</span><br><span class="line"><span class="keyword">target_include_directories</span>(demo PUBLIC <span class="variable">$&#123;OpenCV_INCLUDE_DIRS&#125;</span>)</span><br></pre></td></tr></table></figure><ul><li>build&amp;make</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">touch build.sh</span><br><span class="line"><span class="comment"># ç¼–è¾‘build.shå¦‚ä¸‹</span></span><br><span class="line">sh build.sh</span><br></pre></td></tr></table></figure><p><code>build.sh</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmake -DCMAKE_BUILD_TYPE=Release \</span><br><span class="line">    -DCMAKE_C_COMPILER=aarch64-himix210-linux-gcc \</span><br><span class="line">    -DCMAKE_CXX_COMPILER=aarch64-himix210-linux-g++ \</span><br><span class="line">    -DOpenCV_DIR=/home/aaron-wu/opencv/arm-linux-hisi/lib/cmake/opencv4 \</span><br><span class="line">    ..</span><br><span class="line">make -j4</span><br></pre></td></tr></table></figure><ul><li>ç”Ÿæˆdemoæ‹·è´åˆ°æ¿å­ä¸Šï¼ŒåŒæ—¶æ‹·è´<code>libopencv_world.so</code>åˆ°æ¿å­çš„<code>/lib</code>ç›®å½•ä¸‹</li><li>åœ¨æ¿å­ä¸Šæ‰§è¡Œ<code>./demo</code>ï¼ŒæˆåŠŸã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> HISI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> HISI </tag>
            
            <tag> NNIE </tag>
            
            <tag> OpenCV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·æ€AIå¼€å‘ [2]ï¼šæ­å»ºå¼€å‘ç¯å¢ƒ</title>
      <link href="/2021/12/01/Hi3559AV100-2-SetEnv/"/>
      <url>/2021/12/01/Hi3559AV100-2-SetEnv/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åœ¨ Linux æœåŠ¡å™¨ä¸Šå»ºç«‹äº¤å‰ç¼–è¯‘ç¯å¢ƒï¼ŒWindows å·¥ä½œå°é€šè¿‡ä¸²å£å’Œç½‘å£ä¸Hi3559AV100 å•æ¿è¿æ¥ï¼Œå¼€å‘äººå‘˜å¯ä»¥åœ¨ Windows å·¥ä½œå°ä¸­è¿›è¡Œç¨‹åºå¼€å‘æˆ–è€…è¿œç¨‹ç™»å½•åˆ° Linux æœåŠ¡å™¨è¿›è¡Œç¨‹åºå¼€å‘ã€‚</p></blockquote><p><img src="/2021/12/01/Hi3559AV100-2-SetEnv/1.png" alt="1"></p><h1>æ­å»ºLinuxæœåŠ¡å™¨ç¯å¢ƒ</h1><h2 id="ä½¿ç”¨wslå®‰è£…Ubuntu18-04">ä½¿ç”¨wslå®‰è£…Ubuntu18.04</h2><ul><li><ol><li>ç›´æ¥åœ¨Windows Storeä¸­æœç´¢linuxè¿›è¡Œå®‰è£…</li></ol></li><li><ol start="2"><li><a href="https://github.com/DDoSolitary/LxRunOffline/releases/download/v3.4.1/LxRunOffline-v3.4.1-msvc.zip">ä¸‹è½½ç®¡ç†å·¥å…·</a></li></ol></li></ul><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;tool<span class="literal">-dir</span>&gt;</span><br><span class="line">.\LxRunOffline.exe <span class="literal">-h</span>   <span class="comment"># æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line"></span><br><span class="line">.\LxRunOffline.exe list  <span class="comment"># æŸ¥çœ‹å½“å‰å·²æœ‰çš„WSL</span></span><br><span class="line"></span><br><span class="line">.\LxRunOffline.exe di <span class="literal">-n</span> Ubuntu  <span class="comment"># æŸ¥çœ‹å­ç³»ç»Ÿçš„ä½ç½®</span></span><br><span class="line"></span><br><span class="line">.\LxRunOffline.exe <span class="built_in">move</span> <span class="literal">-n</span> Ubuntu <span class="literal">-d</span> &lt;tar<span class="literal">-dir</span>&gt; <span class="comment"># å°†å­ç³»ç»Ÿç§»åŠ¨åˆ°æŒ‡å®šæ–‡ä»¶å¤¹</span></span><br></pre></td></tr></table></figure><ul><li><ol start="3"><li>é€šè¿‡ç®¡ç†å·¥å…·å¯ä»¥å°†å­ç³»ç»Ÿç§»åŠ¨åˆ°éCç›˜ï¼Œé˜²æ­¢Cç›˜çˆ†ç‚¸</li></ol></li></ul><h2 id="å®‰è£…nfsï¼Œsamnaï¼Œsshç­‰ç½‘ç»œç»„ä»¶">å®‰è£…nfsï¼Œsamnaï¼Œsshç­‰ç½‘ç»œç»„ä»¶</h2><p>æš‚æ—¶ç•¥è¿‡ï¼Œwindowså¯ä»¥é€šè¿‡<code>\\wsl$\Ubuntu-18.04</code>è®¿é—®wslçš„æ–‡ä»¶ç³»ç»Ÿ</p><h2 id="è½¯ä»¶åŒ…å®‰è£…">è½¯ä»¶åŒ…å®‰è£…</h2><ul><li><ol><li>é…ç½®é»˜è®¤ä½¿ç”¨bashï¼Œæ‰§è¡Œ<code>sudo dpkg-reconfigure dash</code>ï¼Œé€‰no</li></ol></li><li><ol start="2"><li>æ‰§è¡Œå¦‚ä¸‹ï¼Œå®‰è£…è½¯ä»¶åŒ…ï¼š</li></ol></li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install make libc6:i386 lib32z1 lib32stdc++6 zlib1g-dev libncurses5-dev ncurses-term libncursesw5-dev g++ u-boot-tools:i386 texinfo texlive gawk libssl-dev openssl bc</span><br></pre></td></tr></table></figure><p>æŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><blockquote><p>Package libc6:i386 is not available, but is referred to by another package.<br>This may mean that the package is missing, has been obsoleted, or<br>is only available from another source<br>However the following packages replace it:<br>libdb1-compat tzdata</p></blockquote><blockquote><p>E: Package â€˜libc6:i386â€™ has no installation candidate<br>E: Unable to locate package u-boot-tools:i386</p></blockquote><p>è·³è¿‡<code>libc6:i386</code>ï¼Œç›´æ¥å®‰è£…<code>lib32z1</code>ï¼Œä¼šæç¤ºå¦‚ä¸‹ï¼š</p><blockquote><p>The following additional packages will be installed:<br>libc6-i386<br>The following NEW packages will be installed:<br>lib32z1 libc6-i386</p></blockquote><p>è¿™åº”è¯¥æ˜¯åå­—å†™çš„æœ‰é—®é¢˜ï¼ŒåŒæ ·<code>u-boot-tools:i386</code>ä¹Ÿä¼šæœ‰ï¼š</p><blockquote><p>E: Unable to locate package u-boot-tools:i386`</p></blockquote><p>å°è¯•<code>u-boot-tools-i386</code>ä¹Ÿä¸è¡Œï¼Œå®‰è£…<code>u-boot-tools</code>å€’æ˜¯å¯ä»¥ã€‚</p><p>å…¶ä»–è½¯ä»¶åŒ…å®‰è£…æ²¡æœ‰é—®é¢˜ã€‚</p><ul><li><ol start="3"><li>åˆ›å»º<code>/etc/ld.so.preload</code>æ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œ <code>echo &quot;&quot; &gt; /etc/ld.so.preload</code>ï¼Œä»¥è§£å†³ 64bit linux server ä¸ŠæŸäº›ç¬¬ä¸‰æ–¹åº“ç¼–è¯‘å¤±è´¥çš„é—®é¢˜ã€‚</li></ol></li></ul><h2 id="å®‰è£…äº¤å‰ç¼–è¯‘å·¥å…·">å®‰è£…äº¤å‰ç¼–è¯‘å·¥å…·</h2><ul><li><ol><li>å°†<code>aarch64-himix210-linux.tgz</code>æ‹·è´åˆ°linuxç³»ç»Ÿ<code>~</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</li></ol></li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -xvf aarch64-himix210-linux.tgz</span><br><span class="line"><span class="built_in">cd</span> aarch64-himix210-linux/</span><br><span class="line">sudo ./aarch64-himix210-linux.install</span><br></pre></td></tr></table></figure><ul><li><ol start="2"><li>æ‰“å°å¦‚ä¸‹æç¤ºä¿¡æ¯ï¼š</li></ol></li></ul><blockquote><p>Installing HuaWei LiteOS Linux at /opt/hisi-linux/x86-arm<br>mkdir: created directory â€˜/opt/hisi-linuxâ€™<br>mkdir: created directory â€˜/opt/hisi-linux/x86-armâ€™<br>mkdir: created directory â€˜/opt/hisi-linux/x86-arm/aarch64-himix210-linuxâ€™<br>Extract cross tools â€¦<br>export path /opt/hisi-linux/x86-arm/aarch64-himix210-linux/bin</p></blockquote><p>æ˜¯ä¸ºå®‰è£…æˆåŠŸ</p><h2 id="æµ‹è¯•äº¤å‰ç¼–è¯‘å·¥å…·">æµ‹è¯•äº¤å‰ç¼–è¯‘å·¥å…·</h2><p>å†™äº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•å·¥ç¨‹ï¼Œç›®å½•ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hello</span><br><span class="line">|--build</span><br><span class="line">    |--corss_build.sh</span><br><span class="line">|--include</span><br><span class="line">    |--hello.h</span><br><span class="line">|--src</span><br><span class="line">    |--hello.cc</span><br><span class="line">|--CMakeLists.txt</span><br><span class="line">|--main.cc</span><br></pre></td></tr></table></figure><p><code>cross_build.sh</code>å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cmake -DCMAKE_BUILD_TYPE=Release \</span><br><span class="line">    -DCMAKE_C_COMPILER=aarch64-himix210-linux-gcc \</span><br><span class="line">    -DCMAKE_CXX_COMPILER=aarch64-himix210-linux-g++ \</span><br><span class="line">    ..</span><br><span class="line">make -j4</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œshæ–‡ä»¶ç»“æœå¦‚ä¸‹ï¼š</p><blockquote><p>â€“ The C compiler identification is GNU 7.3.0<br>â€“ The CXX compiler identification is GNU 7.3.0<br>â€“ Check for working C compiler: /opt/hisi-linux/x86-arm/aarch64-himix210-linux/bin/aarch64-himix210-linux-gcc<br>â€“ Check for working C compiler: /opt/hisi-linux/x86-arm/aarch64-himix210-linux/bin/aarch64-himix210-linux-gcc â€“ works<br>â€“ Detecting C compiler ABI info<br>â€“ Detecting C compiler ABI info - done<br>â€“ Detecting C compile features<br>â€“ Detecting C compile features - done<br>â€“ Check for working CXX compiler: /opt/hisi-linux/x86-arm/aarch64-himix210-linux/bin/aarch64-himix210-linux-g++<br>â€“ Check for working CXX compiler: /opt/hisi-linux/x86-arm/aarch64-himix210-linux/bin/aarch64-himix210-linux-g++ â€“ works<br>â€“ Detecting CXX compiler ABI info<br>â€“ Detecting CXX compiler ABI info - done<br>â€“ Detecting CXX compile features<br>â€“ Detecting CXX compile features - done<br>â€“ Configuring done<br>â€“ Generating done<br>â€“ Build files have been written to: /home/aaron-wu/cross_compile_test/hello/build<br>Scanning dependencies of target hello<br>[ 66%] Building CXX object CMakeFiles/hello.dir/src/hello.cc.o<br>[ 66%] Building CXX object CMakeFiles/hello.dir/main.cc.o<br>[100%] Linking CXX executable hello<br>[100%] Built target hello<br>ç¼–è¯‘æˆåŠŸ</p></blockquote><h1>é¦–æ¬¡å®‰è£…SDK</h1><h2 id="SDKåŒ…">SDKåŒ…</h2><p>åœ¨<code>Hi3559AV100***/01.software/board</code>ç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>Hi3559AV100_SDK_Vx.x.x.x.tgz</code> çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°±æ˜¯ Hi3559AV100 çš„è½¯ä»¶å¼€å‘åŒ…</p><h2 id="è§£å‹ç¼©SDKåŒ…">è§£å‹ç¼©SDKåŒ…</h2><ul><li><ol><li>å°†ä¸Šè¿°SDKåŒ…æ‹·è´åˆ°linuxæœåŠ¡å™¨ä¸Š</li></ol></li><li><ol start="2"><li>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œè§£å‹ç¼©</li></ol></li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -zxf Hi3559AV100_SDK_Vx.x.x.x.tgz</span><br></pre></td></tr></table></figure><h2 id="å±•å¼€SDKåŒ…å†…å®¹">å±•å¼€SDKåŒ…å†…å®¹</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> Hi3559AV100_SDK_V2.0.4.0/</span><br><span class="line">sudo sh ./sdk.cleanup</span><br><span class="line">sudo sh ./sdk.unpack</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HISI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> HISI </tag>
            
            <tag> NNIE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ·æ€AIå¼€å‘ [1]ï¼šRuyiStudioå®‰è£…</title>
      <link href="/2021/11/30/Hi3559AV100-1-setup/"/>
      <url>/2021/11/30/Hi3559AV100-1-setup/</url>
      
        <content type="html"><![CDATA[<h1>ç¼–è¯‘é“¾MinGW-W64å®‰è£…</h1><h2 id="ä¸‹è½½MinGW-W64"><a href="https://sourceforge.net/projects/mingw-w64/files/mingw-w64/">ä¸‹è½½MinGW-W64</a></h2><p><img src="/2021/11/30/Hi3559AV100-1-setup/1.png" alt="1"></p><p>ä¸‹è½½å®Œæ¯•åè§£å‹åˆ°æŒ‡å®šè·¯å¾„ï¼Œæˆ‘è¿™é‡Œæ˜¯<code>D:\software\mingw64</code></p><h2 id="ä¸‹è½½msys"><a href="https://sourceforge.net/projects/mingwbuilds/files/external-binary-packages/">ä¸‹è½½msys</a></h2><p>ä¸‹è½½å®Œæ¯•è§£å‹åˆ°mingw64æ ¹ç›®å½•ä¸‹</p><p><img src="/2021/11/30/Hi3559AV100-1-setup/2.png" alt="2"></p><h2 id="æ·»åŠ ç³»ç»Ÿå˜é‡">æ·»åŠ ç³»ç»Ÿå˜é‡</h2><p><code>D:\software\mingw64\bin</code>å’Œ<code>D:\software\mingw64\msys\bin</code>æ·»åŠ åˆ°ç³»ç»Ÿå˜é‡</p><h2 id="é‡å‘½ågcc">é‡å‘½ågcc</h2><p>å°†<code>D:\software\mingw64\bin</code>ä¸‹<code>x86_64-w64-mingw32-gcc.exe</code>å†æ‹·è´ä¸€ä»½å¹¶é‡å‘½åä¸º<code>mingw32-gcc.exe</code>ï¼Œå¦åˆ™RuyiStudioå·¥å…·ä¸èƒ½è‡ªåŠ¨è¯†åˆ«åˆ°MinGWå·¥å…·é“¾ã€‚</p><h2 id="é‡å¯è®¡ç®—æœº">é‡å¯è®¡ç®—æœº</h2><h1>Python3.5+Caffeç¯å¢ƒé…ç½®</h1><h2 id="ä¸‹è½½caffe-builder"><a href="https://github.com/willyd/caffe-builder/releases">ä¸‹è½½caffe-builder</a></h2><p>ä¸‹è½½å®Œæ¯•åæ”¾åˆ°<code>D:\software\ruyi_env_setup</code>ï¼ˆæˆ‘æ‹·è´äº†ä¸€ä»½è¯¥æ–‡ä»¶å¤¹<code>&lt;your-dir&gt;\SVP_PC\HiSVP_PC_V1.1.4.0\tools\nnie\windows\ruyi_env_setup-3.0.7</code>ï¼‰</p><blockquote><p>å…¶å®ä¸‹é¢çš„è„šæœ¬ä¼šå†ä¸‹ä¸€æ¬¡ = =<br><img src="/2021/11/30/Hi3559AV100-1-setup/3.png" alt="3"></p></blockquote><h2 id="æ‰§è¡Œsetup-python-batè„šæœ¬">æ‰§è¡Œsetup_python.batè„šæœ¬</h2><p>å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼Œéœ€æ‰‹åŠ¨é…ç½®ï¼š</p><ul><li><ol><li>wget ä¸‹è½½ä¸­æ–­æˆ–è€…æ— æ³•è¿æ¥åˆ°urlçš„è¯ï¼Œæ€æ‰è¿›ç¨‹ï¼Œå†å¼€</li></ol></li><li><ol start="2"><li>ç¯å¢ƒå˜é‡é…ç½®å¤±è´¥ï¼Œpathè¶…è¿‡1024ä¸ªå­—ç¬¦</li></ol></li></ul><p><img src="/2021/11/30/Hi3559AV100-1-setup/4.png" alt="4"></p><ul><li><ol start="3"><li>æ‰‹åŠ¨é…ç½®pathï¼š<strong>ç³»ç»Ÿ</strong>ç¯å¢ƒå˜é‡ä¸­å¢åŠ å˜é‡<code>RUYI_PYTHON_PATH</code>ï¼Œå˜é‡å€¼è®¾å®šå¦‚ä¸‹ï¼š</li></ol></li></ul><p><img src="/2021/11/30/Hi3559AV100-1-setup/5.png" alt="5"></p><ul><li><ol start="4"><li>æ·»åŠ <code>%RUYI_PYTHON_PATH%</code>åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡pathçš„å¼€å¤´ï¼›</li></ol></li><li><ol start="5"><li>æ‰‹åŠ¨æ·»åŠ <strong>ç”¨æˆ·</strong>ç¯å¢ƒå˜é‡<code>PYTHONPATH</code>ï¼ˆå·²è¢«è„šæœ¬æ·»åŠ è¿‡äº†ï¼‰</li></ol></li></ul><p><img src="/2021/11/30/Hi3559AV100-1-setup/6.png" alt="6"></p><ul><li><ol start="6"><li>åç»­æ­¥éª¤4-8å‡ç•¥è¿‡ï¼ˆ4ã€5ã€6è„šæœ¬åšè¿‡äº†ï¼Œ <s>7ã€8åç»­è§†æƒ…å†µå†é…ç½®</s> ä¸é…ç½®ä¸è¡Œï¼Œ<a href="https://no5-aaron-wu.github.io/2021/12/07/Hi3559AV100-5-NormalQA/">åé¢è¿˜æ˜¯ä¼šå‡ºé—®é¢˜ </a>ï¼‰</li></ol></li></ul><h1>RuyiStudioå¯åŠ¨</h1><p>ä»SDKæ‹·è´<code>RuyiStudio-3.0.7.zip</code>åˆ°è‡ªå·±ç›®å½•ï¼ˆ<code>D:\software</code>ï¼‰ä¸‹ï¼Œè§£å‹ï¼ŒåŒå‡»RuyiStudio.exeä¾¿å¯å¯åŠ¨IDE</p><p><img src="/2021/11/30/Hi3559AV100-1-setup/7.png" alt="7"></p><p>é€‰æ‹©å·¥ä½œç›®å½•</p><p><img src="/2021/11/30/Hi3559AV100-1-setup/8.png" alt="8"></p><h1>å‚è€ƒ</h1><ul><li>ã€ŠHiSVP å¼€å‘æŒ‡å—.pdfã€‹</li></ul>]]></content>
      
      
      <categories>
          
          <category> HISI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> HISI </tag>
            
            <tag> NNIE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CUDAåŸºç¡€ [5]ï¼šäº’æ–¥é”è®¾è®¡</title>
      <link href="/2021/11/30/CUDA-5-mutexLock/"/>
      <url>/2021/11/30/CUDA-5-mutexLock/</url>
      
        <content type="html"><![CDATA[<h1>åˆç‰ˆ</h1><blockquote><p>æµä¼ ç”šå¹¿çš„ç‰ˆæœ¬ï¼Œæ¥è‡ªã€ŠGPUé«˜æ€§èƒ½ç¼–ç¨‹CUDAå®æˆ˜ã€‹ä¸­çš„sample</p></blockquote><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CudaKernelLock</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span>* mutex;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CudaKernelLock</span>(<span class="keyword">void</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> state = <span class="number">0</span>;</span><br><span class="line">        cudaError_t ret = <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span>**)&amp;mutex, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line">        ret = <span class="built_in">cudaMemcpy</span>(mutex, &amp;state, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">CudaKernelLock</span>() &#123;</span><br><span class="line">        <span class="built_in">cudaFree</span>(mutex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">__device__ <span class="keyword">void</span> <span class="title">lock</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">atomicCAS</span>(mutex, <span class="number">0</span>, <span class="number">1</span>) != <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">__device__ <span class="keyword">void</span> <span class="title">unlock</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">atomicExch</span>(mutex, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•æ€è·¯æ˜¯å¯è¡Œçš„ï¼Œå³é€šè¿‡åŸå­æ¯”è¾ƒäº¤æ¢æ“ä½œ<code>atomicCAS</code>ç«äº‰<code>mutex</code>ï¼Œ<code>atomicCAS</code><strong>è¯»å–</strong><code>mutex</code>çš„å€¼ï¼Œ<strong>è®¡ç®—</strong><code>(*mutex==0?1:*mutex)</code>,å¹¶å°†ç»“æœ<strong>å­˜å‚¨</strong>åœ¨åŸå†…å­˜åœ°å€ã€‚è¿™ä¸‰ä¸ªæ“ä½œä¸ºä¸€ä¸ªåŸå­äº‹åŠ¡ä¸­æ‰§è¡Œã€‚å‡½æ•°è¿”å›äº¤æ¢å‰çš„<code>*mutex</code>å€¼ã€‚è¿™æ ·å°±åœ¨ä¸€ä¸ªçº¿ç¨‹è·å–<code>mutex</code>å¹¶ç½®å€¼åï¼Œå…¶ä»–çº¿ç¨‹ä¸€ç›´åœ¨ç­‰å¾…ã€‚ç›´åˆ°<code>atomicExch</code>ç½®<code>mutex</code>ä¸º0åå¯å†æ¬¡è·å–ã€‚æ•…åœ¨æ ¸å‡½æ•°ä¸­<code>lock</code>å’Œ<code>unlock</code>å‡½æ•°ä¹‹é—´çš„æ“ä½œæ˜¯ä¸²è¡Œçš„ã€‚</p><h1>å­˜åœ¨é—®é¢˜ã€è¸©å‘&amp;å¡«å‘ã€‘</h1><p>ä½†ä¸Šè¿°å®ç°æœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><h2 id="è¯¥é”çš„è®¾è®¡åªèƒ½åœ¨CUDAçš„blockä¹‹é—´åŠ é”ã€‚">è¯¥é”çš„è®¾è®¡åªèƒ½åœ¨CUDAçš„blockä¹‹é—´åŠ é”ã€‚</h2><p>ä¸€ä¸ªblockåªèƒ½æœ‰ä¸€ä¸ªthreadï¼Œå³æ ¸å‡½æ•°åªèƒ½è®¾è®¡æˆ<code>kernel&lt;&lt;&lt;128,1&gt;&gt;&gt;(...)</code>è€Œä¸èƒ½æ˜¯<code>kernel&lt;&lt;&lt;1,128&gt;&gt;&gt;(...)</code>ï¼Œå¦åˆ™åˆ™ä¼š<strong>æ­»é”</strong>ã€‚åŸå› æ˜¯å› ä¸ºCUDAæ˜¯ä»¥warpä¸ºå•ä½è¿è¡Œçš„ï¼Œè€Œwarpçš„è¿è¡Œéµå¾ªåŒæ­¥æ‰§è¡Œè§„åˆ™ï¼ˆlocked-step executionï¼‰ï¼Œå³ä¸€ä¸ªwarpä¸­çš„çº¿ç¨‹åŒæ—¶æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åŒæ—¶é€€å‡ºä¸€ä¸ªå‡½æ•°ï¼ˆSIMTï¼‰ã€‚ä¸€ä¸ªwarpï¼ˆé€šå¸¸æ˜¯32ä¸ªthreadï¼‰å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹è·å¾—é”ä¹‹åï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹ä¸€èµ·é€€å‡ºlockå‡½æ•°ï¼Œä½†å…¶ä»–çº¿ç¨‹ç­‰å¾…è¯¥çº¿ç¨‹æ‰§è¡Œunlockæ¥é‡Šæ”¾é”ï¼Œä»è€Œå‡ºç°äº†æ­»é”ã€‚ä½†å½“ä¸€ä¸ªblockä¸­åªæœ‰ä¸€ä¸ªthreadæ—¶ï¼Œä¸€ä¸ªwarpä¸­åªæœ‰ä¸€ä¸ªthreadï¼Œè¿›è€Œä¸ä¼šæ­»é”ã€‚</p><h2 id="lockå’Œunlockå‡½æ•°ä¹‹é—´çš„éåŸå­æ“ä½œï¼Œå¹¶ä¸ä¸€å®šæ˜¯ä¸¥æ ¼çº¿ç¨‹å®‰å…¨çš„ã€‚"><code>lock</code>å’Œ<code>unlock</code>å‡½æ•°ä¹‹é—´çš„éåŸå­æ“ä½œï¼Œå¹¶ä¸ä¸€å®šæ˜¯ä¸¥æ ¼çº¿ç¨‹å®‰å…¨çš„ã€‚</h2><p>å¦‚ä¸‹æ‰€ç¤ºä¸ºä¸€ä¸ªè®¡ç®—æ•°ç»„ä¸­å¤§äºé˜ˆå€¼çš„å…ƒç´ ä¸ªæ•°çš„æ“ä½œã€‚ç„¶è€Œå¹¶ä¸èƒ½å¾—åˆ°æ­£ç¡®çš„<code>cnt</code>ç»“æœã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">GtThrCntKernel</span><span class="params">(<span class="keyword">float</span>* src, <span class="keyword">int</span> len, <span class="keyword">float</span> thr, <span class="keyword">int</span>* cnt, CudaKernelLock Lock)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pos_start = blockDim.x * blockIdx.x + threadIdx.x;</span><br><span class="line">    <span class="keyword">int</span> pos_step = blockDim.x * gridDim.x;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = pos_start;i &lt; len;i += pos_step) &#123;</span><br><span class="line">        <span class="keyword">if</span> (src[i] &lt;= thr) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Lock.<span class="built_in">lock</span>();</span><br><span class="line">        *cnt = *cnt + <span class="number">1</span>;</span><br><span class="line">        Lock.<span class="built_in">unlock</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><ol><li>åŸå› æ˜¯ä¸€ä¸ªçº¿ç¨‹å¯¹ä¸€ä¸ªå…¨å±€å­˜å‚¨å™¨æˆ–å…±äº«å­˜å‚¨å™¨çš„ä¿®æ”¹å¹¶ä¸ä¸€å®šå¯¹å…¶ä»–blockä¸­çº¿ç¨‹æ˜¯ç«‹å³å¯è§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯èƒ½æœ‰äº›çº¿ç¨‹ä»ç„¶æ˜¯è¯»å–çš„è‹¥å¹²æ¬¡è‡ªå¢å‰çš„<code>cnt</code>ã€‚</li></ol></li><li><ol start="2"><li>è§£å†³è¿™ä¸ªé—®é¢˜æœ‰ä¸‰ç§æ–¹æ³•ï¼š</li></ol><ul><li><ol><li>åœ¨è‡ªå¢ååŠ ä¸ªå»¶æ—¶å‡½æ•°ï¼Œä½†åŠ å¤šé•¿åˆé€‚ï¼ŒåŠ å°‘äº†ä¸å®‰å…¨ï¼ŒåŠ å¤šäº†å½±å“æ•ˆç‡ï¼Œå¤ªè ¢äº†ï¼›</li></ol></li><li><ol start="2"><li>å°†<code>*cnt = *cnt + 1;</code>æ›¿æ¢ä¸º<code>atomicAdd(cnt, 1);</code>,ä»¥ç¡®ä¿è¯»å†™æ“ä½œéƒ½æ˜¯åŸå­çš„ï¼›</li></ol></li><li><ol start="3"><li>æ›´åŠ <strong>é€šç”¨</strong>çš„æ–¹æ³•æ˜¯ä½¿ç”¨<code>__threadfence()</code>ï¼Œå¯¹è¯¥å‘½ä»¤çš„å®˜æ–¹è§£é‡Šæ˜¯èƒ½ç¡®ä¿æ‰§è¡Œè¯¥å‘½ä»¤çš„çº¿ç¨‹åœ¨åœ¨è¯¥è¯­å¥å‰å¯¹å…¨å±€å­˜å‚¨å™¨æˆ–å…±äº«å­˜å‚¨å™¨çš„è®¿é—®å·²ç»å…¨éƒ¨å®Œæˆï¼ˆä¸æ˜¯ä¿è¯æ‰€æœ‰çº¿ç¨‹è¿è¡Œåˆ°åŒä¸€ä½ç½®ï¼‰ï¼Œå³è¯¥å‘½ä»¤ä¹‹å‰çš„æ‰€ç”Ÿäº§çš„æ•°æ®èƒ½å¤Ÿå®‰å…¨åœ°è¢«å…¶ä»–çº¿ç¨‹æ¶ˆè´¹ï¼Œæ‰§è¡Œç»“æœå¯¹girdä¸­æ‰€æœ‰çº¿ç¨‹å¯è§ï¼ˆ<code>__threadfence_block()</code>æ˜¯æ‰§è¡Œç»“æœå¯¹blockä¸­æ‰€æœ‰çº¿ç¨‹å¯è§ï¼‰ã€‚å¯ä»¥åœ¨<code>lock</code>å’Œ<code>unlock</code>ä¸­åŠ ä¸Šè¯¥å‘½ä»¤ã€‚</li></ol></li></ul></li></ul><h2 id="å¦‚æœé‡‡ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„è°ƒç”¨æ–¹å¼ï¼Œè¯¥é”è®¾è®¡æ˜¯ä¸å¯é‡å…¥çš„ã€‚">å¦‚æœé‡‡ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„è°ƒç”¨æ–¹å¼ï¼Œè¯¥é”è®¾è®¡æ˜¯ä¸å¯é‡å…¥çš„ã€‚</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">callKernel</span><span class="params">()</span></span>&#123;</span><br><span class="line">    CudaKernelLock lock_;</span><br><span class="line">    <span class="comment">// prepare the data</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// launch kernel</span></span><br><span class="line">    GtThrCntKernel &lt;&lt; &lt;<span class="number">128</span>, <span class="number">1</span> &gt;&gt; &gt; (dev_a, len, thr, dev_c, lock_);</span><br><span class="line">    CudaError_t ret = <span class="built_in">cudaGetLastError</span>();</span><br><span class="line">    <span class="keyword">if</span> (ret != cudaSuccess) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;addKernel launch failed: %s\n&quot;</span>, <span class="built_in">cudaGetErrorString</span>(ret));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// launch kernel again</span></span><br><span class="line">    GtThrCntKernel &lt;&lt; &lt;<span class="number">128</span>, <span class="number">1</span> &gt;&gt; &gt; (dev_a, len, thr, dev_c, lock_);</span><br><span class="line">    ret = <span class="built_in">cudaGetLastError</span>();</span><br><span class="line">    <span class="keyword">if</span> (ret != cudaSuccess) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;addKernel launch failed: %s\n&quot;</span>, <span class="built_in">cudaGetErrorString</span>(ret));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><ol><li>é¦–å…ˆè¿™é‡Œæ ¸å‡½æ•°è°ƒç”¨æ—¶å¯¹<code>lock_</code>åªèƒ½ä¼ å€¼ï¼Œä¸èƒ½ä¼ å¼•ç”¨æˆ–æŒ‡é’ˆï¼Œå› ä¸º<code>lock_</code>å¯¹è±¡æ˜¯hostç«¯çš„é‡ï¼Œä¼ å¼•ç”¨æˆ–æŒ‡é’ˆç»™æ ¸å‡½æ•°ï¼Œæ ¸å‡½æ•°ä¸­æ˜¯æ²¡æœ‰åŠæ³•ç”¨çš„ã€‚</li></ol></li><li><ol start="2"><li>ä¼ å€¼çš„è¯å°±æ¶‰åŠåˆ°æ‹·è´æ„é€ ï¼Œå³æ ¸å‡½æ•°ä¸­ç”Ÿæˆä¸€ä¸ªè‡ªå·±çš„deviceç«¯çš„lockå¯¹è±¡ï¼Œå¹¶æ‰§è¡Œé»˜è®¤çš„æµ…æ‹·è´<code>mutex</code>æŒ‡é’ˆï¼Œæµ…æ‹·è´æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œæœ¬èº«ä¹Ÿå¸Œæœ›<code>mutex</code>åªæœ‰ä¸€ä»½ï¼Œä½†é—®é¢˜åœ¨äºæ ¸å‡½æ•°é€€å‡ºæ—¶ï¼Œææ„è‡ªå·±çš„lockå¯¹è±¡ä¼šæŠŠå”¯ä¸€çš„ä¸€ä¸ª<code>mutex</code>çš„å†…å­˜ç»™freeæ‰ï¼Œè¿™å°±å¯¼è‡´lock_å‡ºæ¥åå°±ä¸å¯ç”¨äº†ï¼Œå†æ¬¡å°†å…¶ä¼ å…¥kernelå‡½æ•°æ—¶ï¼Œ<code>mutex</code>æŒ‡é’ˆå°±æ˜¯ä¸ªé‡æŒ‡é’ˆäº†ï¼Œæ­¤æ—¶<code>cudaGetLastError</code>ä¼šæŠ¥é”™ã€‚</li></ol></li><li><ol start="3"><li><strong>è§£å†³åŠæ³•1</strong>ï¼šæå‰å°†lockå¯¹è±¡æ‹·è´åˆ°deviceç«¯ï¼Œæ ¸å‡½æ•°ä¼ deviceç«¯çš„æŒ‡é’ˆï¼Œå°±é¿å…å‡½æ•°å†…æ‹·è´æ„é€ å’Œææ„é—®é¢˜ã€‚</li></ol></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">GtThrCntKernel</span><span class="params">(<span class="keyword">float</span>* src, <span class="keyword">int</span> len, <span class="keyword">float</span> thr, <span class="keyword">int</span>* cnt, CudaKernelLock* Lock)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pos_start = blockDim.x * blockIdx.x + threadIdx.x;</span><br><span class="line">    <span class="keyword">int</span> pos_step = blockDim.x * gridDim.x;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = pos_start;i &lt; len;i += pos_step) &#123;</span><br><span class="line">        <span class="keyword">if</span> (src[i] &lt;= thr) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Lock-&gt;<span class="built_in">lock</span>();</span><br><span class="line">        <span class="built_in">atomicAdd</span>(cnt, <span class="number">1</span>);</span><br><span class="line">        Lock-&gt;<span class="built_in">unlock</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">callKernel</span><span class="params">()</span></span>&#123;</span><br><span class="line">    CudaKernelLock lock_;</span><br><span class="line">    CudaKernelLock *dev_lock_;</span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span>**)&amp;dev_lock_, <span class="built_in"><span class="keyword">sizeof</span></span>(CudaKernelLock));</span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(dev_lock_, &amp;lock_, <span class="built_in"><span class="keyword">sizeof</span></span>(CudaKernelLock), cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="comment">// prepare the data</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// launch kernel</span></span><br><span class="line">    GtThrCntKernel &lt;&lt; &lt;<span class="number">128</span>, <span class="number">1</span> &gt;&gt; &gt; (dev_a, len, thr, dev_c, dev_lock_);</span><br><span class="line">    CudaError_t ret = <span class="built_in">cudaGetLastError</span>();</span><br><span class="line">    <span class="keyword">if</span> (ret != cudaSuccess) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;addKernel launch failed: %s\n&quot;</span>, <span class="built_in">cudaGetErrorString</span>(ret));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// launch kernel again</span></span><br><span class="line">    GtThrCntKernel &lt;&lt; &lt;<span class="number">128</span>, <span class="number">1</span> &gt;&gt; &gt; (dev_a, len, thr, dev_c, dev_lock_);</span><br><span class="line">    ret = <span class="built_in">cudaGetLastError</span>();</span><br><span class="line">    <span class="keyword">if</span> (ret != cudaSuccess) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;addKernel launch failed: %s\n&quot;</span>, <span class="built_in">cudaGetErrorString</span>(ret));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><ol start="4"><li><strong>è§£å†³åŠæ³•2</strong>ï¼šå•ç‹¬å°è£…<code>Mutex</code>ç±»ï¼ŒLockç±»ä¸­ç”¨shared_ptrç®¡ç†<code>Mutex</code>ï¼Œæ‹·è´æ„é€ æ—¶åªä¼šè®©shared_ptrçš„use_countåŠ 1ï¼Œä¸ä¼šç”Ÿæˆæ–°çš„<code>Mutex</code>å‰¯æœ¬ï¼Œä¸”åªæœ‰æœ€åä¸€ä¸ªshared_ptrææ„çš„æ—¶å€™ï¼ˆuse_countä¸º0æ—¶ï¼‰ï¼Œæ‰ä¼šææ„<code>Mutex</code>ï¼Œå¯ä»¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ã€‚ä½†æ˜¯é—æ†¾çš„æ˜¯ï¼Œ<code>__deivice__</code>å‡½æ•°ä¸­ä¸æ”¯æŒshared_ptré‡è½½çš„<code>-&gt;</code>æ“ä½œç¬¦ï¼Œæˆ‘ä»¬åªèƒ½åœ¨<code>__device__</code>å‡½æ•°å¤–é¢å¤–å®šä¹‰å˜é‡<code>mutex_ptr</code>å–å¾—<code>Mutex</code>ç±»å¯¹è±¡ä¸­çš„<code>mutex</code>æŒ‡é’ˆï¼Œè¿˜å¾—è‡ªå·±å®ç°æ‹·è´æ„é€ å‡½æ•°(é»˜è®¤çš„æ‹·è´æ„é€ ä¹Ÿè¡Œ)ï¼Œå°±æœ‰äº†å¦‚ä¸‹ç•¥æ˜¾ä¸‘é™‹çš„å®ç°ã€‚</li></ol></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mutex</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span>* mutex;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Mutex</span>() &#123;</span><br><span class="line">        <span class="keyword">int</span> state = <span class="number">0</span>;</span><br><span class="line">        cudaError_t ret = <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span>**)&amp;mutex, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line">        ret = <span class="built_in">cudaMemcpy</span>(mutex, &amp;state, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">Mutex</span>() &#123;</span><br><span class="line">        <span class="built_in">cudaFree</span>(mutex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CudaKernelLock</span> &#123;</span>Â·</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    std::shared_ptr&lt;Mutex&gt; mutex = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">int</span>* mutex_ptr = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CudaKernelLock</span>(<span class="keyword">void</span>) &#123;</span><br><span class="line">        mutex = std::make_shared&lt;Mutex&gt;();</span><br><span class="line">        mutex_ptr = mutex-&gt;mutex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">CudaKernelLock</span>(<span class="keyword">const</span> CudaKernelLock&amp; lock) &#123;</span><br><span class="line">        mutex = lock.mutex;</span><br><span class="line">        mutex_ptr = mutex-&gt;mutex;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">CudaKernelLock</span>(<span class="keyword">void</span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">__device__ <span class="keyword">void</span> <span class="title">lock</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">atomicCAS</span>(mutex_ptr, <span class="number">0</span>, <span class="number">1</span>) != <span class="number">0</span>);</span><br><span class="line">        __threadfence();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">__device__ <span class="keyword">void</span> <span class="title">unlock</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">        __threadfence();</span><br><span class="line">        <span class="built_in">atomicExch</span>(mutex_ptr, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><ol start="5"><li><strong>è§£å†³åŠæ³•3</strong>ï¼šå°†<code>cudaFree</code>å°è£…æˆlamdaå‡½æ•°ï¼Œshared_ptråˆ›å»ºæ—¶ä¼ å…¥é”€æ¯å‡½æ•°ï¼Œä¼˜ç‚¹æ˜¯ä¸ç”¨å•ç‹¬å°è£…<code>Mutex</code>ç±»ï¼Œç¼ºç‚¹è¿˜æ˜¯ç»•ä¸å¼€éœ€è¦ä¸€ä¸ªè£¸æŒ‡é’ˆ<code>mutex_ptr</code>å»ç»™__device__å‡½æ•°ä½¿ç”¨ã€‚</li></ol></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CudaKernelLock</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    std::shared_ptr&lt;<span class="keyword">int</span>&gt; mutex;</span><br><span class="line">    <span class="keyword">int</span>* mutex_ptr = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">CudaKernelLock</span>() &#123;</span><br><span class="line">        <span class="keyword">int</span> state = <span class="number">0</span>;</span><br><span class="line">        cudaError_t ret = <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span>**)&amp;mutex_ptr, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line">        ret = <span class="built_in">cudaMemcpy</span>(mutex_ptr, &amp;state, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line">        <span class="comment">// auto lamdaFree = [](int* p) &#123;</span></span><br><span class="line">        <span class="comment">//    cudaFree(p);</span></span><br><span class="line">        <span class="comment">// &#125;;</span></span><br><span class="line">        <span class="comment">// std::shared_ptr&lt;int&gt; tmp(mutex_ptr, lamdaFree);</span></span><br><span class="line">        <span class="function">std::shared_ptr&lt;<span class="keyword">int</span>&gt; <span class="title">tmp</span><span class="params">(mutex_ptr, [](<span class="keyword">int</span>* p) &#123;cudaFree(p);&#125;)</span></span>;</span><br><span class="line">        mutex = std::<span class="built_in">move</span>(tmp);<span class="comment">//std::make_shared&lt;int&gt;(dev_mutex, lamdaFree);</span></span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">CudaKernelLock</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">__device__ <span class="keyword">void</span> <span class="title">lock</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">atomicCAS</span>(mutex_ptr, <span class="number">0</span>, <span class="number">1</span>) != <span class="number">0</span>);</span><br><span class="line">        __threadfence();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">__device__ <span class="keyword">void</span> <span class="title">unlock</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">        __threadfence();</span><br><span class="line">        <span class="built_in">atomicExch</span>(mutex_ptr, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1>çœŸÂ·çº¿ç¨‹é”è®¾è®¡</h1><blockquote><p>å¥½çœ‹ä¸ä¸€å®šå¥½ç”¨</p></blockquote><p>ä¸Šè¿°çš„é€šç”¨äº’æ–¥é”ç±»çš„è®¾è®¡è™½ç„¶å°è£…çš„å¥½ï¼Œä½†è¿˜æ˜¯è§£å†³ä¸äº†blockå†…threadæ­»é”çš„é—®é¢˜ï¼Œå› æ­¤åªèƒ½<code>kernel&lt;&lt;&lt;n,1&gt;&gt;&gt;(...)</code>è¿™æ ·å»ä½¿ç”¨ï¼Œæµ‹è¯•ä¸‹æ¥ï¼Œè™½ç„¶æ¯”CPUä¸²è¡Œéå†è®¡ç®—è¦å¿«ï¼Œä½†è¿˜æ˜¯æ²¡æœ‰å®Œå…¨å‘æŒ¥CUDAå¹¶è¡Œè®¡ç®—çš„èƒ½åŠ›ï¼Œæ¯•ç«Ÿä¸€ä¸ªwarpæ‰§è¡Œå•å…ƒä¸­åªæœ‰ä¸€ä¸ªthreadã€‚å› æ­¤å®ç°äº†å¦‚ä¸‹ç›´æ¥åµŒåœ¨æ ¸å‡½æ•°é‡Œçš„ä¸‘é™‹ä½†å¥½ç”¨çš„<strong>çœŸÂ·çº¿ç¨‹äº’æ–¥é”</strong>ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">GtThrCntKernel</span><span class="params">(<span class="keyword">float</span>* src, <span class="keyword">int</span> len, <span class="keyword">float</span> thr, <span class="keyword">int</span>* cnt, <span class="keyword">int</span>* mutex)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> pos_start = blockDim.x * blockIdx.x + threadIdx.x;</span><br><span class="line"><span class="keyword">int</span> pos_step = blockDim.x * gridDim.x;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = pos_start;i &lt; len;i += pos_step) &#123;</span><br><span class="line">    <span class="keyword">if</span> (src[i] &lt;= thr) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> blocked = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">while</span>(blocked)&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">0</span> == <span class="built_in">atomicCAS</span>(mutex, <span class="number">0</span>, <span class="number">1</span>))&#123;</span><br><span class="line">            <span class="comment">// **** critical section ****//</span></span><br><span class="line">            <span class="built_in">atomicAdd</span>(cnt, <span class="number">1</span>);</span><br><span class="line">            __threadfence();</span><br><span class="line">            <span class="comment">// **** critical section ****//</span></span><br><span class="line">            <span class="built_in">atomicExch</span>(mutex, <span class="number">0</span>);</span><br><span class="line">            blocked = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">callKernel</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> mutex_state = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> *mutex_;</span><br><span class="line">CudaError_t ret = <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span> **)&amp;mutex_, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line">ret = <span class="built_in">cudaMemcpy</span>(mutex_, &amp;mutex_state, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line"><span class="comment">// prepare the data</span></span><br><span class="line">...</span><br><span class="line"><span class="comment">// launch kernel</span></span><br><span class="line">GtThrCntKernel &lt;&lt;&lt;<span class="number">4</span>, <span class="number">128</span>&gt;&gt;&gt; (dev_a, len, thr, dev_c, mutex_);</span><br><span class="line">ret = <span class="built_in">cudaGetLastError</span>();</span><br><span class="line"><span class="keyword">if</span> (ret != cudaSuccess) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(stderr, <span class="string">&quot;addKernel launch failed: %s\n&quot;</span>, <span class="built_in">cudaGetErrorString</span>(ret));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cudaFree</span>(mutex_);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¦‚ä¸Šæ‰€ç¤ºï¼Œæ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡åŠ /è§£é”çš„æ“ä½œæ²¡äº†å‡½æ•°çš„å°è£…ï¼Œç›´æ¥åµŒåœ¨æ ¸å‡½æ•°é‡Œï¼Œä¹Ÿå°±æ²¡æœ‰äº†warpå¿…é¡»åŒè¿›åŒå‡ºå‡½æ•°çš„é—®é¢˜ï¼Œä¿¡æ¯é‡<code>mutex</code>ä»ç„¶éœ€è¦é¢„å…ˆåœ¨å¤–éƒ¨åˆ†é…å¥½ï¼Œä½†æ˜¯æ²¡æœ‰äº†ç±»çš„å°è£…ï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šå­˜åœ¨æ„é€ /ææ„çš„é—®é¢˜ã€‚åŒæ ·ä¸´ç•ŒåŒºä¸­blockä¹‹é—´çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ä»éœ€è¦åŸå­æ“ä½œæˆ–__threadfence()å»è§£å†³ã€‚</li><li>å®æµ‹ä¸‹æ¥ï¼Œä¸å†ä¼šå‡ºç°æ­»é”é—®é¢˜ï¼Œä¸ä¼šæœ‰é‡å…¥é—®é¢˜ï¼Œä¸”é€Ÿåº¦ä¼šå¿«ä¸å°‘ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> CUDA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CUDA </tag>
            
            <tag> è®¡ç®—æœºä½“ç³»ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CUDAåŸºç¡€ [4]ï¼šå¤šæµæµ‹è¯•</title>
      <link href="/2021/11/28/CUDA-4-MultiStreamTest/"/>
      <url>/2021/11/28/CUDA-4-MultiStreamTest/</url>
      
        <content type="html"><![CDATA[<h1>BackGround</h1><p>æµ‹è¯•éªŒè¯cudaå¤šæµçš„å¹¶è¡Œè°ƒåº¦é€»è¾‘<br>æµ‹è¯•ç¯å¢ƒï¼šGTX1650+VS2019+Nsight</p><h1>å•æµå¾ªç¯</h1><p>æŒ‰åºæ‰§è¡Œ</p><p><img src="/2021/11/28/CUDA-4-MultiStreamTest/1.jpg" alt="1"></p><h1>åŒæµå¾ªç¯ï¼ˆæ–¹å¼1ï¼‰</h1><p>ç›®å‰æœ€ä¼˜çš„å¹¶è¡Œæ–¹å¼</p><p><img src="/2021/11/28/CUDA-4-MultiStreamTest/2.jpg" alt="2"></p><h1>åŒæµå¾ªç¯ï¼ˆæ–¹å¼2ï¼‰</h1><p>å¹¶è¡Œç¨‹åº¦ä¸å¦‚æ–¹å¼1</p><p><img src="/2021/11/28/CUDA-4-MultiStreamTest/3.jpg" alt="3"></p><h1>åŒæµå¾ªç¯ï¼ˆæ–¹å¼3ï¼‰</h1><p><img src="/2021/11/28/CUDA-4-MultiStreamTest/4.jpg" alt="4"></p><h1>åŒæµå¾ªç¯ï¼ˆæ–¹å¼4ï¼‰</h1><p><img src="/2021/11/28/CUDA-4-MultiStreamTest/5.jpg" alt="5"></p><h1>TX2 deviceQuery</h1><p><img src="/2021/11/28/CUDA-4-MultiStreamTest/6.jpg" alt="6"></p><h1>æ€»ç»“</h1><ul><li><ol><li>Nsightèƒ½å¯è§†åŒ–cudaçš„æ—¶é—´çº¿ï¼Œå¯ä»¥åœ¨è®¾è®¡åˆæœŸå¸®åŠ©è§„é¿ä¸€äº›ä¸åˆç†çš„è®¾è®¡é€»è¾‘ï¼Œä½†PCå’ŒTX2ä¸Šè®¾å¤‡æ”¯æŒæƒ…å†µä¸åŒï¼Œåœ¨PCä¸Šçš„è¡¨ç°ä¸å®Œå…¨ç­‰åŒäºTX2ä¸Šè¡¨ç°ï¼ŒTX2ä¸Šéœ€å¦åšæµ‹è¯•ï¼Œçœ‹æ˜¯å¦æ»¡è¶³é¢„æœŸï¼›</li></ol></li><li><ol start="2"><li>ä»ä¸Šè¿°å¯¹æ¯”ç»“æœçœ‹ï¼Œåœ¨ç¡®ä¿ä¸Šä¸‹æ–‡ä¾èµ–å…³ç³»æ­£ç¡®çš„æƒ…å†µä¸‹ï¼ŒåŒä¸€æµçš„æ“ä½œæ”¾åœ¨ä¸€èµ·è°ƒç”¨èƒ½è·å¾—æ›´å¥½çš„å¹¶è¡Œæ•ˆæœï¼›</li></ol></li><li><ol start="3"><li>TX2åªæœ‰ä¸€ä¸ªcopy engineï¼Œ æ‰€ä»¥æ‹·è´æ“ä½œé—´ä¸èƒ½å¹¶è¡Œã€‚</li></ol></li></ul>]]></content>
      
      
      <categories>
          
          <category> CUDA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CUDA </tag>
            
            <tag> è®¡ç®—æœºä½“ç³»ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CUDAåŸºç¡€ [3]ï¼šæµå’Œäº‹ä»¶</title>
      <link href="/2021/11/28/CUDA-3-StreamAndEvent/"/>
      <url>/2021/11/28/CUDA-3-StreamAndEvent/</url>
      
        <content type="html"><![CDATA[<h1>æµï¼ˆstreamï¼‰</h1><p>è®¾å¤‡æ“ä½œåŒ…æ‹¬ï¼šæ•°æ®ä¼ è¾“å’Œæ‰§è¡Œkernelå‡½æ•°ã€‚</p><p>åœ¨cudaä¸­ï¼Œæ‰€æœ‰çš„è®¾å¤‡æ“ä½œéƒ½åœ¨streamä¸­æ‰§è¡Œã€‚å½“æ²¡æœ‰æŒ‡å®šstreamæ—¶ï¼Œä½¿ç”¨é»˜è®¤çš„streamã€‚</p><h2 id="é»˜è®¤stream">é»˜è®¤stream</h2><p>é»˜è®¤streamæ˜¯ä¸€ä¸ªé’ˆå¯¹è®¾å¤‡æ“ä½œåŒæ­¥çš„streamï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰å½“æ‰€æœ‰ä¹‹å‰è®¾å¤‡ä¸Šä»»ä½•stream(åŒ…æ‹¬é»˜è®¤stream)é‡Œé¢çš„æ“ä½œå…¨éƒ¨å®Œæˆæ—¶ï¼Œæ‰å¼€å§‹é»˜è®¤streamé‡Œé¢æ“ä½œçš„æ‰§è¡Œï¼Œå¹¶ä¸”é»˜è®¤streamé‡Œé¢çš„ä¸€ä¸ªæ“ä½œå¿…é¡»å®Œæˆï¼Œå…¶ä»–ä»»ä½•streamï¼ˆåŒ…æ‹¬é»˜è®¤streamï¼‰é‡Œé¢çš„æ“ä½œæ‰èƒ½å¼€å§‹ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">cudaMemcpy(d_a, a, numBytes, cudaMemcpyHostToDevice); </span><br><span class="line">increment&lt;&lt;&lt;<span class="number">1</span>,N&gt;&gt;&gt;(d_a);</span><br><span class="line">cudaMemcpy(a, d_a, numBytes, cudaMemcpyDeviceToHost);</span><br></pre></td></tr></table></figure><ul><li><ol><li>ä»è®¾å¤‡ç«¯æ¥çœ‹ï¼Œè¿™ä¸‰ä¸ªæ“ä½œéƒ½åœ¨é»˜è®¤streamä¸­ï¼Œå¹¶ä¸”æŒ‰é¡ºåºæ‰§è¡Œï¼›</li></ol></li><li><ol start="2"><li>ä»ä¸»æœºç«¯æ¥çœ‹ï¼Œæ•°æ®ä¼ è¾“æ˜¯é˜»å¡çš„æˆ–è€…åŒæ­¥ä¼ è¾“ï¼Œè€Œkernelæ˜¯å¼‚æ­¥çš„ï¼›</li></ol><ul><li>ç¬¬ä¸€æ­¥ä¸»æœºåˆ°è®¾å¤‡çš„æ•°æ®ä¼ è¾“æ˜¯åŒæ­¥çš„ï¼ŒCPUçº¿ç¨‹ä¸èƒ½åˆ°è¾¾ç¬¬äºŒè¡Œç›´åˆ°ä¸»æœºåˆ°è®¾å¤‡çš„æ•°æ®ä¼ è¾“å®Œæˆã€‚</li><li>ä¸€æ—¦kernelè¢«launchï¼ŒCPUçº¿ç¨‹ç§»åˆ°ç¬¬ä¸‰è¡Œï¼Œä½†æ˜¯è¯¥è¡Œçš„ä¼ è¾“è¿˜ä¸èƒ½å¼€å§‹ï¼Œå› ä¸ºè®¾å¤‡ç«¯æ­£åœ¨æ‰§è¡Œç¬¬äºŒè¡Œçš„å†…å®¹ï¼ˆä½†å¦‚æœåœ¨2-3è¡Œä¹‹é—´æ’å…¥å…¶ä»–cpuæ“ä½œæ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼‰ã€‚</li></ul></li></ul><h2 id="éé»˜è®¤stream">éé»˜è®¤stream</h2><ul><li><ol><li>éé»˜è®¤streamä¸­çš„æ•°æ®ä¼ è¾“ä½¿ç”¨å‡½æ•°<code>cudaMemcpyAsync()</code>ï¼Œè¿™ä¸ªå‡½æ•°åœ¨ä¸»æœºç«¯æ˜¯éé˜»å¡çš„ï¼Œä¼ è¾“å¤„ç†åæ§åˆ¶æƒé©¬ä¸Šè¿”å›ç»™ä¸»æœºçº¿ç¨‹ï¼›</li></ol></li><li><ol start="2"><li>è‡ªå®šä¹‰ä¸€ä¸ªstreamå¯ä»¥ç”¨<code>cudaError_t cudaStreamCreate(cudaStream_t* pStream)</code>å‡½æ•°ï¼›</li></ol></li><li><ol start="3"><li>å½“æ‰§è¡Œä¸€æ¬¡å¼‚æ­¥æ•°æ®ä¼ è¾“æ—¶ï¼Œæˆ‘ä»¬<s>å¿…é¡»</s>(æ­¤å¤„å­˜ç–‘)ä½¿ç”¨<strong>é¡µé”å®šå†…å­˜<code>pinned memory</code>æˆ–<code>page-locked memory)</code></strong>ï¼š</li></ol><ul><li>å¯¹CUDAæ¶æ„è€Œè¨€ï¼Œä¸»æœºç«¯çš„å†…å­˜è¢«åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯<strong>å¯åˆ†é¡µå†…å­˜ï¼ˆ<code>pageable memroy</code>ï¼‰<strong>å’Œ</strong>é¡µé”å®šå†…å­˜ï¼ˆ<code>page-locked</code>æˆ–<code>pinned</code>ï¼‰</strong>ã€‚å¯åˆ†é¡µå†…å­˜æ˜¯ç”±æ“ä½œç³»ç»ŸAPIå‡½æ•°<code>malloc()</code>åœ¨ä¸»æœºå†…å­˜ä¸Šåˆ†é…çš„ï¼Œé¡µé”å®šå†…å­˜æ˜¯ç”±CUDAå‡½æ•°<code>cudaHostAlloc()</code>åœ¨ä¸»æœºå†…å­˜ä¸Šåˆ†é…çš„ã€‚é¡µé”å®šå†…å­˜çš„é‡è¦å±æ€§æ˜¯ä¸»æœºçš„æ“ä½œç³»ç»Ÿå°†ä¸ä¼šå¯¹è¿™å—å†…å­˜è¿›è¡Œ<em><strong>åˆ†é¡µ</strong></em>ï¼ˆ<a href="https://www.jianshu.com/p/f9e362e64ef9">åˆ†é¡µæœºåˆ¶</a>ï¼‰å’Œ<em><strong>äº¤æ¢</strong></em>æ“ä½œï¼Œç¡®ä¿è¯¥å†…å­˜å§‹ç»ˆé©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚</li><li>å¦‚æœåœ¨å¼‚æ­¥æ•°æ®ä¼ è¾“æœŸé—´ï¼Œhostç«¯çš„æŸäº›æ“ä½œå¯¼è‡´å†…å­˜æ¢é¡µï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¼ è¾“å¼‚å¸¸ï¼ˆå¦å¤–ä¸€ä¸ªè¯´æ³•ï¼šæ²¡æœ‰æ˜¾ç¤ºå®šä¹‰é¡µé”å®šå†…å­˜æ—¶ï¼Œå½“å°†<code>pageable host Memory</code>æ•°æ®é€åˆ°deviceæ—¶ï¼ŒCUDAé©±åŠ¨ä¼šåˆ†é…ä¸´æ—¶çš„é¡µé”å®šå†…å­˜ï¼Œå¹¶å°†hostæ•°æ®æ”¾åˆ°è¿™ä¸ªä¸´æ—¶ç©ºé—´é‡Œï¼Œç„¶åå†å‘deviceä¼ è¾“æ•°æ®ï¼‰ï¼›</li><li>GPUçŸ¥é“é¡µé”å®šå†…å­˜çš„ç‰©ç†åœ°å€ï¼Œå¯ä»¥é€šè¿‡<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Blue"><mtext>ç›´æ¥å†…å­˜è®¿é—®</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{Blue}ç›´æ¥å†…å­˜è®¿é—®</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback" style="color:Blue;">ç›´æ¥å†…å­˜è®¿é—®</span></span></span></span><code>Direct Memory Access, DMA</code>æŠ€æœ¯ç›´æ¥åœ¨ä¸»æœºå’ŒGPUä¹‹é—´å¤åˆ¶æ•°æ®ï¼Œé€Ÿç‡æ›´å¿«ã€‚ç”±äºæ¯ä¸ªé¡µé”å®šå†…å­˜éƒ½éœ€è¦åˆ†é…ç‰©ç†å†…å­˜ï¼Œå¹¶ä¸”è¿™äº›å†…å­˜ä¸èƒ½äº¤æ¢åˆ°ç£ç›˜ä¸Šï¼Œæ‰€ä»¥é¡µé”å®šå†…å­˜æ¯”ä½¿ç”¨æ ‡å‡†<code>malloc()</code>åˆ†é…çš„å¯åˆ†é¡µå†…å­˜æ›´æ¶ˆè€—å†…å­˜ç©ºé—´ã€‚</li><li>åˆ†é…é¡µé”å®šå†…å­˜å¯ä»¥ä½¿ç”¨<code>cudaHostAlloc()</code>å‡½æ•°æˆ–<code>cudaMallocHost()</code>å‡½æ•°ï¼ˆC APIï¼‰ï¼›</li><li>é‡Šæ”¾é¡µé”å®šå†…å­˜ä½¿ç”¨<code>cudaFreeHost()</code>ï¼›</li><li>å°†å¯åˆ†é¡µå†…å­˜æ³¨å†Œä¸ºé¡µé”å®šå†…å­˜<code>cudaHostRegister()</code>ï¼›</li></ul></li><li><ol start="4"><li>å…³äº<strong>å¤šæµ</strong>ï¼Œåç»­ä¼šåšç›¸å…³çš„<a href="https://no5-aaron-wu.github.io/2021/11/28/CUDA-4-MultiStreamTest/">æµ‹è¯•</a>ï¼Œå¦å¤–å¯ä»¥å‚è€ƒä»¥ä¸‹åšå®¢ï¼š</li></ol><ul><li><a href="https://zhuanlan.zhihu.com/p/78557104">https://zhuanlan.zhihu.com/p/78557104</a> ï¼ˆå…¶ä¸­å¤šä¸ªkernelå¯ä»¥å¹¶è¡Œçš„æè¿°å­˜ç–‘ï¼‰</li><li><a href="https://blog.csdn.net/u010335328/article/details/52453499">https://blog.csdn.net/u010335328/article/details/52453499</a></li></ul></li></ul><h1>åŒæ­¥</h1><ul><li><code>cudaDeviceSynchronize()</code>ï¼šè¯¥æ–¹æ³•å°†é˜»å¡CPUç«¯çº¿ç¨‹çš„æ‰§è¡Œï¼Œç›´åˆ°GPUç«¯å®Œæˆä¹‹å‰CUDAçš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬kernelå‡½æ•°ã€æ•°æ®æ‹·è´ç­‰ï¼›</li><li><code>cudaStreamSynchronize()</code>ï¼šè¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ªstream IDï¼Œå®ƒå°†é˜»å¡CPUæ‰§è¡Œç›´åˆ°GPUç«¯å®Œæˆç›¸åº”stream IDçš„æ‰€æœ‰CUDAä»»åŠ¡ï¼Œä½†å…¶å®ƒstreamä¸­çš„CUDAä»»åŠ¡å¯èƒ½æ‰§è¡Œå®Œä¹Ÿå¯èƒ½æ²¡æœ‰æ‰§è¡Œå®Œï¼›</li><li><code>cudaStreamQuery()</code>ï¼šæ£€æŸ¥streamä¸­çš„æ“ä½œæ˜¯å¦å…¨éƒ¨å®Œæˆå¹¶è¿”å›çŠ¶æ€ï¼Œå³ä½¿æœ‰æ“ä½œæ²¡å®Œæˆä¹Ÿä¸ä¼šé˜»å¡hostã€‚å¦‚æœæ‰€æœ‰æ“ä½œéƒ½å®Œæˆäº†ï¼Œåˆ™è¿”å›<code>cudaSuccess</code>ï¼Œå¦åˆ™è¿”å›<code>cudaErrorNotReady</code>ï¼›</li></ul><h1>äº‹ä»¶ï¼ˆEventï¼‰</h1><p>ç”¨æ¥æ ‡è®°streamæ‰§è¡Œè¿‡ç¨‹çš„æŸä¸ªç‰¹å®šçš„ç‚¹ï¼Œå…¶ä¸»è¦ç”¨é€”æ˜¯ï¼š1. åŒæ­¥streamæ‰§è¡Œï¼›2. æ“æ§deviceè¿è¡Œæ­¥è°ƒã€‚</p><ul><li><ol><li><code>__host____device__cudaError_t cudaEventRecord ( cudaEvent_t event, cudaStream_t stream = 0 )</code>ï¼šè®°å½•ä¸€ä¸ªäº‹ä»¶ã€‚å¦‚æœ<code>stream</code>æ˜¯éé›¶çš„ï¼Œå½“æµä¸­æ‰€æœ‰çš„æ“ä½œå®Œæ¯•ï¼Œäº‹ä»¶è¢«è®°å½•ï¼›å¦åˆ™ï¼Œå½“CUDA contextä¸­æ‰€æœ‰çš„æ“ä½œå®Œæ¯•ï¼Œäº‹ä»¶è¢«è®°å½•ã€‚ç”±äºè¿™ä¸ªæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œå¿…é¡»ä½¿ç”¨<code>cudaEventQuery</code>å’Œ/æˆ–<code>cudaEventSyncronize</code>å‡½æ•°æ¥å†³å®šä½•æ—¶äº‹ä»¶è¢«çœŸçš„è®°å½•äº†ã€‚å¦‚æœcudaEventRecord ä¹‹å‰è¢«è°ƒç”¨äº†ï¼Œå¹¶ä¸”äº‹ä»¶è¿˜æ²¡æœ‰è¢«è®°å½•ï¼Œå‡½æ•°è¿”å›<code>cudaErrorInvalidValue</code>ã€‚</li></ol></li><li><ol start="2"><li><code>cudaEventSyncronize()</code>ï¼šé˜»å¡hostç›´åˆ°äº‹ä»¶çœŸçš„è¢«è®°å½•ã€‚</li></ol></li><li><ol start="3"><li><code>cudaError_t cudaEventElapsedTime(float* ms, cudaEvent_t start, cudaEvent_t stop)</code>ï¼šè¿”å›startå’Œstopä¹‹é—´çš„æ—¶é—´é—´éš”ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚startå’Œstopä¸å¿…å…³è”åˆ°åŒä¸€ä¸ªstreamä¸Šï¼Œä½†æ˜¯è¦æ³¨æ„ï¼Œå¦‚æœäºŒè€…ä»»æ„ä¸€ä¸ªå…³è”åˆ°äº†éé»˜è®¤streamä¸Šï¼Œæ—¶é—´é—´éš”å¯èƒ½è¦æ¯”æœŸæœ›çš„å¤§ã€‚è¿™æ˜¯å› ä¸º<code>cudaEventRecord</code>æ˜¯å¼‚æ­¥å‘ç”Ÿçš„ï¼Œæˆ‘ä»¬æ²¡åŠæ³•ä¿è¯åº¦é‡å‡ºæ¥çš„æ—¶é—´æ°å¥½å°±æ˜¯ä¸¤ä¸ªeventä¹‹é—´ï¼Œæ‰€ä»¥åªæ˜¯æƒ³è¦gpuå·¥ä½œçš„æ—¶é—´é—´éš”ï¼Œåˆ™stopå’Œstratéƒ½å…³è”åˆ°é»˜è®¤streamå°±å¥½äº†ã€‚</li></ol></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// create two events</span></span><br><span class="line">cudaEvent_t start, stop;</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;start);</span><br><span class="line"><span class="built_in">cudaEventCreate</span>(&amp;stop);</span><br><span class="line"><span class="comment">// record start event on the default stream</span></span><br><span class="line"><span class="built_in">cudaEventRecord</span>(start);</span><br><span class="line"><span class="comment">// execute kernel</span></span><br><span class="line">kernel&lt;&lt;&lt;grid, block&gt;&gt;&gt;(arguments);</span><br><span class="line"><span class="comment">// record stop event on the default stream</span></span><br><span class="line"><span class="built_in">cudaEventRecord</span>(stop);</span><br><span class="line"><span class="comment">// wait until the stop event completes</span></span><br><span class="line"><span class="built_in">cudaEventSynchronize</span>(stop);</span><br><span class="line"><span class="comment">// calculate the elapsed time between two events</span></span><br><span class="line"><span class="keyword">float</span> time;</span><br><span class="line"><span class="built_in">cudaEventElapsedTime</span>(&amp;time, start, stop);</span><br><span class="line"><span class="comment">// clean up the two events</span></span><br><span class="line"><span class="built_in">cudaEventDestroy</span>(start);</span><br><span class="line"><span class="built_in">cudaEventDestroy</span>(stop);</span><br></pre></td></tr></table></figure><h1>å‚è€ƒ</h1><ul><li><a href="https://www.cnblogs.com/1024incn/p/5891051.html">https://www.cnblogs.com/1024incn/p/5891051.html</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> CUDA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CUDA </tag>
            
            <tag> è®¡ç®—æœºä½“ç³»ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CUDAåŸºç¡€ [2]ï¼šGet Started</title>
      <link href="/2021/11/27/CUDA-2-start/"/>
      <url>/2021/11/27/CUDA-2-start/</url>
      
        <content type="html"><![CDATA[<blockquote><p>CUDAï¼ˆCompute Unified Device Architectureï¼‰è®¡ç®—ç»Ÿä¸€è®¾å¤‡æ¡†æ¶</p></blockquote><h1>GPUæ¶æ„ç‰¹ç‚¹</h1><ul><li><p><strong>æ ¸çš„è§’åº¦</strong>ï¼šé¦–å…ˆCPUç”±ä¸“ä¸ºé¡ºåºä¸²è¡Œå¤„ç†è€Œä¼˜åŒ–çš„å‡ ä¸ªæ ¸å¿ƒç»„æˆã€‚è€ŒGPUåˆ™ç”±æ•°ä»¥åƒè®¡çš„æ›´å°ã€æ›´é«˜æ•ˆçš„æ ¸å¿ƒç»„æˆï¼Œè¿™äº›æ ¸å¿ƒä¸“é—¨ä¸ºåŒæ—¶å¤„ç†å¤šä»»åŠ¡è€Œè®¾è®¡ï¼Œå¯é«˜æ•ˆåœ°å¤„ç†å¹¶è¡Œä»»åŠ¡ã€‚ä¹Ÿå°±æ˜¯ï¼ŒCPUè™½ç„¶æ¯ä¸ªæ ¸å¿ƒè‡ªèº«èƒ½åŠ›æå¼ºï¼Œå¤„ç†ä»»åŠ¡ä¸Šéå¸¸å¼ºæ‚ï¼Œæ— å¥ˆä»–æ ¸å¿ƒå°‘ï¼Œåœ¨å¹¶è¡Œè®¡ç®—ä¸Šè¡¨ç°ä¸ä½³ï¼›åè§‚GPUï¼Œè™½ç„¶ä»–çš„æ¯ä¸ªæ ¸å¿ƒçš„è®¡ç®—èƒ½åŠ›ä¸ç®—å¼ºï¼Œä½†ä»–èƒœåœ¨æ ¸å¿ƒéå¸¸å¤šï¼Œå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè®¡ç®—ä»»åŠ¡ï¼Œåœ¨å¹¶è¡Œè®¡ç®—çš„æ”¯æŒä¸Šåšå¾—å¾ˆå¥½ã€‚GPUå’ŒCPUçš„ä¸åŒç¡¬ä»¶ç‰¹ç‚¹å†³å®šäº†ä»–ä»¬çš„åº”ç”¨åœºæ™¯ï¼ŒCPUæ˜¯è®¡ç®—æœºçš„è¿ç®—å’Œæ§åˆ¶çš„æ ¸å¿ƒï¼ŒGPUä¸»è¦ç”¨ä½œå›¾å½¢å›¾åƒå¤„ç†ã€‚å›¾åƒåœ¨è®¡ç®—æœºå‘ˆç°çš„å½¢å¼å°±æ˜¯çŸ©é˜µï¼Œæˆ‘ä»¬å¯¹å›¾åƒçš„å¤„ç†å…¶å®å°±æ˜¯æ“ä½œå„ç§çŸ©é˜µè¿›è¡Œè®¡ç®—ï¼Œè€Œå¾ˆå¤šçŸ©é˜µçš„è¿ç®—å…¶å®å¯ä»¥åšå¹¶è¡ŒåŒ–ï¼Œè¿™ä½¿å¾—å›¾åƒå¤„ç†å¯ä»¥åšå¾—å¾ˆå¿«ï¼Œå› æ­¤GPUåœ¨å›¾å½¢å›¾åƒé¢†åŸŸä¹Ÿæœ‰äº†å¤§å±•æ‹³è„šçš„æœºä¼šã€‚</p></li><li><p><strong>æ•°æ®å¤„ç†è§’åº¦</strong>ï¼šCPUéœ€è¦å¾ˆå¼ºçš„é€šç”¨æ€§æ¥å¤„ç†å„ç§ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚æ•´å‹ã€æµ®ç‚¹æ•°ç­‰ï¼ŒåŒæ—¶å®ƒåˆå¿…é¡»æ“…é•¿å¤„ç†é€»è¾‘åˆ¤æ–­æ‰€å¯¼è‡´çš„å¤§é‡åˆ†æ”¯è·³è½¬å’Œä¸­æ–­å¤„ç†ï¼Œæ‰€ä»¥CPUå…¶å®å°±æ˜¯ä¸€ä¸ªèƒ½åŠ›å¾ˆå¼ºçš„ä¼™è®¡ï¼Œä»–èƒ½æŠŠå¾ˆå¤šäº‹å¤„ç†å¾—å¦¥å¦¥å½“å½“ï¼Œå½“ç„¶å•¦æˆ‘ä»¬éœ€è¦ç»™ä»–å¾ˆå¤šèµ„æºä¾›ä»–ä½¿ç”¨ï¼ˆå„ç§ç¡¬ä»¶ï¼‰ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†CPUä¸å¯èƒ½æœ‰å¤ªå¤šæ ¸å¿ƒï¼ˆæ ¸å¿ƒæ€»æ•°ä¸è¶…è¿‡16ï¼‰ã€‚è€ŒGPUé¢å¯¹çš„åˆ™æ˜¯ç±»å‹é«˜åº¦ç»Ÿä¸€çš„ã€ç›¸äº’æ— ä¾èµ–çš„å¤§è§„æ¨¡æ•°æ®å’Œä¸éœ€è¦è¢«æ‰“æ–­çš„çº¯å‡€çš„è®¡ç®—ç¯å¢ƒï¼ŒGPUæœ‰éå¸¸å¤šæ ¸å¿ƒï¼ˆè´¹ç±³æ¶æ„å°±æœ‰512æ ¸ï¼‰ï¼Œè™½ç„¶å…¶æ ¸å¿ƒçš„èƒ½åŠ›è¿œæ²¡æœ‰CPUçš„æ ¸å¿ƒå¼ºï¼Œä½†æ˜¯èƒœåœ¨å¤šï¼Œåœ¨å¤„ç†ç®€å•è®¡ç®—ä»»åŠ¡æ—¶å‘ˆç°å‡ºâ€œäººå¤šåŠ›é‡å¤§â€çš„ä¼˜åŠ¿ï¼Œè¿™å°±æ˜¯å¹¶è¡Œè®¡ç®—çš„é­…åŠ›ã€‚</p></li></ul><p><strong>å¼‚æ„è®¡ç®—</strong>ï¼šä¸åŒä½“ç³»ç»“æ„çš„å¤„ç†å™¨ç›¸äº’åä½œå®Œæˆè®¡ç®—ä»»åŠ¡ï¼Œå¹¶è¡Œéƒ¨åˆ†åœ¨GPUä¸Šè¿è¡Œï¼Œä¸²è¡Œéƒ¨åˆ†åœ¨CPUè¿è¡Œã€‚CPUè´Ÿè´£æ€»ä½“çš„ç¨‹åºæµç¨‹ï¼Œè€ŒGPUè´Ÿè´£å…·ä½“çš„è®¡ç®—ä»»åŠ¡ï¼Œå½“GPUå„ä¸ªçº¿ç¨‹å®Œæˆè®¡ç®—ä»»åŠ¡åï¼Œæˆ‘ä»¬å°±å°†GPUé‚£è¾¹è®¡ç®—å¾—åˆ°çš„ç»“æœæ‹·è´åˆ°CPUç«¯ï¼Œå®Œæˆä¸€æ¬¡è®¡ç®—ä»»åŠ¡ã€‚</p><h1>CUDAçº¿ç¨‹æ¨¡å‹</h1><h2 id="çº¿ç¨‹æ¨¡å‹ï¼ˆè½¯ä»¶è§’åº¦ï¼‰">çº¿ç¨‹æ¨¡å‹ï¼ˆè½¯ä»¶è§’åº¦ï¼‰</h2><p>kernelåœ¨deviceä¸Šæ‰§è¡Œæ—¶å®é™…ä¸Šæ˜¯å¯åŠ¨å¾ˆå¤šçº¿ç¨‹ï¼Œä¸€ä¸ªkernelæ‰€å¯åŠ¨çš„æ‰€æœ‰çº¿ç¨‹ç§°ä¸ºä¸€ä¸ªç½‘æ ¼ï¼ˆ<code>grid</code>ï¼‰ï¼ŒåŒä¸€ä¸ªç½‘æ ¼ä¸Šçš„çº¿ç¨‹å…±äº«ç›¸åŒçš„å…¨å±€å†…å­˜ç©ºé—´ï¼Œ<strong><code>grid</code><strong>æ˜¯çº¿ç¨‹ç»“æ„çš„</strong>ç¬¬ä¸€å±‚æ¬¡</strong>ï¼Œè€Œgridåˆå¯ä»¥åˆ†ä¸ºå¾ˆå¤šçº¿ç¨‹å—ï¼ˆ<code>block</code>ï¼‰ï¼Œä¸€ä¸ªçº¿ç¨‹å—é‡Œé¢åŒ…å«å¾ˆå¤šçº¿ç¨‹ï¼Œè¿™æ˜¯<strong>ç¬¬äºŒå±‚æ¬¡</strong>ã€‚</p><p><img src="/2021/11/27/CUDA-2-start/1.png" alt="1"></p><ul><li><ol><li><strong><code>Thread</code></strong>ï¼šçº¿ç¨‹ï¼Œå¹¶è¡Œçš„åŸºæœ¬å•ä½ï¼›</li></ol></li><li><ol start="2"><li><strong><code>Thread Block</code></strong>ï¼šçº¿ç¨‹å—ï¼Œäº’ç›¸åˆä½œçš„çº¿ç¨‹ç»„ï¼Œçº¿ç¨‹å—æœ‰å¦‚ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š<ol><li>å…è®¸å½¼æ­¤åŒæ­¥ï¼›</li><li>å¯ä»¥é€šè¿‡å…±äº«å†…å­˜å¿«é€Ÿäº¤æ¢æ•°æ®ï¼›</li><li>å¯ä»¥ä»¥1ç»´ã€2ç»´æˆ–3ç»´ç»„ç»‡ï¼ˆä¸€èˆ¬ä¸º3ç»´ï¼‰ï¼›</li><li>æ¯ä¸€ä¸ª<code>block</code>å’Œæ¯ä¸ª<code>thread</code>éƒ½æœ‰è‡ªå·±çš„IDï¼ˆ<code>blockIdx</code>å’Œ<code>threadIdx</code>ï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡ç›¸åº”çš„ç´¢å¼•æ‰¾åˆ°ç›¸åº”çš„çº¿ç¨‹å—å’Œçº¿ç¨‹ã€‚</li></ol></li></ol></li><li><ol start="3"><li><strong><code>Grid</code></strong>ï¼šä¸€ç»„çº¿ç¨‹å—<ol><li>å¯ä»¥ä»¥1ç»´ã€2ç»´æˆ–3ç»´ç»„ç»‡ï¼ˆä¸€èˆ¬ä¸º2ç»´ï¼‰ï¼›</li><li>å…±äº«å…¨å±€å†…å­˜ï¼›</li><li><code>grid</code>å’Œ<code>block</code>éƒ½æ˜¯å®šä¹‰ä¸º<code>dim3</code>ç±»å‹çš„å˜é‡ï¼Œ<code>dim3</code>å¯ä»¥çœ‹æˆæ˜¯åŒ…å«ä¸‰ä¸ªæ— ç¬¦å·æ•´æ•°<code>(x, y, z)</code>æˆå‘˜çš„ç»“æ„ä½“å˜é‡ï¼Œåœ¨å®šä¹‰æ—¶ï¼Œç¼ºçœå€¼åˆå§‹åŒ–ä¸º1ï¼›</li><li><code>dim3</code>ä»…ä¸ºhostç«¯å¯è§ï¼Œå…¶å¯¹åº”çš„deviceç«¯ç±»å‹ä¸º<code>uint3</code>ã€‚</li></ol></li></ol></li><li><ol start="4"><li><strong><code>Warp</code></strong>ï¼šGPUæ‰§è¡Œç¨‹åºæ—¶è°ƒåº¦å’Œè¿è¡Œçš„å•ä½ï¼ˆæ˜¯<code>SM</code>çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼‰ï¼Œç›®å‰cudaçš„warpçš„å¤§å°ä¸º32ï¼›åŒåœ¨ä¸€ä¸ªwarpçš„çº¿ç¨‹ï¼Œä»¥ä¸åŒæ•°æ®èµ„æºæ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ï¼Œè¿™å°±æ˜¯æ‰€è°“ <code>SIMT</code>ï¼ˆ<code>Single Instruction Multiple Threads</code>ï¼Œå•æŒ‡ä»¤å¤šçº¿ç¨‹ï¼‰ã€‚</li></ol></li><li><ol start="5"><li><strong><code>Kernel</code></strong>ï¼šåœ¨GPUä¸Šæ‰§è¡Œçš„æ ¸å¿ƒç¨‹åºï¼Œè¿™ä¸ªkernelå‡½æ•°æ˜¯è¿è¡Œåœ¨æŸä¸ªGridä¸Šçš„ã€‚<ol><li><code>One kernel &lt;==&gt; One Grid</code></li></ol></li></ol></li></ul><h2 id="æµå¤„ç†å™¨ï¼ˆç¡¬ä»¶è§’åº¦ï¼‰">æµå¤„ç†å™¨ï¼ˆç¡¬ä»¶è§’åº¦ï¼‰</h2><ul><li><ol><li><code>SPï¼ˆstreaming processorï¼‰</code>ï¼šä¹Ÿç§°<code>CUDA core</code>ã€‚æœ€åŸºæœ¬çš„å¤„ç†å•å…ƒï¼Œå…·ä½“çš„æŒ‡ä»¤å’Œä»»åŠ¡éƒ½æ˜¯åœ¨SPä¸Šå¤„ç†çš„ã€‚ä¸€ä¸ªSPå¯ä»¥æ‰§è¡Œä¸€ä¸ªthreadï¼›</li></ol></li><li><ol start="2"><li><code>SMï¼ˆstreaming multiprocessorï¼‰</code>ï¼šä¹Ÿå«GPUå¤§æ ¸ï¼Œç”±å¤šä¸ªSPåŠ ä¸Šå…¶ä»–èµ„æºï¼ˆå¦‚ï¼š<code>warp scheduler</code>ï¼Œ<code>register</code>ï¼Œ<code>shared memory</code>ç­‰ï¼‰ç»„æˆã€‚blockåœ¨SMä¸Šæ‰§è¡Œã€‚<ol><li>SMå¯ä»¥çœ‹åšGPUçš„å¿ƒè„ï¼ˆå¯¹æ¯”CPUæ ¸å¿ƒï¼‰ï¼Œ<code>register</code>å’Œ<code>shared memory</code>æ˜¯SMçš„ç¨€ç¼ºèµ„æºã€‚CUDAå°†è¿™äº›èµ„æºåˆ†é…ç»™æ‰€æœ‰é©»ç•™åœ¨SMä¸­çš„threadsã€‚å› æ­¤ï¼Œè¿™äº›æœ‰é™çš„èµ„æºå°±ä½¿æ¯ä¸ªSMä¸­<code>active warps</code>æœ‰éå¸¸ä¸¥æ ¼çš„é™åˆ¶ï¼Œä¹Ÿå°±é™åˆ¶äº†å¹¶è¡Œèƒ½åŠ›ï¼›</li><li>æ¯ä¸ªSMåŒ…å«çš„SPæ•°é‡ä¾æ®GPUæ¶æ„è€Œä¸åŒï¼ŒFermiæ¶æ„GF100æ˜¯32ä¸ªï¼ŒGF10Xæ˜¯48ä¸ªï¼ŒKepleræ¶æ„éƒ½æ˜¯192ä¸ªï¼ŒMaxwellæ¶æ„éƒ½æ˜¯128ä¸ªï¼›</li><li>SMä¸Šå¹¶ä¸æ˜¯æ‰€æœ‰çš„threadèƒ½å¤Ÿåœ¨åŒä¸€æ—¶åˆ»æ‰§è¡Œã€‚NvidiaæŠŠ32ä¸ªthreadsç»„æˆä¸€ä¸ªwarpï¼Œwarpæ˜¯è°ƒåº¦å’Œè¿è¡Œçš„åŸºæœ¬å•å…ƒã€‚warpä¸­æ‰€æœ‰threadså¹¶è¡Œçš„æ‰§è¡Œç›¸åŒçš„æŒ‡ä»¤ã€‚ä¸€ä¸ªwarpéœ€è¦å ç”¨ä¸€ä¸ªSMè¿è¡Œï¼Œå¤šä¸ªwarpséœ€è¦è½®æµè¿›å…¥SMã€‚ç”±SMçš„ç¡¬ä»¶warp schedulerè´Ÿè´£è°ƒåº¦ã€‚ç›®å‰æ¯ä¸ªwarpåŒ…å«32ä¸ªthreadsï¼ˆNvidiaä¿ç•™ä¿®æ”¹æ•°é‡çš„æƒåˆ©ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸€ä¸ªGPUä¸Šresident threadæœ€å¤šåªæœ‰ <code>SM * warp</code>ä¸ªã€‚</li><li>blockä¸€æ—¦è¢«åˆ†é…å¥½SMï¼Œè¯¥blockå°±ä¼šä¸€ç›´é©»ç•™åœ¨è¯¥SMä¸­ï¼Œç›´åˆ°æ‰§è¡Œç»“æŸã€‚ä¸€ä¸ªSMå¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªblocksï¼Œä½†éœ€è¦åºåˆ—æ‰§è¡Œã€‚</li></ol></li></ol></li></ul><h2 id="å¯¹åº”å…³ç³»-ç¡¬ä»¶ç»“æ„">å¯¹åº”å…³ç³»&amp;ç¡¬ä»¶ç»“æ„</h2><p><img src="/2021/11/27/CUDA-2-start/2.png" alt="2"></p><p><img src="/2021/11/27/CUDA-2-start/3.png" alt="3"></p><h2 id="å†…å­˜æ¨¡å‹">å†…å­˜æ¨¡å‹</h2><p>CUDAä¸­çš„å†…å­˜æ¨¡å‹åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªå±‚æ¬¡ï¼š</p><ul><li><ol><li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„registersï¼ˆå¯„å­˜å™¨ï¼‰ï¼›</li></ol></li><li><ol start="2"><li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„local memoryï¼ˆå±€éƒ¨å†…å­˜ï¼‰ï¼›</li></ol></li><li><ol start="3"><li>æ¯ä¸ªçº¿ç¨‹å—å†…éƒ½æœ‰è‡ªå·±çš„shared memoryï¼ˆå…±äº«å†…å­˜ï¼‰ï¼Œçº¿ç¨‹å—å†…çš„æ‰€æœ‰çº¿ç¨‹å…±äº«è¿™æ®µå†…å­˜èµ„æº</li></ol></li><li><ol start="4"><li>æ¯ä¸ªgridéƒ½æœ‰è‡ªå·±çš„global memoryï¼ˆå…¨å±€å†…å­˜ï¼‰ï¼Œä¸åŒçº¿ç¨‹å—çš„çº¿ç¨‹éƒ½å¯ä½¿ç”¨</li></ol></li><li><ol start="5"><li>æ¯ä¸ªgridéƒ½æœ‰è‡ªå·±çš„constant memoryï¼ˆå¸¸é‡å†…å­˜ï¼‰å’Œtexture memoryï¼ˆçº¹ç†å†…å­˜ï¼‰ï¼Œä¸åŒçº¿ç¨‹å—çš„çº¿ç¨‹éƒ½å¯ä½¿ç”¨ã€‚</li></ol></li></ul><blockquote><p>çº¿ç¨‹è®¿é—®è¿™å‡ ç±»å­˜å‚¨å™¨çš„é€Ÿåº¦æ˜¯register &gt; local memory &gt;shared memory &gt; global memory</p></blockquote><p><img src="/2021/11/27/CUDA-2-start/4.png" alt="4"></p><h2 id="ç¼–ç¨‹æ¨¡å‹">ç¼–ç¨‹æ¨¡å‹</h2><h3 id="æˆ‘ä»¬æ€ä¹ˆå†™ä¸€ä¸ªèƒ½åœ¨GPUè·‘çš„ç¨‹åºæˆ–å‡½æ•°å‘¢ï¼Ÿ">æˆ‘ä»¬æ€ä¹ˆå†™ä¸€ä¸ªèƒ½åœ¨GPUè·‘çš„ç¨‹åºæˆ–å‡½æ•°å‘¢ï¼Ÿ</h3><table><thead><tr><th></th><th>Executed on the:</th><th>Only callable from the:</th></tr></thead><tbody><tr><td><code>__device__ float DeviceFunc()</code></td><td>device</td><td>device</td></tr><tr><td><code>__global__ void KernelFunc()</code></td><td>device</td><td>host</td></tr><tr><td><code>__host__ float HostFunc()</code></td><td>host</td><td>host</td></tr></tbody></table><p>å¦‚ä¸Šè¡¨æ‰€ç¤ºï¼Œæˆ‘ä»¬ç”¨<code>__global__</code>å®šä¹‰ä¸€ä¸ªkernelå‡½æ•°ï¼Œå°±æ˜¯CPUä¸Šè°ƒç”¨ï¼ŒGPUä¸Šæ‰§è¡Œï¼Œæ³¨æ„<code>__global__</code>å‡½æ•°çš„è¿”å›å€¼å¿…é¡»è®¾ç½®ä¸º<code>void</code>ã€‚</p><h3 id="CPUå’ŒGPUé—´çš„æ•°æ®ä¼ è¾“æ€ä¹ˆå†™ï¼Ÿ">CPUå’ŒGPUé—´çš„æ•°æ®ä¼ è¾“æ€ä¹ˆå†™ï¼Ÿ</h3><ul><li><ol><li><code>cudaMalloc()</code>ï¼šåœ¨è®¾å¤‡ç«¯åˆ†é…global memory</li></ol></li><li><ol start="2"><li><code>cudaFree()</code>ï¼šé‡Šæ”¾å­˜å‚¨ç©ºé—´</li></ol></li><li><ol start="3"><li><p><code>cudaMemcpy(void *dst, void *src, size_t nbytes,enum cudaMemcpyKind direction)</code>ï¼šæ•°æ®ä¼ è¾“</p><p>enum cudaMemcpyKind:ä¼ è¾“æ–¹å‘</p><ol><li>cudaMemcpyHostToDeviceï¼ˆCPUåˆ°GPUï¼‰</li><li>cudaMemcpyDeviceToHostï¼ˆGPUåˆ°CPUï¼‰</li><li>cudaMemcpyDeviceToDeviceï¼ˆGPUåˆ°GPUï¼‰</li></ol></li></ol></li></ul><h3 id="æ€ä¹ˆç”¨ä»£ç è¡¨ç¤ºçº¿ç¨‹ç»„ç»‡æ¨¡å‹ï¼Ÿ">æ€ä¹ˆç”¨ä»£ç è¡¨ç¤ºçº¿ç¨‹ç»„ç»‡æ¨¡å‹ï¼Ÿ</h3><p>ç”¨<code>dim3</code>ç±»æ¥è¡¨ç¤ºç½‘æ ¼å’Œçº¿ç¨‹å—çš„ç»„ç»‡æ–¹å¼ï¼Œç½‘æ ¼gridå¯ä»¥è¡¨ç¤ºä¸ºä¸€ç»´å’ŒäºŒç»´æ ¼å¼ï¼Œçº¿ç¨‹å—blockå¯ä»¥è¡¨ç¤ºä¸ºä¸€ç»´ã€äºŒç»´å’Œä¸‰ç»´çš„æ•°æ®æ ¼å¼ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">dim3 <span class="title">DimGrid</span><span class="params">(<span class="number">100</span>, <span class="number">50</span>)</span></span>; <span class="comment">//5000ä¸ªçº¿ç¨‹å—ï¼Œç»´åº¦æ˜¯100*50 </span></span><br><span class="line"><span class="function">dim3 <span class="title">DimBlock</span><span class="params">(<span class="number">4</span>, <span class="number">8</span>, <span class="number">8</span>)</span></span>; <span class="comment">//æ¯ä¸ªçº¿å±‚å—å†…åŒ…å«256ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹å—å†…çš„ç»´åº¦æ˜¯4*8*8</span></span><br></pre></td></tr></table></figure><h3 id="çº¿ç¨‹ç´¢å¼•æ–¹å¼é€ŸæŸ¥">çº¿ç¨‹ç´¢å¼•æ–¹å¼é€ŸæŸ¥</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;cuda_runtime.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;device_launch_parameters.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//thread 1D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testThread1</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = threadIdx.x;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//thread 2D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testThread2</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = threadIdx.x + threadIdx.y*blockDim.x;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//thread 3D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testThread3</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = threadIdx.x + threadIdx.y*blockDim.x + threadIdx.z*blockDim.x*blockDim.y;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block 1D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlock1</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = blockIdx.x;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block 2D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlock2</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = blockIdx.x + blockIdx.y*gridDim.x;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block 3D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlock3</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = blockIdx.x + blockIdx.y*gridDim.x + blockIdx.z*gridDim.x*gridDim.y;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 1D-1D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread1</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = threadIdx.x + blockDim.x*blockIdx.x;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 1D-2D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread2</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> threadId_2D = threadIdx.x + threadIdx.y*blockDim.x;</span><br><span class="line">    <span class="keyword">int</span> i = threadId_2D+ (blockDim.x*blockDim.y)*blockIdx.x;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 1D-3D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread3</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> threadId_3D = threadIdx.x + threadIdx.y*blockDim.x + threadIdx.z*blockDim.x*blockDim.y;</span><br><span class="line">    <span class="keyword">int</span> i = threadId_3D + (blockDim.x*blockDim.y*blockDim.z)*blockIdx.x;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 2D-1D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread4</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> blockId_2D = blockIdx.x + blockIdx.y*gridDim.x;</span><br><span class="line">    <span class="keyword">int</span> i = threadIdx.x + blockDim.x*blockId_2D;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 3D-1D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread5</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> blockId_3D = blockIdx.x + blockIdx.y*gridDim.x + blockIdx.z*gridDim.x*gridDim.y;</span><br><span class="line">    <span class="keyword">int</span> i = threadIdx.x + blockDim.x*blockId_3D;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 2D-2D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread6</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> threadId_2D = threadIdx.x + threadIdx.y*blockDim.x;</span><br><span class="line">    <span class="keyword">int</span> blockId_2D = blockIdx.x + blockIdx.y*gridDim.x;</span><br><span class="line">    <span class="keyword">int</span> i = threadId_2D + (blockDim.x*blockDim.y)*blockId_2D;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 2D-3D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread7</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> threadId_3D = threadIdx.x + threadIdx.y*blockDim.x + threadIdx.z*blockDim.x*blockDim.y;</span><br><span class="line">    <span class="keyword">int</span> blockId_2D = blockIdx.x + blockIdx.y*gridDim.x;</span><br><span class="line">    <span class="keyword">int</span> i = threadId_3D + (blockDim.x*blockDim.y*blockDim.z)*blockId_2D;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 3D-2D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread8</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> threadId_2D = threadIdx.x + threadIdx.y*blockDim.x;</span><br><span class="line">    <span class="keyword">int</span> blockId_3D = blockIdx.x + blockIdx.y*gridDim.x + blockIdx.z*gridDim.x*gridDim.y;</span><br><span class="line">    <span class="keyword">int</span> i = threadId_2D + (blockDim.x*blockDim.y)*blockId_3D;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//block-thread 3D-3D</span></span><br><span class="line"><span class="function">__global__ <span class="keyword">void</span> <span class="title">testBlockThread9</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> threadId_3D = threadIdx.x + threadIdx.y*blockDim.x + threadIdx.z*blockDim.x*blockDim.y;</span><br><span class="line">    <span class="keyword">int</span> blockId_3D = blockIdx.x + blockIdx.y*gridDim.x + blockIdx.z*gridDim.x*gridDim.y;</span><br><span class="line">    <span class="keyword">int</span> i = threadId_3D + (blockDim.x*blockDim.y*blockDim.z)*blockId_3D;</span><br><span class="line">    c[i] = b[i] - a[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addWithCuda</span><span class="params">(<span class="keyword">int</span> *c, <span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> *b, <span class="keyword">unsigned</span> <span class="keyword">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *dev_a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> *dev_b = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> *dev_c = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaSetDevice</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span>**)&amp;dev_c, size * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span>**)&amp;dev_a, size * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line">    <span class="built_in">cudaMalloc</span>((<span class="keyword">void</span>**)&amp;dev_b, size * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(dev_a, a, size * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(dev_b, b, size * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), cudaMemcpyHostToDevice);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//testThread1&lt;&lt;&lt;1, size&gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s;s.x = size/5;s.y = 5;s.z = 1;</span></span><br><span class="line">    <span class="comment">//testThread2 &lt;&lt;&lt;1,s&gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s; s.x = size / 10; s.y = 5; s.z = 2;</span></span><br><span class="line">    <span class="comment">//testThread3&lt;&lt;&lt;1, s &gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//testBlock1&lt;&lt;&lt;size,1 &gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s; s.x = size / 5; s.y = 5; s.z = 1;</span></span><br><span class="line">    <span class="comment">//testBlock2&lt;&lt;&lt;s, 1 &gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s; s.x = size / 10; s.y = 5; s.z = 2;</span></span><br><span class="line">    <span class="comment">//testBlock3&lt;&lt;&lt;s, 1 &gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//testBlockThread1&lt;&lt;&lt;size/10, 10&gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s1; s1.x = size / 100; s1.y = 1; s1.z = 1;</span></span><br><span class="line">    <span class="comment">//uint3 s2; s2.x = 10; s2.y = 10; s2.z = 1;</span></span><br><span class="line">    <span class="comment">//testBlockThread2 &lt;&lt; &lt;s1, s2 &gt;&gt; &gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s1; s1.x = size / 100; s1.y = 1; s1.z = 1;</span></span><br><span class="line">    <span class="comment">//uint3 s2; s2.x = 10; s2.y = 5; s2.z = 2;</span></span><br><span class="line">    <span class="comment">//testBlockThread3 &lt;&lt; &lt;s1, s2 &gt;&gt; &gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s1; s1.x = 10; s1.y = 10; s1.z = 1;</span></span><br><span class="line">    <span class="comment">//uint3 s2; s2.x = size / 100; s2.y = 1; s2.z = 1;</span></span><br><span class="line">    <span class="comment">//testBlockThread4 &lt;&lt; &lt;s1, s2 &gt;&gt; &gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s1; s1.x = 10; s1.y = 5; s1.z = 2;</span></span><br><span class="line">    <span class="comment">//uint3 s2; s2.x = size / 100; s2.y = 1; s2.z = 1;</span></span><br><span class="line">    <span class="comment">//testBlockThread5 &lt;&lt; &lt;s1, s2 &gt;&gt; &gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s1; s1.x = size / 100; s1.y = 10; s1.z = 1;</span></span><br><span class="line">    <span class="comment">//uint3 s2; s2.x = 5; s2.y = 2; s2.z = 1;</span></span><br><span class="line">    <span class="comment">//testBlockThread6 &lt;&lt; &lt;s1, s2 &gt;&gt; &gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s1; s1.x = size / 100; s1.y = 5; s1.z = 1;</span></span><br><span class="line">    <span class="comment">//uint3 s2; s2.x = 5; s2.y = 2; s2.z = 2;</span></span><br><span class="line">    <span class="comment">//testBlockThread7 &lt;&lt; &lt;s1, s2 &gt;&gt; &gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//uint3 s1; s1.x = 5; s1.y = 2; s1.z = 2;</span></span><br><span class="line">    <span class="comment">//uint3 s2; s2.x = size / 100; s2.y = 5; s2.z = 1;</span></span><br><span class="line">    <span class="comment">//testBlockThread8 &lt;&lt;&lt;s1, s2 &gt;&gt;&gt;(dev_c, dev_a, dev_b);</span></span><br><span class="line"></span><br><span class="line">    uint3 s1; s1.x = <span class="number">5</span>; s1.y = <span class="number">2</span>; s1.z = <span class="number">2</span>;</span><br><span class="line">    uint3 s2; s2.x = size / <span class="number">200</span>; s2.y = <span class="number">5</span>; s2.z = <span class="number">2</span>;</span><br><span class="line">    testBlockThread9&lt;&lt;&lt;s1, s2 &gt;&gt;&gt;(dev_c, dev_a, dev_b);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaMemcpy</span>(c, dev_c, size*<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>), cudaMemcpyDeviceToHost);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaFree</span>(dev_a);</span><br><span class="line">    <span class="built_in">cudaFree</span>(dev_b);</span><br><span class="line">    <span class="built_in">cudaFree</span>(dev_c);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaGetLastError</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> n = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> *a = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">    <span class="keyword">int</span> *b = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">    <span class="keyword">int</span> *c = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">    <span class="keyword">int</span> *cc = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i] = <span class="built_in">rand</span>() % <span class="number">100</span>;</span><br><span class="line">        b[i] = <span class="built_in">rand</span>() % <span class="number">100</span>;</span><br><span class="line">        c[i] = b[i] - a[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">addWithCuda</span>(cc, a, b, n);</span><br><span class="line"></span><br><span class="line">    FILE *fp = <span class="built_in">fopen</span>(<span class="string">&quot;out.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">fprintf</span>(fp, <span class="string">&quot;%d %d\n&quot;</span>, c[i], cc[i]);</span><br><span class="line">    <span class="built_in">fclose</span>(fp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c[i] != cc[i])</span><br><span class="line">        &#123;</span><br><span class="line">            flag = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="literal">false</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;no pass&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cudaDeviceReset</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span>[] a;</span><br><span class="line">    <span class="keyword">delete</span>[] b;</span><br><span class="line">    <span class="keyword">delete</span>[] c;</span><br><span class="line">    <span class="keyword">delete</span>[] cc;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>å‚è€ƒ</h1><ul><li><p><a href="https://www.cnblogs.com/skyfsm/p/9673960.html">https://www.cnblogs.com/skyfsm/p/9673960.html</a></p></li><li><p><a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html">https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/53773183?from_voters_page=true">https://zhuanlan.zhihu.com/p/53773183?from_voters_page=true</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> CUDA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CUDA </tag>
            
            <tag> è®¡ç®—æœºä½“ç³»ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CUDAåŸºç¡€ [1]ï¼šCPU GPU TPU NPU</title>
      <link href="/2021/11/27/CUDA-1-xPU/"/>
      <url>/2021/11/27/CUDA-1-xPU/</url>
      
        <content type="html"><![CDATA[<h1>CPUï¼ˆCentral Processing Unitï¼‰ä¸­å¤®å¤„ç†å™¨</h1><p>CPUçš„ç»“æ„ä¸»è¦åŒ…æ‹¬<strong>è¿ç®—å™¨</strong>ï¼ˆ<code>ALU, Arithmetic and Logic Unit</code>ï¼‰ã€<strong>æ§åˆ¶å•å…ƒ</strong>ï¼ˆ<code>CU, Control Unit</code>ï¼‰ã€<strong>å¯„å­˜å™¨</strong>ï¼ˆ<code>Register</code>ï¼‰ã€<strong>é«˜é€Ÿç¼“å­˜å™¨</strong>ï¼ˆ<code>Cache</code>ï¼‰å’Œå®ƒä»¬ä¹‹é—´é€šè®¯çš„æ•°æ®ã€æ§åˆ¶åŠçŠ¶æ€çš„<strong>æ€»çº¿</strong>ã€‚</p><p><img src="/2021/11/27/CUDA-1-xPU/1.png" alt="1"></p><h1>GPUï¼ˆGraphics Processing Unitï¼‰å›¾å½¢å¤„ç†å™¨</h1><p>ä¹Ÿæ˜¯ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šè®¡ç®—å•å…ƒã€æ§åˆ¶å•å…ƒå’Œå­˜å‚¨å•å…ƒã€‚</p><p><img src="/2021/11/27/CUDA-1-xPU/2.png" alt="2"></p><p>CPUç²¾äºæ§åˆ¶å’Œå¤æ‚è¿ç®—ï¼Œè€ŒGPUç²¾äºç®€å•ä¸”é‡å¤çš„è¿ç®—ï¼šæ¯”å¦‚çŸ©é˜µè¿ç®—ã€‚</p><ul><li>CPUï¼šæ“…é•¿æµç¨‹æ§åˆ¶å’Œé€»è¾‘å¤„ç†ï¼Œä¸è§„åˆ™æ•°æ®ç»“æ„ï¼Œä¸å¯é¢„æµ‹å­˜å‚¨ç»“æ„ï¼Œå•çº¿ç¨‹ç¨‹åºï¼Œåˆ†æ”¯å¯†é›†å‹ç®—æ³•</li><li>GPUï¼šæ“…é•¿æ•°æ®å¹¶è¡Œè®¡ç®—ï¼Œè§„åˆ™æ•°æ®ç»“æ„ï¼Œå¯é¢„æµ‹å­˜å‚¨æ¨¡å¼</li></ul><p>CPUæ˜¯é¡ºåºæ‰§è¡Œè¿ç®—ï¼Œè€ŒGPUæ˜¯å¯ä»¥å¤§é‡å¹¶å‘çš„æ‰§è¡Œè¿ç®—ã€‚</p><p>è™½ç„¶GPUæ˜¯ä¸ºäº†å›¾åƒå¤„ç†è€Œç”Ÿçš„ï¼Œä½†åœ¨ç»“æ„ä¸Šå¹¶æ²¡æœ‰ä¸“é—¨ä¸ºå›¾åƒæœåŠ¡çš„éƒ¨ä»¶ï¼Œåªæ˜¯å¯¹CPUçš„ç»“æ„è¿›è¡Œäº†ä¼˜åŒ–ä¸è°ƒæ•´ï¼Œæ‰€ä»¥GPUä¸ä»…å¯ä»¥ç”¨åœ¨å›¾åƒé¢†åŸŸï¼Œå®ƒè¿˜è¢«ç”¨æ¥ç§‘å­¦è®¡ç®—ã€å¯†ç ç ´è§£ã€æ•°å€¼åˆ†æï¼Œæµ·é‡æ•°æ®å¤„ç†ï¼ˆæ’åºï¼ŒMap-Reduceç­‰ï¼‰ï¼Œé‡‘èåˆ†æç­‰éœ€è¦å¤§è§„æ¨¡å¹¶è¡Œè®¡ç®—çš„é¢†åŸŸã€‚</p><p>ä½†GPUæ— æ³•å•ç‹¬å·¥ä½œï¼Œå¿…é¡»ç”±CPUè¿›è¡Œæ§åˆ¶è°ƒç”¨æ‰èƒ½å·¥ä½œã€‚CPUå¯å•ç‹¬ä½œç”¨ï¼Œå¤„ç†å¤æ‚çš„é€»è¾‘è¿ç®—å’Œä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä½†å½“éœ€è¦å¤§é‡çš„å¤„ç†ç±»å‹ç»Ÿä¸€çš„æ•°æ®æ—¶ï¼Œåˆ™å¯è°ƒç”¨GPUè¿›è¡Œå¹¶è¡Œè®¡ç®—ã€‚</p><h1>TPUï¼ˆTensor Processing Unitï¼‰å¼ é‡å¤„ç†å•å…ƒ</h1><p>æ·±åº¦å­¦ä¹ ç®—æ³•çš„ä¸“ç”¨èŠ¯ç‰‡</p><p>TPUçš„é«˜æ€§èƒ½è¿˜æ¥æºäºå¯¹äºä½è¿ç®—ç²¾åº¦çš„å®¹å¿ã€‚ç ”ç©¶ç»“æœè¡¨æ˜ï¼Œä½ç²¾åº¦è¿ç®—å¸¦æ¥çš„æ·±åº¦å­¦ä¹ ç®—æ³•å‡†ç¡®ç‡æŸå¤±å¾ˆå°ï¼Œä½†æ˜¯åœ¨ç¡¬ä»¶å®ç°ä¸Šå´å¯ä»¥å¸¦æ¥å·¨å¤§çš„ä¾¿åˆ©ï¼ŒåŒ…æ‹¬åŠŸè€—æ›´ä½ã€é€Ÿåº¦æ›´å¿«ã€å èŠ¯ç‰‡é¢ç§¯æ›´å°çš„è¿ç®—å•å…ƒã€æ›´å°çš„å†…å­˜å¸¦å®½éœ€æ±‚ç­‰ã€‚TPUé‡‡ç”¨äº†8æ¯”ç‰¹çš„ä½ç²¾åº¦è¿ç®—ã€‚</p><h1>NPUï¼ˆNeural Network Processing Unitï¼‰ç¥ç»ç½‘ç»œå¤„ç†å™¨</h1><p>NPUçš„å·¥ä½œåŸç†æ˜¯åœ¨ç”µè·¯å±‚æ¨¡æ‹Ÿäººç±»ç¥ç»å…ƒå’Œçªè§¦ï¼Œå¹¶ä¸”ç”¨æ·±åº¦å­¦ä¹ æŒ‡ä»¤é›†ç›´æ¥å¤„ç†å¤§è§„æ¨¡çš„ç¥ç»å…ƒå’Œçªè§¦ï¼Œä¸€æ¡æŒ‡ä»¤å®Œæˆä¸€ç»„ç¥ç»å…ƒçš„å¤„ç†ã€‚ç›¸æ¯”CPUå’ŒGPUï¼ŒNPUé€šè¿‡çªè§¦æƒé‡å®ç°å­˜å‚¨å’Œè®¡ç®—ä¸€ä½“åŒ–ï¼Œä»è€Œæé«˜è¿è¡Œæ•ˆç‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> CUDA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CUDA </tag>
            
            <tag> è®¡ç®—æœºä½“ç³»ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [8]ï¼šMNNä¸­çš„ConvolutionTiledå®ç°</title>
      <link href="/2021/11/22/AI-Algorithm-8-ConvTiledInMnn/"/>
      <url>/2021/11/22/AI-Algorithm-8-ConvTiledInMnn/</url>
      
        <content type="html"><![CDATA[<h1>å‰è¨€</h1><p>ä¸€èˆ¬å·ç§¯ï¼Œä¸»è¦é’ˆå¯¹CPUåç«¯ï¼ŒåŸºäº/source/backend/cpu/compute/ConvolutionTiledExecutor.cppæºç å±•å¼€ã€‚</p><blockquote><p>ä»¥ä¸‹é¢çš„æ•°æ®è¾“å…¥ä¸ºä¾‹ï¼Œç”±äº<code>kernelX != kernelY</code>ï¼Œå› æ­¤<code>Strassen</code>å’Œ<code>Winograd</code>å‡ä¸é€‚ç”¨ã€‚</p><p>input: <code>1 x 8 x 224 x 224</code>ï¼Œ<code>C4 Pack</code>æ ¼å¼ä¸º: <code>1 x 2 x 224 x 224 (x 4)</code></p><p>weight: <code>16 x 8 x 3 x 5</code></p><p>output: <code>1 x 16 x 222 x 220</code>ï¼Œ<code>C4 Pack</code>æ ¼å¼ä¸º: <code>1 x 4 x 222 x 220 (x 4)</code></p><p>æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œä»£ç ç‰ˆæœ¬å‡ä¸ºMNN release_1.1.7ç‰ˆæœ¬ï¼Œrelease_1.2.3ç‰ˆæœ¬å·²ç»å°†ConvolutionTiledExecutorçš„éƒ¨åˆ†å®ç°èåˆåˆ°äº†DenseConvolutionTiledExecutor.cppä¸­</p></blockquote><h1>æƒé‡é‡æ’</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _initWeight(<span class="keyword">float</span> *dest, <span class="keyword">const</span> <span class="keyword">float</span> *source, <span class="keyword">float</span>* cache, <span class="keyword">int</span> depth, <span class="keyword">int</span> outputCount, <span class="keyword">int</span> kernelSize, <span class="keyword">const</span> CoreFunctions* function) &#123;</span><br><span class="line">    <span class="comment">// Swap k, ic</span></span><br><span class="line">    <span class="keyword">int</span> dims[<span class="number">4</span>] = &#123;</span><br><span class="line">        depth,</span><br><span class="line">        kernelSize,</span><br><span class="line">        kernelSize,</span><br><span class="line">        depth</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o=<span class="number">0</span>; o&lt;outputCount; ++o) &#123;</span><br><span class="line">        <span class="keyword">auto</span> dO = cache + o * depth * kernelSize;</span><br><span class="line">        <span class="keyword">auto</span> sO = source + o * depth * kernelSize;</span><br><span class="line">        <span class="built_in">MNNTranspose32Bit</span>((<span class="keyword">int32_t</span>*)dO, (<span class="keyword">const</span> <span class="keyword">int32_t</span>*)sO, &amp;dims[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (function-&gt;bytes &lt; <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="comment">// Lowp</span></span><br><span class="line">        function-&gt;<span class="built_in">MNNFp32ToLowp</span>((<span class="keyword">float</span>*)cache, (<span class="keyword">int16_t</span>*)cache, outputCount * kernelSize * depth);</span><br><span class="line">    &#125;</span><br><span class="line">    function-&gt;<span class="built_in">MNNPackForMatMul_B</span>(dest, cache, outputCount, kernelSize * depth, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æƒé‡é‡æ’åˆ†ä¸¤ä¸ªæ­¥éª¤ï¼š</p><ul><li><ol><li><code>MNNTranspose32Bit</code>ï¼šé€ä¸ªå·ç§¯æ ¸éå†ï¼Œæ‰§è¡Œè½¬ç½®æ“ä½œã€‚</li></ol></li></ul><p><img src="/2021/11/22/AI-Algorithm-8-ConvTiledInMnn/1.png" alt="1"></p><ul><li><ol start="2"><li><code>MNNPackForMatMul_B</code>ï¼šå¯¹è½¬ç½®åçš„å·ç§¯æ ¸è¿›è¡Œ<code>C4 Pack</code>ï¼Œ <code>16 x 8 x 3 x 5</code> é‡æ’ä¸º <code>4 x 15 x 8 (x 4)</code>ã€‚</li></ol></li></ul><p><img src="/2021/11/22/AI-Algorithm-8-ConvTiledInMnn/2.png" alt="2"></p><h1>OnResize</h1><h2 id="æ•°æ®åˆ†å—">æ•°æ®åˆ†å—</h2><p>å‡è®¾<code>ePack= 24</code>ï¼Œå¯¹äºè¾“å‡ºè€Œè¨€ï¼Œå•ä¸ªFeatureMapçš„24ä¸ªè¾“å‡ºæ•°æ®ä½œä¸ºä¸€ä¸ª<code>tile</code>ï¼Œæ˜ å°„å›è¾“å…¥FeatureMapä¸­ï¼ŒæŒ‰ç…§å·ç§¯çš„è¿ç®—æµç¨‹ï¼Œå®é™…éœ€è¦çš„è¾“å…¥æ•°æ®é‡ä¸º<code>ePack * IC * kernelX * kernelY</code> ã€‚æ¯ä¸ª<code>tile</code>æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ†å—åå¯ä»¥è¿›è¡Œå¤šçº¿ç¨‹å¹¶è¡Œè®¡ç®—ã€‚</p><p>ä¸‹å›¾æ˜¯å•ä¸ªé€šé“çš„è¾“å…¥å’Œè¾“å‡ºFeatureMapè®¡ç®—ä¸­æ•°æ®ä¾èµ–å…³ç³»ï¼š</p><p><img src="/2021/11/22/AI-Algorithm-8-ConvTiledInMnn/3.png" alt="3"></p><p>ä¸ºäº†è·å¾—å®Œæ•´å¯¹åº”åˆ°ä¸€ä¸ªtileçš„è¾“å…¥æ•°æ®ï¼Œè¦å¯¹è¾“å…¥æ•°æ®è¿›è¡Œé‡æ’ï¼Œè¿™ä¸ªåœ¨åé¢å±•å¼€ã€‚</p><blockquote><p>å¯¹äºè·¨ä¸¤è¡Œçš„<code>tile</code>ï¼ŒMNNå°†å…¶åˆ†ä¸ºä¸¤éƒ¨åˆ†å¤„ç†ï¼Œæ¯”å¦‚ç¤ºä¾‹ä¸­ç¬¬ä¸€è¡Œæœ€åä¸€ä¸ª<code>tile</code>åˆ†ä¸º(4 + 20)ï¼Œè¿™ä¸€éƒ¨åˆ†å¤„ç†æ²¡æœ‰ä½¿ç”¨æŒ‡ä»¤é›†loadå’Œsaveï¼Œè§<code>_AVX_MNNPackC4ForMatMul_A</code>()ä¸­elseéƒ¨åˆ†ä»£ç ï¼Œè¿™æˆ–è®¸æ˜¯ä¸€ä¸ªå¯ä¼˜åŒ–çš„ç‚¹ã€‚</p></blockquote><h2 id="bufferåˆ†é…">bufferåˆ†é…</h2><p>æœ‰ä¸Šå›¾å¯çŸ¥ï¼Œè¦è®¡ç®—24ä¸ª<code>C4 Pack</code>çš„è¾“å‡ºæ•°æ®ï¼Œå‚ä¸<code>MatMul + Add</code> çš„è¾“å…¥æ•°æ®é‡ä¸º<code>ePack * IC * kernelX * kernelY</code>ã€‚è¿™ä¸€éƒ¨åˆ†å†…å­˜å¯¹æ¯ä¸€ä¸ªtileè€Œè¨€æ˜¯å¯ä»¥å¤ç”¨ï¼Œå› æ­¤å¯ä»¥äº‹å…ˆåˆ†é…å¥½ã€‚æºç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">mTempBufferTranspose.<span class="built_in">buffer</span>().type = halide_type_of&lt;<span class="keyword">uint8_t</span>&gt;();</span><br><span class="line">mTempBufferTranspose.<span class="built_in">buffer</span>().dimensions = <span class="number">2</span>;</span><br><span class="line">mTempBufferTranspose.<span class="built_in">buffer</span>().dim[<span class="number">0</span>].extent = threadNumber;</span><br><span class="line">mTempBufferTranspose.<span class="built_in">buffer</span>().dim[<span class="number">1</span>].extent = <span class="built_in">UP_DIV</span>(L, lP) * lP * CONVOLUTION_TILED_NUMBER * bytes;</span><br><span class="line">TensorUtils::<span class="built_in">setLinearLayout</span>(&amp;mTempBufferTranspose);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">bool</span> success = <span class="built_in">backend</span>()-&gt;<span class="built_in">onAcquireBuffer</span>(&amp;mTempBufferTranspose, Backend::DYNAMIC);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">auto</span> gemmBuffer = mTempBufferTranspose.host&lt;<span class="keyword">uint8_t</span>&gt;() + mTempBufferTranspose.<span class="built_in">stride</span>(<span class="number">0</span>) * tId;</span><br></pre></td></tr></table></figure><p>ä»¥çº¦å®šå°ºå¯¸ä¸ºä¾‹ï¼Œå¯¹äºå•çº¿ç¨‹ï¼Œæ•°æ®å…ƒç´ é•¿åº¦ä¸º1ï¼ˆuint8ï¼‰çš„æƒ…å†µï¼Œ<code>gemmBuffer</code>çš„å°ºå¯¸ä¸º<code>1 x (15 x 8 x 24) x 4</code> Bytesã€‚å…¶ä¸­1ä»£è¡¨çº¿ç¨‹æ•°ï¼Œ24ä»£è¡¨ä¸€ä¸ª<code>tile</code>çš„å¤§å°ï¼Œ4ä»£è¡¨<code>C4 Pack</code>ï¼Œ15ä»£è¡¨å·ç§¯æ ¸å°ºå¯¸<code>3 x 5</code>ï¼Œ8ä»£è¡¨è¾“å…¥é€šé“æ•°ï¼Œ<code>15 x 8</code>ä¸ªæ•°å€¼éœ€è¦ç´¯åŠ åˆ°ä¸€èµ·ä½œä¸ºå•ä¸ªå·ç§¯æ ¸çš„å·ç§¯è¾“å‡ºã€‚</p><p>å¦å¤–ä¸€ä¸ªä¸´æ—¶buffer <code>tempPtr</code>ç”¨æ¥ä¿å­˜15ä¸ªæƒé‡åæ ‡çš„ä½ç½®æŒ‡é’ˆåŠä¸€äº›ä½ç½®å‚æ•°ï¼Œæ–¹ä¾¿åé¢é‡æ’æ—¶åŠ è½½æ•°æ®ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> tempPtr = bufferAlloc-&gt;<span class="built_in">alloc</span>(kernelSize * maxLine * threadNumber * (<span class="number">4</span> * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int32_t</span>) + <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">float</span>*)));</span><br><span class="line">...</span><br><span class="line"><span class="keyword">auto</span> srcPtr = (<span class="keyword">float</span> <span class="keyword">const</span>**)((<span class="keyword">uint8_t</span>*)tempPtr.first + tempPtr.second + tId * kernelSize * maxLine * (<span class="number">4</span> * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int32_t</span>) + <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">float</span>*)));</span><br><span class="line"><span class="keyword">auto</span> el = (<span class="keyword">int32_t</span>*)(srcPtr + kernelSize * maxLine);</span><br><span class="line">...</span><br><span class="line"><span class="keyword">if</span> (end &gt; sta) &#123;</span><br><span class="line">    <span class="keyword">auto</span> lOffset = lKYOffset + (kx * ic);</span><br><span class="line">    <span class="keyword">auto</span> srcKx = srcKy + ((oxBegin + sta) * strideX + dilateX * kx - padX) * bytes * unit;</span><br><span class="line">    srcPtr[number] = (<span class="keyword">const</span> <span class="keyword">float</span>*)srcKx;</span><br><span class="line">    el[<span class="number">4</span> * number + <span class="number">0</span>] = end - sta;</span><br><span class="line">    el[<span class="number">4</span> * number + <span class="number">1</span>] = ic;</span><br><span class="line">    el[<span class="number">4</span> * number + <span class="number">2</span>] = eStart + sta;</span><br><span class="line">    el[<span class="number">4</span> * number + <span class="number">3</span>] = lOffset;</span><br><span class="line">    number++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¾“å…¥é‡æ’">è¾“å…¥é‡æ’</h2><p>å°†å•ä¸ªtileçš„è¾“å…¥é‡æ’åå­˜å…¥gemmBufferä¸­ï¼Œä¾›åç»­MatMulä½¿ç”¨ã€‚é‡æ’å®ç°ä»£ç è¯¦è§<code>_AVX_MNNPackC4ForMatMul_A</code>ã€‚è¿™éƒ¨åˆ†çš„åŸç†ä¸<a href="https://no5-aaron-wu.github.io/2021/11/16/AI-Algorithm-5-WinogradInMnn/">Winograd</a>å’Œ<a href="https://no5-aaron-wu.github.io/2021/11/18/AI-Algorithm-7-StrassenInMnn/">Strassen</a>ä¸­ä½¿ç”¨çš„è¾“å…¥å˜æ¢æ˜¯ä¸€æ ·çš„ã€‚è¿™é‡Œä¸å†å±•å¼€ã€‚é‡æ’åæ•°æ®å†…å­˜æ’å¸ƒå¦‚ä¸‹å›¾ï¼š</p><p><img src="/2021/11/22/AI-Algorithm-8-ConvTiledInMnn/4.png" alt="4"></p><h2 id="MatMul-Add">MatMul+Add</h2><p>æƒé‡å’Œè¾“å…¥æ ¹æ®ä¸Šé¢é‡æ’åï¼Œä¹˜åŠ è¿ç®—åªéœ€æŒ‰è¡ŒåšMatMulï¼Œæœ€åé€è¡Œç´¯åŠ å³å¯ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/11/22/AI-Algorithm-8-ConvTiledInMnn/5.png" alt="5"></p><ul><li><ol><li>è¾“å…¥å›¾ä¸­çš„æ¯ä¸€è¡Œï¼ˆä¸€ä¸ªé€šé“çš„24ä¸ªå€¼ï¼‰å¯¹åº”æƒé‡å›¾ä¸­çš„ä¸€ä¸ª<code>C4 Pack</code>ï¼Œä¸€è¡Œä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è·Ÿ<code>C4 pack</code>ä¸­çš„4ä¸ªå€¼ç›¸ä¹˜ï¼Œå¾—åˆ°24ä¸ª<code>C4 Pack</code>ã€‚</li></ol></li><li><ol start="2"><li>8ä¸ªé€šé“ï¼Œ15ä¸ªå·ç§¯æƒé‡å…¨éƒ¨å¾ªç¯å®Œå¾—åˆ°<code>15 x 8 x 24 (x 4)</code>çš„ä¹˜æ³•è¾“å‡ºï¼›</li></ol></li><li><ol start="3"><li>æ‰€æœ‰è¡Œç´¯åŠ å¾—åˆ°4ä¸ªå·ç§¯æ ¸ç›¸å¯¹äº1ä¸ªè¾“å‡º<code>tile</code>çš„æœ€ç»ˆè¾“å‡º<code>24 (x 4)</code>;</li></ol></li><li><ol start="4"><li>å¤–å±‚å†å¾ªç¯éå†å®Œæ‰€æœ‰çš„å·ç§¯æ ¸ï¼Œä¾¿å¯å¾—åˆ°1ä¸ª<code>tile</code>éƒ½å·ç§¯è¾“å‡º<code>4 x 24 (x 4)</code>ã€‚</li></ol></li></ul><p>å®ç°ä»£ç è¯¦è§<code>_AVX_MNNPackedMatMulFMA</code>ä»¥åŠ<code>_AVX_MNNPackedMatMul_Main</code>ï¼ŒåŸç†ä¸<a href="https://no5-aaron-wu.github.io/2021/11/16/AI-Algorithm-5-WinogradInMnn/">Winograd</a>å’Œ<a href="https://no5-aaron-wu.github.io/2021/11/18/AI-Algorithm-7-StrassenInMnn/">Strassen</a>ä¸­çš„ä¹˜åŠ æ“ä½œä¸€æ ·ã€‚ä¸å†å±•å¼€ã€‚</p><h2 id="åå¤„ç†">åå¤„ç†</h2><p><code>AVX2GemmPostTreat</code>åŸç†ä¸<a href="https://no5-aaron-wu.github.io/2021/11/16/AI-Algorithm-5-WinogradInMnn/">Winograd</a>å’Œ<a href="https://no5-aaron-wu.github.io/2021/11/18/AI-Algorithm-7-StrassenInMnn/">Strassen</a>ä¸­çš„åå¤„ç†æ“ä½œä¸€æ ·ã€‚ä¸å†å±•å¼€ã€‚</p><h1>onExecute</h1><p>æ‰§è¡Œæ—¶è°ƒç”¨onResizeä¸­çš„å›è°ƒå‡½æ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">ErrorCode <span class="title">ConvolutionTiledExecutorBasic::onExecute</span><span class="params">(<span class="keyword">const</span> std::vector&lt;Tensor*&gt;&amp; inputs,</span></span></span><br><span class="line"><span class="params"><span class="function">                                                   <span class="keyword">const</span> std::vector&lt;Tensor*&gt;&amp; outputs)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">MNN_CONCURRENCY_BEGIN</span>(tId, mFunction.first) &#123;</span><br><span class="line">        mFunction.<span class="built_in">second</span>((<span class="keyword">int</span>)tId);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">MNN_CONCURRENCY_END</span>();</span><br><span class="line">    <span class="keyword">return</span> NO_ERROR;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>è‡´è°¢</h1><p>æ–‡ç« ä¸»ä½“æ¡†æ¶å‚è€ƒè‡ª<a href="https://github.com/yizhaoyanbo">ä¸œå“¥</a>çš„MNNæºç è§£è¯»çš„å†…éƒ¨åˆ†äº«ï¼ŒåŠ ä¸Šäº†è‡ªå·±çš„ä¸€äº›çœ‹æ³•ã€‚æœ‰å¹¸è¢«çœ‹åˆ°çš„è¯ï¼Œå¸Œæœ›èƒ½ç»™ç‚¹ä¸ªèµ~~</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Algorithm </tag>
            
            <tag> MNN </tag>
            
            <tag> convolution </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [7]ï¼šMNNä¸­çš„Strassenå®ç°</title>
      <link href="/2021/11/18/AI-Algorithm-7-StrassenInMnn/"/>
      <url>/2021/11/18/AI-Algorithm-7-StrassenInMnn/</url>
      
        <content type="html"><![CDATA[<h1>å‰è¨€</h1><p>ä¸»è¦é’ˆå¯¹CPUåç«¯ï¼ŒåŸºäº<mnnrootdir>/source/backend/cpu/compute/Convolution1x1Strassen.cppæºç å±•å¼€ã€‚</mnnrootdir></p><blockquote><p>ä»¥è¾“å…¥å¤§å°ï¼š<code>1 x 8 x 224 x 224</code>ï¼ˆ<code>C4 Pack</code>ä¸º<code>1 x 2 x 224 x 224 (x 4)</code>ï¼‰ï¼Œæƒé‡å¤§å°: <code>16 x 8 x 1 x 1</code>(MNNä¸­å°†å…¶å˜æ¢ä¸º<code>1 x 4 x 8 (x 4)</code>ï¼Œå³å¯¹è¾“å‡ºé€šé“ï¼ˆå·ç§¯æ ¸ä¸ªæ•°ï¼‰è¿›è¡Œ<code>C4 Pack</code>), è¾“å‡º<code>1 x 16 x 224 x 224</code>ï¼ˆ<code>C4 Pack</code>ä¸º<code>1 x 4 x 224 x 224 (x 4)</code>ï¼‰ä¸ºä¾‹è¿›è¡Œè¾…åŠ©è¯´æ˜ã€‚</p><p>æ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œä»£ç ç‰ˆæœ¬å‡ä¸ºMNN release_1.2.3ç‰ˆæœ¬</p></blockquote><h1>é€‚ç”¨æ¡ä»¶</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">bool</span> fastWay = common-&gt;<span class="built_in">kernelY</span>() == <span class="number">1</span> &amp;&amp; common-&gt;<span class="built_in">kernelX</span>() == <span class="number">1</span></span><br><span class="line">        &amp;&amp; output-&gt;<span class="built_in">width</span>() == input-&gt;<span class="built_in">width</span>() &amp;&amp; output-&gt;<span class="built_in">height</span>() == input-&gt;<span class="built_in">height</span>()</span><br><span class="line">        &amp;&amp; common-&gt;<span class="built_in">strideX</span>() == <span class="number">1</span> &amp;&amp; common-&gt;<span class="built_in">strideY</span>() == <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span> (fastWay) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Convolution1x1Strassen</span>(common, backend, originWeight, originWeightSize, bias, biasSize);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯è§åªé’ˆå¯¹<code>kernelX = kernelY = strideX = strideY = 1</code>çš„å·ç§¯æ“ä½œã€‚</p><h1>æƒé‡é‡æ’</h1><p>åˆå§‹æƒé‡ä¸º<code>NCHW</code>æ’å¸ƒï¼š<code>16 x 8 x 1 x1</code>ï¼ŒæŒ‰<code>NC/4HW4</code>é‡æ’åä¸º <code>1x 4 x 8 (x 4)</code>ã€‚å³é’ˆå¯¹å·ç§¯æ ¸ä¸ªæ•°è¿›è¡Œ<code>C4 Pack</code>ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/11/18/AI-Algorithm-7-StrassenInMnn/1.png" alt="1"></p><p>æ‰§è¡Œä»£ç æ®µå¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">core-&gt;<span class="built_in">MNNPackForMatMul_B</span>(mResource-&gt;mWeight-&gt;host&lt;<span class="keyword">float</span>&gt;(), originWeight, outputCount, mSrcCount, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure><h1>onResize</h1><p>Strassençš„æ‰€æœ‰æ­¥éª¤å®ç°ä¸åœ¨<code>onExecute</code>é‡Œï¼Œ<code>onExecute</code>ä¸­åªé€šè¿‡<code>mFunctions</code>ä¸­çš„å‡½æ•°æŒ‡é’ˆè°ƒç”¨<code>onResize</code>ä¸­çš„å®ç°ï¼ˆå°†è®¡ç®—æ­¥éª¤æ‹†è§£æˆè‹¥å¹²ä¸ªlambdaå‡½æ•°ï¼Œæ”¾åˆ°<code>mFunctions</code>ä¸­ï¼‰ã€‚</p><p>MNNå¤šçº¿ç¨‹åŠ é€Ÿåœ¨è¿™é‡Œæœ‰ä¸åŒçš„é€‰æ‹©ï¼Œå½“featureMapå°ºå¯¸å¾ˆå¤§æ—¶ï¼Œæ ¹æ®featureMapè¿›è¡Œåˆ’åˆ†ï¼Œæ¯ä¸ªçº¿ç¨‹å¤„ç†ä¸€å—ï¼Œå¦åˆ™æ ¹æ®è¾“å‡ºé€šé“åˆ’åˆ†ï¼Œæ¯ä¸ªçº¿ç¨‹å¤„ç†ä¸€ä¸ªï¼ˆ<code>C4</code>ï¼‰é€šé“ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (matrixSizeE &gt; CONVOLUTION_TILED_NUMBER * <span class="number">8</span> * numberThread &amp;&amp; matrixSizeE &gt; ocC4) &#123;</span><br><span class="line">    <span class="comment">// Divide in plane, in this case the divide equal numberThread</span></span><br><span class="line">    ...</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// Divide in ocC4</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æš‚æ—¶æŒ‰ç…§å•çº¿ç¨‹è¿›è¡Œè¯´æ˜ã€‚åˆ›å»º<code>StrassenMatMulComputer</code>ç±»å¯¹è±¡ï¼Œé€šè¿‡<code>onEncode</code>æ¥å£è¿›å…¥<code>StrassenMatMulComputer</code>å®ç°ç±»ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">unit.mStracssenComputor.<span class="built_in">reset</span>(<span class="keyword">new</span> <span class="built_in">StrassenMatrixComputor</span>(<span class="built_in">backend</span>(), <span class="literal">false</span>, maxDepth));</span><br><span class="line">...</span><br><span class="line"><span class="keyword">auto</span> code = unit.mStracssenComputor-&gt;<span class="built_in">onEncode</span>(mTempInputVector, mTempOutputVector, postParameters, ic, oc);</span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œ<code>StrassenMatMulComputer</code>ç±»æ„é€ å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºfalseï¼Œå³<code>mSupportMultiThread=false</code>ï¼Œè¡¨ç¤ºå†å¾€ä¸‹çš„æ“ä½œä¸ä¼šå†è¿›è¡Œçº¿ç¨‹åˆ’åˆ†ï¼Œå› ä¸ºä¸Šé¢å·²ç»åšè¿‡äº†ã€‚</p><p><code>onEncode</code>ä¼šè°ƒç”¨<code>_generateMatMul</code>ï¼Œå…¶ä¸­åŒ…å«Strassenåˆ†å—çš„ä¸»è¦å®ç°ã€‚</p><h2 id="generateMatMul">_generateMatMul</h2><p>Strassenç®—æ³•æœ¬èº«åŒ…å«çŸ©é˜µåˆ†å—çš„é€’å½’è®¡ç®—ï¼Œå› æ­¤<code>_generateMatMul</code>æ˜¯ä¸ªé€’å½’å‡½æ•°ã€‚</p><p>é‚£ä¹ˆå…ˆçœ‹é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ï¼Œå³ä½•æ—¶ç»“æŸåˆ†å—æ“ä½œï¼Œè¿›è¡Œæ™®é€šçš„å·ç§¯è¿ç®—ã€‚ç»ˆæ­¢æ¡ä»¶æœ‰ä¸¤ä¸ªï¼š</p><ul><li><ol><li>åµŒå¥—æ·±åº¦è¶…è¿‡è®¾å®šçš„æœ€å¤§æ·±åº¦æ—¶ï¼Œæˆ–è€…<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>çŸ©é˜µä¸èƒ½å†ç»§ç»­åˆ†å—æ—¶ï¼š</li></ol></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (currentDepth &gt;= mMaxDepth || eSub == <span class="number">0</span> || hSub == <span class="number">0</span> || l % (<span class="number">2</span> * core-&gt;pack) != <span class="number">0</span> || l % (<span class="number">2</span> * lP) || l % (<span class="number">2</span> * packHUnit) != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> _generateBasicMatMul(e, l, h, AT, BT, CT, COT, postParameters);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><ol start="2"><li>è¯»å†™å†…å­˜çš„æ¬¡æ•°å¤§äºæ™®é€šå·ç§¯å®ç°æ—¶ï¼š</li></ol></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (saveCost &lt;= <span class="number">0.0f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> _generateBasicMatMul(e, l, h, AT, BT, CT, COT, postParameters);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€’å½’éƒ¨åˆ†ä»£ç çš„è¿ç®—é¡ºåºå’Œå†…å­˜bufferä½¿ç”¨æƒ…å†µä¸<a href="https://no5-aaron-wu.github.io/2021/11/18/AI-Algorithm-6-Strassen/">ä¸Šä¸€ç¯‡</a>ä»‹ç»çš„æ”¹è¿›ç‰ˆæœ¬Strassenç®—æ³•æ˜¯ä¸€è‡´çš„ï¼Œé€šè¿‡å°†åˆ†å—æ“ä½œåˆ†è§£æˆè‹¥å¹²ä¸ªlambdaå‡½æ•°ï¼Œå‹å…¥<code>mFunctions</code>å‘é‡ï¼Œåœ¨onExecuteæ—¶æ‰§è¡Œã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Strassen Construct</span></span><br><span class="line"><span class="keyword">auto</span> bn = <span class="built_in">backend</span>();</span><br><span class="line"><span class="keyword">auto</span> allocator = <span class="keyword">static_cast</span>&lt;CPUBackend*&gt;(<span class="built_in">backend</span>())-&gt;<span class="built_in">getBufferAllocator</span>();</span><br><span class="line">currentDepth += <span class="number">1</span>;</span><br><span class="line"><span class="keyword">auto</span> maxlH = std::<span class="built_in">max</span>(lSub, hSub);</span><br><span class="line"><span class="function">AutoMemory <span class="title">YAddr</span><span class="params">(hSub * lSub * core-&gt;bytes, allocator)</span></span>;</span><br><span class="line"><span class="function">AutoMemory <span class="title">XAddr</span><span class="params">(maxlH * eSub * core-&gt;bytes, allocator)</span></span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">nullptr</span> == XAddr.<span class="built_in">get</span>().first || <span class="literal">nullptr</span> == YAddr.<span class="built_in">get</span>().first) &#123;</span><br><span class="line">    <span class="keyword">return</span> OUT_OF_MEMORY;</span><br><span class="line">&#125;</span><br><span class="line">MatrixInfo Y;</span><br><span class="line">Y.stackIndex = (<span class="keyword">int</span>)mStack.<span class="built_in">size</span>();</span><br><span class="line">mStack.<span class="built_in">emplace_back</span>((<span class="keyword">uint8_t</span>*)YAddr.<span class="built_in">get</span>().first + YAddr.<span class="built_in">get</span>().second);</span><br><span class="line">Y.offsetBytes = <span class="number">0</span>;</span><br><span class="line">Y.lineStrideBytes = lSub * core-&gt;bytes * hP;</span><br><span class="line">MatrixInfo X;</span><br><span class="line">X.stackIndex = (<span class="keyword">int</span>)mStack.<span class="built_in">size</span>();</span><br><span class="line">X.offsetBytes = <span class="number">0</span>;</span><br><span class="line">X.lineStrideBytes = eSub * core-&gt;bytes * core-&gt;pack;</span><br><span class="line">mStack.<span class="built_in">emplace_back</span>((<span class="keyword">uint8_t</span>*)XAddr.<span class="built_in">get</span>().first + XAddr.<span class="built_in">get</span>().second);</span><br><span class="line"></span><br><span class="line">MatrixInfo CX;</span><br><span class="line">CX.stackIndex = X.stackIndex;</span><br><span class="line">CX.offsetBytes = <span class="number">0</span>;</span><br><span class="line">CX.lineStrideBytes = eSub * core-&gt;bytes * core-&gt;pack;</span><br><span class="line"></span><br><span class="line">MatrixInfo a11 = AT;</span><br><span class="line">MatrixInfo a12 = AT;</span><br><span class="line">a12.offsetBytes = AT.offsetBytes + AT.lineStrideBytes * lSubUnit;</span><br><span class="line">MatrixInfo a21 = AT;</span><br><span class="line">a21.offsetBytes = AT.offsetBytes + eSub * core-&gt;pack * core-&gt;bytes;</span><br><span class="line">MatrixInfo a22 = AT;</span><br><span class="line">a22.offsetBytes = AT.offsetBytes + eSub * core-&gt;pack * core-&gt;bytes + AT.lineStrideBytes * lSubUnit;</span><br><span class="line"></span><br><span class="line">MatrixInfo b11 = BT;</span><br><span class="line">MatrixInfo b12 = BT;</span><br><span class="line">b12.offsetBytes = BT.offsetBytes + BT.lineStrideBytes * (hSub / hP);</span><br><span class="line">MatrixInfo b21 = BT;</span><br><span class="line">b21.offsetBytes = BT.offsetBytes + lSub * hP * core-&gt;bytes;</span><br><span class="line">MatrixInfo b22 = BT;</span><br><span class="line">b22.offsetBytes = BT.offsetBytes + BT.lineStrideBytes * (hSub / hP) + lSub * hP * core-&gt;bytes;</span><br><span class="line"></span><br><span class="line">MatrixInfo c11 = CT;</span><br><span class="line">MatrixInfo c12 = CT;</span><br><span class="line">c12.offsetBytes = CT.offsetBytes + CT.lineStrideBytes * (hSub / core-&gt;pack);</span><br><span class="line">MatrixInfo c21 = CT;</span><br><span class="line">c21.offsetBytes = CT.offsetBytes + eSub * core-&gt;pack * core-&gt;bytes;</span><br><span class="line">MatrixInfo c22 = CT;</span><br><span class="line">c22.offsetBytes = CT.offsetBytes + eSub * core-&gt;pack * core-&gt;bytes + CT.lineStrideBytes * (hSub / core-&gt;pack);</span><br><span class="line"></span><br><span class="line">MatrixInfo Empty;</span><br><span class="line">Empty.stackIndex = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// S3=A11-A21, T3=B22-B12, P7=S3*T3</span></span><br><span class="line">    <span class="keyword">auto</span> f = [a11, a21, b22, b12, X, Y, eSub, lSub, hSub, numberThread, core, hP, <span class="keyword">this</span>, bWidth, aHeight, bHeight](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="keyword">auto</span> xAddr = mStack[X.stackIndex] + X.offsetBytes;</span><br><span class="line">        <span class="keyword">auto</span> yAddr = mStack[Y.stackIndex] + Y.offsetBytes;</span><br><span class="line">        <span class="keyword">auto</span> a11Ptr = mStack[a11.stackIndex] + a11.offsetBytes;</span><br><span class="line">        <span class="keyword">auto</span> a21Ptr = mStack[a21.stackIndex] + a21.offsetBytes;</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(xAddr, a11Ptr, a21Ptr, eSub, X.lineStrideBytes, a11.lineStrideBytes, a21.lineStrideBytes, aHeight, core);</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(yAddr, mStack[b22.stackIndex] + b22.offsetBytes, mStack[b12.stackIndex] + b12.offsetBytes, bWidth, Y.lineStrideBytes, b22.lineStrideBytes, b12.lineStrideBytes, bHeight, core);</span><br><span class="line">    &#125;;</span><br><span class="line">    mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(f, numberThread));</span><br><span class="line">    <span class="keyword">auto</span> code = _generateMatMul(eSub, lSub, hSub, X, Y, c21, Empty, currentDepth, &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (code != NO_ERROR) &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// S1=A21+A22, T1=B12-B11, P5=S1T1</span></span><br><span class="line">    <span class="keyword">auto</span> f = [a22, a21, b11, b12, X, Y, eSub, lSub, hSub, numberThread, hP, core, <span class="keyword">this</span>, bWidth, aHeight, bHeight](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="built_in">MNNMATRIX_ADD_MULTITHREAD</span>(mStack[X.stackIndex] + X.offsetBytes, mStack[a21.stackIndex] + a21.offsetBytes, mStack[a22.stackIndex] + a22.offsetBytes , eSub, X.lineStrideBytes, a21.lineStrideBytes, a22.lineStrideBytes, aHeight, core);</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(mStack[Y.stackIndex] + Y.offsetBytes, mStack[b12.stackIndex] + b12.offsetBytes, mStack[b11.stackIndex] + b11.offsetBytes, bWidth, Y.lineStrideBytes, b12.lineStrideBytes, b11.lineStrideBytes, bHeight, core);</span><br><span class="line">    &#125;;</span><br><span class="line">    mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(f, numberThread));</span><br><span class="line">    <span class="keyword">auto</span> code = _generateMatMul(eSub, lSub, hSub, X, Y, c22, Empty, currentDepth, &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (code != NO_ERROR) &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// S2=S1-A11, T2=B22-T1, P6=S2T2</span></span><br><span class="line">    <span class="keyword">auto</span> f = [a11, b22, X, Y, eSub, lSub, hSub, numberThread, hP, core, <span class="keyword">this</span>, bWidth, aHeight, bHeight](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="keyword">auto</span> xAddr = mStack[X.stackIndex] + X.offsetBytes;</span><br><span class="line">        <span class="keyword">auto</span> yAddr = mStack[Y.stackIndex] + Y.offsetBytes;</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(xAddr, xAddr, mStack[a11.stackIndex] + a11.offsetBytes, eSub, X.lineStrideBytes, X.lineStrideBytes, a11.lineStrideBytes, aHeight, core);</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(yAddr, mStack[b22.stackIndex] + b22.offsetBytes, yAddr, bWidth, Y.lineStrideBytes, b22.lineStrideBytes, Y.lineStrideBytes, bHeight, core);</span><br><span class="line">    &#125;;</span><br><span class="line">    mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(f, numberThread));</span><br><span class="line">    <span class="keyword">auto</span> code = _generateMatMul(eSub, lSub, hSub, X, Y, c12, Empty, currentDepth, &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (code != NO_ERROR) &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// S4=A12-S2, P3=S4*B22, P1=A11*B11</span></span><br><span class="line">    <span class="keyword">auto</span> f = [a12, X, eSub, aHeight, numberThread, core, <span class="keyword">this</span>](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="keyword">auto</span> xAddr = mStack[X.stackIndex] + X.offsetBytes;</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(xAddr, mStack[a12.stackIndex] + a12.offsetBytes, xAddr, eSub, X.lineStrideBytes, a12.lineStrideBytes, X.lineStrideBytes, aHeight, core);</span><br><span class="line">    &#125;;</span><br><span class="line">    mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(f, numberThread));</span><br><span class="line">    <span class="keyword">auto</span> code = _generateMatMul(eSub, lSub, hSub, X, b22, c11, Empty, currentDepth, &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (code != NO_ERROR) &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">    code = _generateMatMul(eSub, lSub, hSub, a11, b11, CX, Empty, currentDepth, &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (code != NO_ERROR) &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// U2=P1+P6, U3=U2+P7, U4=U2+P5, U7=U3+P5</span></span><br><span class="line">    <span class="comment">// U5=U4+P3, T4=T2-B21, P4=A22*T4</span></span><br><span class="line">    <span class="keyword">auto</span> f = [c11, c12, c21, c22, b21, X, Y, eSub, bWidth, cHeight, bHeight, numberThread, core, <span class="keyword">this</span>](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> y = tId; y &lt; cHeight; y+=numberThread) &#123;</span><br><span class="line">            core-&gt;<span class="built_in">MNNStrassenMergeCFunction</span>((<span class="keyword">float</span>*)(mStack[c11.stackIndex] + c11.offsetBytes + y * c11.lineStrideBytes), (<span class="keyword">float</span>*)(mStack[c12.stackIndex] + c12.offsetBytes + y * c12.lineStrideBytes), (<span class="keyword">float</span>*)(mStack[c21.stackIndex] + c21.offsetBytes + y * c21.lineStrideBytes), (<span class="keyword">float</span>*)(mStack[c22.stackIndex] + c22.offsetBytes + y * c22.lineStrideBytes), (<span class="keyword">float</span>*)(mStack[X.stackIndex] + X.offsetBytes + y * X.lineStrideBytes), <span class="number">0</span>, eSub, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> yAddr = mStack[Y.stackIndex] + Y.offsetBytes;</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(yAddr, yAddr, mStack[b21.stackIndex] + b21.offsetBytes, bWidth, Y.lineStrideBytes, Y.lineStrideBytes, b21.lineStrideBytes, bHeight, core);</span><br><span class="line">    &#125;;</span><br><span class="line">    mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(f, numberThread));</span><br><span class="line">    <span class="keyword">auto</span> code = _generateMatMul(eSub, lSub, hSub, a22, Y, c11, Empty, currentDepth, &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (code != NO_ERROR) &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// U6=U3-P4, P2=A12*B21, U1=P1+P2</span></span><br><span class="line">    <span class="keyword">auto</span> f0 = [c11, c21, eSub, cHeight, numberThread, core, <span class="keyword">this</span>](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="keyword">auto</span> cw = eSub;</span><br><span class="line">        <span class="keyword">auto</span> c21Addr = mStack[c21.stackIndex] + c21.offsetBytes;</span><br><span class="line">        <span class="built_in">MNNMATRIX_SUB_MULTITHREAD</span>(c21Addr, c21Addr, mStack[c11.stackIndex] + c11.offsetBytes, cw, c21.lineStrideBytes, c21.lineStrideBytes, c11.lineStrideBytes, cHeight, core);</span><br><span class="line">    &#125;;</span><br><span class="line">    mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(f0, numberThread));</span><br><span class="line">    <span class="keyword">auto</span> code = _generateMatMul(eSub, lSub, hSub, a12, b21, c11, Empty, currentDepth, &#123;&#125;);</span><br><span class="line">    <span class="keyword">if</span> (code != NO_ERROR) &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> f1 = [c11, X, eSub, cHeight, numberThread, core, <span class="keyword">this</span>](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="keyword">auto</span> cw = eSub;</span><br><span class="line">        <span class="keyword">auto</span> c11Ptr = mStack[c11.stackIndex] + c11.offsetBytes;</span><br><span class="line">        <span class="keyword">auto</span> xAddr = mStack[X.stackIndex] + X.offsetBytes;</span><br><span class="line">        <span class="built_in">MNNMATRIX_ADD_MULTITHREAD</span>(c11Ptr, c11Ptr, xAddr, cw, c11.lineStrideBytes, c11.lineStrideBytes, X.lineStrideBytes, cHeight, core);</span><br><span class="line">    &#125;;</span><br><span class="line">    mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(f1, numberThread));</span><br><span class="line">... <span class="comment">// post </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢ç€é‡çœ‹ä¸‹<code>1 x 1</code>å·ç§¯çš„çŸ©é˜µä¹˜æ³•å’Œåˆ†å—é€»è¾‘ï¼š</p><h3 id="æ™®é€šçš„1-Ã—-1å·ç§¯çš„çŸ©é˜µä¹˜æ³•ï¼ˆC-ABï¼‰ï¼š">æ™®é€šçš„<code>1 Ã— 1</code>å·ç§¯çš„çŸ©é˜µä¹˜æ³•ï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">C=AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ï¼‰ï¼š</h3><p><img src="/2021/11/18/AI-Algorithm-7-StrassenInMnn/2.png" alt="2"></p><p><em>è“è‰²è™šçº¿æ¡†ä»£è¡¨ä¸€æ¬¡å·ç§¯ä¹˜åŠ è¿ç®—</em></p><h3 id="MNNC4-Packçš„1-Ã—-1å·ç§¯çš„çŸ©é˜µä¹˜æ³•ï¼š">MNN<code>C4 Pack</code>çš„<code>1 Ã— 1</code>å·ç§¯çš„çŸ©é˜µä¹˜æ³•ï¼š</h3><p><img src="/2021/11/18/AI-Algorithm-7-StrassenInMnn/3.png" alt="3"></p><ul><li><p>ä¸Šå›¾ä¸­æ¯ä¸ªæ–¹å—ä»£è¡¨ä¸€ä¸ª<code>C4 Pack</code>ï¼Œè¾“å…¥æŒ‰è¾“å…¥é€šé“packï¼Œå·ç§¯æ ¸æŒ‰å·ç§¯æ ¸ä¸ªæ•°packï¼Œè¾“å…¥æŒ‰è¾“å‡ºé€šé“pack;</p></li><li><p>è¾“å…¥<code>2 x 224 x 224 (x 4)</code>å¯ä»¥çœ‹ä½œæ™®é€šçŸ©é˜µä¹˜æ³•ä¸­<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>çš„è½¬ç½®ï¼ˆ<code>2 x 50176 (x 4)</code>ï¼‰ï¼Œå·ç§¯æ ¸<code>4 x 8 x</code>å¯ä»¥çœ‹ä½œæ™®é€šçŸ©é˜µä¹˜æ³•ä¸­<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>çš„è½¬ç½®ï¼Œè¾“å‡º<code>4 x 224 x 224 (x 4)</code>å¯ä»¥çœ‹ä½œæ™®é€šçŸ©é˜µä¹˜æ³•ä¸­<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>çš„è½¬ç½®ï¼ˆ<code>4 x 50176 (x 4)</code>ï¼‰ã€‚</p></li><li><p>å¦‚æœå½“å‰çŸ©é˜µä¸å†è¿›è¡Œåˆ†å—ï¼Œåˆ™ä¸€æ¬¡å·ç§¯ä¹˜åŠ è¿ç®—å¯¹åº”ä¸ºçº¢è‰²è™šçº¿æ¡†ä¸­çš„å…ƒç´ ï¼Œç›´è§‚å¯ä»¥ç†è§£ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>C</mi><mi>T</mi></msup><mo>=</mo><mo stretchy="false">(</mo><mi>A</mi><mi>B</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>=</mo><msup><mi>B</mi><mi>T</mi></msup><msup><mi>A</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">C^T=(AB)^T=B^TA^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ï¼Œå®é™…çš„MNNæ‰§è¡Œä¸­ï¼Œä¼šå…ˆå¯¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>çŸ©é˜µè¿›è¡Œé‡æ’ï¼ˆ<code>MNNPackC4ForMatMul_A</code>ï¼‰ï¼Œå…·ä½“ä¸‹æ–‡å†è°ˆã€‚</p></li></ul><h3 id="StrassençŸ©é˜µåˆ†å—ï¼š">StrassençŸ©é˜µåˆ†å—ï¼š</h3><p><img src="/2021/11/18/AI-Algorithm-7-StrassenInMnn/4.png" alt="4"></p><p>åœ¨è½¬ç½®å½¢å¼ä¸‹è¿›è¡Œåˆ†å—è¿ç®—ï¼Œå„å­å—çš„çŸ©é˜µä¹˜æ³•é€’å½’è°ƒç”¨<code>_generateMatMul</code>ç›´åˆ°æ»¡è¶³é€’å½’ç»ˆæ­¢æ¡ä»¶åï¼Œåˆ‡æ¢åˆ°æ™®é€šçŸ©é˜µä¹˜æ³•ã€‚</p><h2 id="generateBasicMatMul">_generateBasicMatMul</h2><p><code>_generateBasicMatMul</code>å‡½æ•°ä¸­ä¼šè°ƒç”¨<code>_generateTrivalMatMul</code>æ‰§è¡Œæ™®é€š<code>1 x 1</code>å·ç§¯æ“ä½œï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">mFunctions.<span class="built_in">emplace_back</span>(</span><br><span class="line">    std::<span class="built_in">make_pair</span>([cStride, l, h, xCount, AT, BT, CT, COT, tileHostOrigin, unitNumber, bExtraStride, numberThread, eReal, eP, active, <span class="keyword">this</span>](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">        <span class="keyword">auto</span> core = <span class="keyword">static_cast</span>&lt;CPUBackend*&gt;(<span class="built_in">backend</span>())-&gt;<span class="built_in">functions</span>();</span><br><span class="line">        <span class="keyword">size_t</span> parameters[<span class="number">6</span>];</span><br><span class="line">        parameters[<span class="number">0</span>] = xCount * core-&gt;bytes;</span><br><span class="line">        parameters[<span class="number">1</span>] = l;</span><br><span class="line">        parameters[<span class="number">2</span>] = h;</span><br><span class="line">        parameters[<span class="number">3</span>] = cStride;</span><br><span class="line">        parameters[<span class="number">4</span>] = <span class="number">0</span>;</span><br><span class="line">        parameters[<span class="number">5</span>] = bExtraStride;</span><br><span class="line">        <span class="keyword">auto</span> tileHost = tileHostOrigin + eP * parameters[<span class="number">1</span>] * tId * core-&gt;bytes;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">float</span>* postParametersPtr = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">if</span> (!active.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            postParametersPtr = active.<span class="built_in">data</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> aHost = mStack[AT.stackIndex] + AT.offsetBytes;</span><br><span class="line">        <span class="keyword">auto</span> bHost = mStack[BT.stackIndex] + BT.offsetBytes;</span><br><span class="line">        <span class="keyword">auto</span> cHost = mStack[CT.stackIndex] + CT.offsetBytes;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">uint8_t</span>* biasPtr = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">-1</span> != COT.stackIndex) &#123;</span><br><span class="line">            biasPtr = mStack[COT.stackIndex] + COT.offsetBytes;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> packUnit = core-&gt;bytes * core-&gt;pack;</span><br><span class="line">        <span class="keyword">int32_t</span> info[<span class="number">4</span>];</span><br><span class="line">        <span class="keyword">int32_t</span> stride[<span class="number">4</span>];</span><br><span class="line">        stride[<span class="number">0</span>] = eP;</span><br><span class="line">        stride[<span class="number">1</span>] = parameters[<span class="number">1</span>];</span><br><span class="line">        stride[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">        stride[<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">        info[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        info[<span class="number">1</span>] = eReal;</span><br><span class="line">        info[<span class="number">2</span>] = eP;</span><br><span class="line">        info[<span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = tId; i &lt; unitNumber; i+=numberThread) &#123;</span><br><span class="line">            <span class="keyword">int</span> xStart    = i * eP;</span><br><span class="line">            <span class="keyword">auto</span> aStart   = aHost + xStart * packUnit;</span><br><span class="line">            core-&gt;<span class="built_in">MNNPackC4ForMatMul_A</span>((<span class="keyword">float</span>*)(tileHost), (<span class="keyword">const</span> <span class="keyword">float</span>**)(&amp;aStart), info, stride);</span><br><span class="line">            core-&gt;<span class="built_in">MNNPackedMatMul</span>((<span class="keyword">float</span>*)(cHost + xStart * packUnit), (<span class="keyword">float</span>*)tileHost, (<span class="keyword">float</span>*)bHost, parameters, postParametersPtr, (<span class="keyword">const</span> <span class="keyword">float</span>*)biasPtr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (tId != numberThread <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (xCount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            stride[<span class="number">0</span>] = xCount;</span><br><span class="line">            stride[<span class="number">1</span>] = parameters[<span class="number">1</span>];</span><br><span class="line">            info[<span class="number">2</span>] = xCount;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> xStart    = unitNumber * eP;</span><br><span class="line">            <span class="keyword">auto</span> aStart   = aHost + xStart * packUnit;</span><br><span class="line">            <span class="comment">// Copy</span></span><br><span class="line">            core-&gt;<span class="built_in">MNNPackC4ForMatMul_A</span>((<span class="keyword">float</span>*)(tileHost), (<span class="keyword">const</span> <span class="keyword">float</span>**)(&amp;aStart), info, stride);</span><br><span class="line">            core-&gt;<span class="built_in">MNNPackedMatMulRemain</span>((<span class="keyword">float</span>*)(cHost + xStart * packUnit), (<span class="keyword">float</span>*)tileHost, (<span class="keyword">float</span>*)bHost, xCount, parameters, postParametersPtr, (<span class="keyword">const</span> <span class="keyword">float</span>*)biasPtr);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, numberThread));</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>unitNumber</code>ä¸ºå½“å‰çº¿ç¨‹éœ€è¦å¤„ç†å¤šå°‘ä¸ª<code>unit</code>ï¼Œå‡è®¾<code>eP = 24</code>ï¼Œä»£è¡¨æ¯ä¸ª<code>unit</code>å¤„ç†24ä¸ª<code>C4 Pack</code>ï¼Œå‡è®¾<code>numberThread=4</code>ï¼Œåˆ™<code>unitNumber = (224 x 224) / 4 / eP = 522</code>ã€‚å³ä¸€ä¸ªçº¿ç¨‹å¾ªç¯ä¸­å¯¹522ä¸ª<code>unit</code>è¿›è¡Œå¤„ç†ï¼Œä¸èƒ½æ•´é™¤çš„éƒ¨åˆ†å•ç‹¬å¤„ç†å³å¯ã€‚</p><blockquote><p>ä½†æ˜¯ç”±äºä¹‹å‰æåˆ°çš„<code>mSupportMultiThread=false</code>ï¼Œ<code>numberThread</code>å®é™…ä¸Šæ˜¯æ’ä¸º1ã€‚å¹¶ä¸ä¼šåœ¨è¿™ä¸€å±‚çº§è¿›è¡Œå¤šçº¿ç¨‹åˆ’åˆ†ã€‚</p></blockquote><p>å¯¹äºå•ä¸ªunitçš„ä¹˜åŠ æ“ä½œï¼Œä¸»è¦åœ¨äº<code>MNNPackC4ForMatMul_A</code>å’Œ<code>MNNPackedMatMul</code>ä¸¤ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå¦‚æœçœ‹è¿‡<a href="https://no5-aaron-wu.github.io/2021/11/16/AI-Algorithm-5-WinogradInMnn/">è¿™ç¯‡æ–‡ç« </a>çš„è¯ï¼Œå…¶å®è¿™é‡Œè·Ÿ<code>Winograd</code>çš„å•ä¸ª<code>tile</code>çš„ä¹˜åŠ æ“ä½œå…¶å®æ˜¯å¤ç”¨ç›¸åŒçš„å‡½æ•°ã€‚å¯ä»¥è·³è½¬å»çœ‹ï¼Œè¿™é‡Œä¸å†è´´ä¸Šä»£ç ã€‚</p><h3 id="MNNPackC4ForMatMul-Aå‡½æ•°é‡æ’AçŸ©é˜µ"><code>MNNPackC4ForMatMul_A</code>å‡½æ•°é‡æ’<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>çŸ©é˜µ</h3><p><img src="/2021/11/18/AI-Algorithm-7-StrassenInMnn/5.png" alt="5"></p><p>å°†å•ä¸ªC4é€šé“çš„24ä¸ª<code>C4 Pack</code>æ•°æ®æ‰§è¡Œé€šé“åˆ†ç¦»ï¼Œå±äºåŒä¸€ä¸ªè¾“å…¥é€šé“çš„24ä¸ªå€¼æ’åœ¨ä¸€èµ·ã€‚ä¸¤ä¸ªC4é€šé“ï¼ˆ8ä¸ªè¾“å…¥é€šé“ï¼‰å¤„ç†å®Œçš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼ˆ<code>24 x 8</code>ï¼‰ï¼š</p><p><img src="/2021/11/18/AI-Algorithm-7-StrassenInMnn/6.png" alt="6"></p><h3 id="MNNPackedMatMul-çŸ©é˜µä¹˜åŠ ">MNNPackedMatMul çŸ©é˜µä¹˜åŠ </h3><p>ä¸ºäº†è§£é‡Šèµ·æ¥æ›´ç®€å•ï¼Œä»ä¸Šé¢æƒé‡å›¾ä¸­<strong>æ‹¿1ä¸ª<code>8 x C4 Pack</code>ï¼ˆå³ï¼š4ä¸ªå·ç§¯æ ¸ï¼‰æ¥</strong>ï¼Œè‡³äºæ‰€æœ‰çš„4ä¸ª<code>8 x C4 Pack</code>ï¼ˆå³ï¼š16ä¸ªå·ç§¯æ ¸ï¼‰å·ç§¯æ ¸å¾ªç¯4æ¬¡å¤„ç†å³å¯ã€‚å–å‡ºæ¥çš„<code>Mul+Add</code>è¿ç®—å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/11/18/AI-Algorithm-7-StrassenInMnn/7.png" alt="7"></p><p>ä¸Šå›¾ä¸­çš„è®¡ç®—æµç¨‹å½’çº³ä¸€ä¸‹ï¼š</p><ul><li><ol><li><code>MUL</code>æ“ä½œæ—¶ï¼Œä»¥ä¸Šå›¾ä¸­ä¸¤ä¸ªé»‘è‰²æ¡†ä¸ºè®¡ç®—å•å…ƒã€‚è¾“å…¥çš„é»‘è‰²æ¡†ä¸­æ¯æ¬¡å–ä¸€ä¸ªå€¼å‡ºæ¥ï¼Œä¸æƒé‡ç¬¬ä¸€è¡Œé»‘è‰²æ¡†ä¸­4ä¸ªå€¼ä¾æ¬¡ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœpackåˆ°ä¸€èµ·ï¼Œç›´åˆ°24ä¸ªå€¼å…¨éƒ¨è®¡ç®—å®Œæˆï¼Œè¾“å‡ºä¸€è¡Œ<code>24 (x 4)</code>ã€‚</li></ol></li><li><ol start="2"><li>è¾“å…¥æ›´æ–°åˆ°ä¸‹ä¸€ä¸ªé€šé“24ä¸ªå€¼ï¼Œæƒé‡ä¹Ÿä¸‹ç§»ä¸€è¡Œï¼Œé‡å¤8æ¬¡ä¸Šè¿°è¿ç®—ã€‚å¾—åˆ°<code>8 x 24 (x 4)</code>ã€‚</li></ol></li><li><ol start="3"><li>å°†8è¡Œæ•°æ®å¯¹åº”ä½ç½®ç´¯åŠ (å³ï¼šåŒä¸€ä¸ªå·ç§¯æ ¸çš„ä¸åŒé€šé“ç´¯åŠ )ï¼Œå¾—åˆ°24ä¸ªç‚¹ä¸€ä¸ª<code>C4 Pack</code>çš„å·ç§¯ç»“æœï¼š<code>24 (x 4)</code>ã€‚</li></ol></li><li><ol start="4"><li>å·ç§¯æ ¸æœ‰16ä¸ªï¼Œå³ï¼š4ä¸ª<code>8 x C4 Pack</code>ï¼Œå¾ªç¯4æ¬¡ï¼Œå°†æ‰€æœ‰å·ç§¯æ ¸å¤„ç†å®Œï¼Œå¾—åˆ°24ä¸ªç‚¹æ‰€æœ‰å·ç§¯æ ¸çš„å·ç§¯ç»“æœï¼š<code>24 (x 4)</code></li></ol></li></ul><p>è‡³æ­¤ï¼Œå°±å®Œæˆäº†ä¸€ç»„<code>unit</code>çš„å·ç§¯æ“ä½œï¼Œå¾—åˆ°è¾“å‡º<code>4 x 24 (x 4)</code>ã€‚å¤„ç†å®Œæ‰€æœ‰çš„<code>unit</code>ä¹‹åï¼Œå°±å®Œæˆ<code>1 x 1</code>çš„å·ç§¯æ“ä½œã€‚</p><h1>poståå¤„ç†</h1><h2 id="æ™®é€šå·ç§¯çš„åå¤„ç†">æ™®é€šå·ç§¯çš„åå¤„ç†</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _AVX_MNNPackedMatMulFMA(<span class="keyword">float</span>* C, <span class="keyword">const</span> <span class="keyword">float</span>* A, <span class="keyword">const</span> <span class="keyword">float</span>* B, <span class="keyword">const</span> <span class="keyword">size_t</span>* parameter,</span><br><span class="line">                             <span class="keyword">const</span> <span class="keyword">float</span>* postParameters, <span class="keyword">const</span> <span class="keyword">float</span>* bias) &#123;</span><br><span class="line">    <span class="keyword">auto</span> h       = parameter[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">auto</span> cStride = parameter[<span class="number">3</span>] / <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">float</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> MNN_X86_USE_ASM</span></span><br><span class="line">    <span class="keyword">if</span> (postParameters == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        _AVX_MNNGemmFloatUnitMainFMA(C, A, B, parameter);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _AVX_MNNGemmFloatUnitMainFMA_Fused(C, A, B, parameter, postParameters, bias);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> hC4          = <span class="built_in">UP_DIV</span>(h, <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">auto</span> hC8          = hC4 / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">auto</span> hR           = hC4 % <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (hR &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">auto</span> zero = _mm_set1_ps(<span class="number">0.0f</span>);</span><br><span class="line">        <span class="comment">// Set Last H4 = 0</span></span><br><span class="line">        <span class="keyword">auto</span> dst = C + hC8 * cStride;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; MNN_UNIT_E; ++x) &#123;</span><br><span class="line">            _mm_storeu_ps(dst + <span class="number">8</span> * x + <span class="number">4</span>, zero);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    _AVX_MNNPackedMatMul_Main(C, A, B, parameter);</span><br><span class="line">    <span class="built_in">AVX2GemmPostTreat</span>(C, MNN_UNIT_E, parameter, postParameters, bias);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>MNNPackedMatMul</code>åï¼Œè°ƒç”¨GemmPostTreatè¿›è¡Œåå¤„ç†ã€‚</p><h2 id="é€’å½’è¿‡ç¨‹ä¸­çš„åå¤„ç†">é€’å½’è¿‡ç¨‹ä¸­çš„åå¤„ç†</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!postParameters.<span class="built_in">empty</span>() &amp;&amp; COT.stackIndex &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span> == numberThread) &#123;</span><br><span class="line">        <span class="keyword">auto</span> postFunction = [c11, COT, eSub, cHeight, numberThread, postParameters, core, <span class="keyword">this</span>](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">            <span class="keyword">auto</span> biasPtr = (<span class="keyword">const</span> <span class="keyword">float</span>*)(mStack[COT.stackIndex] + COT.offsetBytes);</span><br><span class="line">            <span class="keyword">auto</span> width = eSub * <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">auto</span> height = cHeight * <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">auto</span> c11Ptr = mStack[c11.stackIndex] + c11.offsetBytes;</span><br><span class="line">            core-&gt;<span class="built_in">MNNAxByClampBroadcastUnit</span>((<span class="keyword">float</span>*)c11Ptr, (<span class="keyword">float</span>*)c11Ptr, biasPtr, width, c11.lineStrideBytes / core-&gt;bytes, c11.lineStrideBytes / core-&gt;bytes, height, postParameters.<span class="built_in">data</span>());</span><br><span class="line">        &#125;;</span><br><span class="line">        mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(postFunction, numberThread));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">auto</span> postFunction = [c11, COT, eSub, cHeight, numberThread, postParameters, core, <span class="keyword">this</span>](<span class="keyword">int</span> tId) &#123;</span><br><span class="line">            <span class="keyword">auto</span> width = eSub * <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">auto</span> height = cHeight * <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">auto</span> c11Ptr = mStack[c11.stackIndex] + c11.offsetBytes;</span><br><span class="line">            <span class="keyword">auto</span> biasPtr = mStack[COT.stackIndex] + COT.offsetBytes;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> y = tId; y &lt; height; y+=numberThread) &#123;</span><br><span class="line">                core-&gt;<span class="built_in">MNNAxByClampBroadcastUnit</span>((<span class="keyword">float</span>*)(c11Ptr + y * c11.lineStrideBytes), (<span class="keyword">float</span>*)(c11Ptr + y * c11.lineStrideBytes), (<span class="keyword">const</span> <span class="keyword">float</span>*)(biasPtr + y * core-&gt;bytes * core-&gt;pack), width, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, postParameters.<span class="built_in">data</span>());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        mFunctions.<span class="built_in">emplace_back</span>(std::<span class="built_in">make_pair</span>(postFunction, numberThread));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºé€’å½’è¿‡ç¨‹æ„å»ºä¸­å­çŸ©é˜µçš„ä¹˜æ³•è°ƒç”¨<code>_generateMatMul</code>æ—¶ä¼ å…¥çš„<code>COT</code>å’Œ<code>postParameters</code>å‡ä¸ºç©ºï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> code = _generateMatMul(eSub, lSub, hSub, X, Y, c21, Empty, currentDepth, &#123;&#125;);</span><br></pre></td></tr></table></figure><p>æ•…å®é™…ä¸Šï¼Œé™¤äº†é€’å½’é¡¶å±‚å¤–ï¼Œå…¶ä»–é€’å½’å±‚æ¬¡ï¼ˆåŒ…æ‹¬æ™®é€šå·ç§¯å±‚ï¼‰å‡ä¸ä¼šæ‰§è¡Œåå¤„ç†æ“ä½œã€‚å½“ç„¶ï¼Œå¦‚æœæ™®é€šå·ç§¯å°±æ˜¯é¡¶å±‚ï¼ˆå³æ²¡æœ‰é€’å½’è¿‡ç¨‹ï¼‰ï¼Œé‚£åå¤„ç†ç”±æ™®é€šå·ç§¯è´Ÿè´£å®Œæˆã€‚</p><h1>onExecute</h1><p>é€šè¿‡<code>mFunctions</code>é˜Ÿåˆ—ä¾æ¬¡æ‰§è¡Œ<code>onResize</code>ä¸­æ„å»ºçš„Strassené€’å½’æ“ä½œã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">StrassenMatrixComputor::onExecute</span><span class="params">(<span class="keyword">const</span> <span class="keyword">uint8_t</span>* AT, <span class="keyword">const</span> <span class="keyword">uint8_t</span>* BT, <span class="keyword">const</span> <span class="keyword">uint8_t</span>* COT, <span class="keyword">uint8_t</span>* CT)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> != AT) &#123;</span><br><span class="line">        mStack[<span class="number">0</span>] = (<span class="keyword">uint8_t</span>*)AT;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> != BT) &#123;</span><br><span class="line">        mStack[<span class="number">1</span>] = (<span class="keyword">uint8_t</span>*)BT;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> != CT) &#123;</span><br><span class="line">        mStack[<span class="number">2</span>] = (<span class="keyword">uint8_t</span>*)CT;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">nullptr</span> != COT) &#123;</span><br><span class="line">        mStack[<span class="number">3</span>] = (<span class="keyword">uint8_t</span>*)COT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// All is done in onResize, just execute it</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; f : mFunctions) &#123;</span><br><span class="line">        <span class="built_in">MNN_CONCURRENCY_BEGIN</span>(tId, f.second) &#123;</span><br><span class="line">            f.<span class="built_in">first</span>(tId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">MNN_CONCURRENCY_END</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>å›°æƒ‘</h1><blockquote><p>å®é™…ä¸Šï¼Œåœ¨ä¸Šè¿°å°ºå¯¸æ¡ä»¶ä¸‹ï¼ŒMNNå¹¶ä¸ä¼šæ‰§è¡ŒStrassené€’å½’æ“ä½œï¼Œè€Œæ˜¯ç›´æ¥æ‰§è¡Œæ™®é€šå·ç§¯ã€‚å› ä¸ºStrassenè™½ç„¶å¤„ç†çš„æ•°æ®è§„æ¨¡è¶Šå¤§ï¼Œä¹˜åŠ è®¡ç®—ä¸Šè¶Šæœ‰ä¼˜åŠ¿ï¼Œä½†æ˜¯åœ¨é€’å½’è¿‡ç¨‹ä¸­è®¿å­˜æ“ä½œæ¯”æ™®é€šçŸ©é˜µä¹˜æ³•è¦å¤šçš„å¤šï¼Œå› æ­¤ä¸ºäº†é˜²æ­¢å› ä¸ºè®¿å­˜è€Œå¼•èµ·å¯èƒ½çš„è´Ÿä¼˜åŒ–ï¼ŒMNNæ¯æ¬¡é€’å½’éƒ½ä¼šå¯¹æ¯”ä¸¤è€…çš„è®¿å­˜æ¬¡æ•°ï¼Œé€‰æ‹©è®¿å­˜æ¬¡æ•°æ›´å°‘çš„æ–¹æ³•è®¡ç®—ï¼ˆå³ä¸Šé¢çš„ç»ˆæ­¢æ¡ä»¶2ï¼‰ã€‚</p></blockquote><p>MNNæºç ä¸­costä¹‹å·®æ˜¯è¿™æ ·ç®—çš„ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">float</span> AComputeCost = <span class="number">4</span> * ((<span class="keyword">float</span>)eSub * lSub);</span><br><span class="line"><span class="keyword">float</span> BComputeCost = <span class="number">4</span> * (<span class="keyword">float</span>)lSub * bHSub * hP;</span><br><span class="line"><span class="keyword">float</span> CComputeCost = <span class="number">7</span> * (<span class="keyword">float</span>)eSub * hSub;</span><br><span class="line"><span class="keyword">float</span> saveMatMulCost = (e / eP) * (aUnit * eP * hSub / core-&gt;pack + lSubUnit * eP * aUnit + lSub * bHSub * hP);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">float</span> penalty = core-&gt;penalty;<span class="comment">//<span class="doctag">FIXME:</span> Find beter way to set it</span></span><br><span class="line"><span class="keyword">float</span> saveCost = saveMatMulCost - (AComputeCost + BComputeCost + CComputeCost) * penalty;</span><br><span class="line"><span class="keyword">if</span> (saveCost &lt;= <span class="number">0.0f</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> _generateBasicMatMul(e, l, h, AT, BT, CT, COT, postParameters);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ–ç®€ä¸€ä¸‹å…¶å®ä¸ºï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>s</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>M</mi><mi>a</mi><mi>t</mi><mi>M</mi><mi>u</mi><mi>l</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mi>e</mi><mrow><mi>e</mi><mi>p</mi></mrow></mfrac><mo stretchy="false">(</mo><mfrac><mrow><mi>e</mi><mi>p</mi></mrow><mn>2</mn></mfrac><mo>âˆ—</mo><mi>i</mi><mi>c</mi><mo>+</mo><mfrac><mrow><mi>e</mi><mi>p</mi></mrow><mn>2</mn></mfrac><mo>âˆ—</mo><mi>o</mi><mi>c</mi><mo>+</mo><mfrac><mrow><mi>i</mi><mi>c</mi><mo>âˆ—</mo><mi>o</mi><mi>c</mi></mrow><mn>4</mn></mfrac><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi><mi>C</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>e</mi><mo>âˆ—</mo><mi>i</mi><mi>c</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>B</mi><mi>C</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>i</mi><mi>c</mi><mo>âˆ—</mo><mi>o</mi><mi>c</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>C</mi><mi>C</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mn>7</mn><mo>âˆ—</mo><mi>e</mi><mo>âˆ—</mo><mi>o</mi><mi>c</mi></mrow><mn>4</mn></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>s</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>M</mi><mi>a</mi><mi>t</mi><mi>M</mi><mi>u</mi><mi>l</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>âˆ’</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">(</mo><mi>A</mi><mi>C</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>+</mo><mi>B</mi><mi>C</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>+</mo><mi>C</mi><mi>C</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>e</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><mi>p</mi><mi>e</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}saveMatMulCost&amp;=\frac{e}{ep}(\frac{ep}{2}*ic+\frac{ep}{2}*oc+\frac{ic*oc}{4}) \\AComputeCost&amp;=e*ic \\BComputeCost&amp;=ic*oc \\CComputeCost&amp;=\frac{7*e*oc}{4} \\saveCost&amp;=saveMatMulCost-\\&amp;(AComputeCost+BComputeCost+CComputeCost)*penalty \\\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:10.8244em;vertical-align:-5.1622em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.6622em;"><span style="top:-7.6622em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.10903em;">tM</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.07153em;">lC</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span></span></span><span style="top:-5.6418em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span></span></span><span style="top:-4.1418em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span></span></span><span style="top:-2.1603em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">CC</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span></span></span><span style="top:-0.3343em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span></span></span><span style="top:1.1657em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:5.1622em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.6622em;"><span style="top:-7.6622em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">oc</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">oc</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-5.6418em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span></span></span><span style="top:-4.1418em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">oc</span></span></span><span style="top:-2.1603em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">7</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">oc</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-0.3343em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.10903em;">tM</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.07153em;">lC</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mord">âˆ’</span></span></span><span style="top:1.1657em;"><span class="pstrut" style="height:3.3365em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">BC</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">CC</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord mathnormal">na</span><span class="mord mathnormal">lt</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:5.1622em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>ä½†æ˜¯ä¸æ˜¯å¯¹äºå…¶å…·ä½“å«ä¹‰è¿˜æ˜¯å¾ˆå›°æƒ‘ï¼Œå·²åœ¨githubä¸Šæäº†<a href="https://github.com/alibaba/MNN/issues/1760">issue</a>ï¼Œç­‰å¤§ä½¬å›å¤ã€‚</p><p>æŒ‰ç…§ä¸Šè¿°costè®¡ç®—æ–¹æ³•ï¼Œåœ¨å›ºå®š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>64</mn><mo>Ã—</mo><mn>64</mn><mo separator="true">,</mo><mi>e</mi><mi>p</mi><mo>=</mo><mn>24</mn><mo separator="true">,</mo><mi>p</mi><mi>e</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>t</mi><mi>y</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">e=64Ã—64, ep=24,penalty=1.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">64</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">64</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">24</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord mathnormal">na</span><span class="mord mathnormal">lt</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1.5</span></span></span></span>çš„æƒ…å†µä¸‹ï¼Œéå†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>c</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>512</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>o</mi><mi>c</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>512</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ic\in[2,512],oc\in[2,512]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">512</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">oc</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">512</span><span class="mclose">]</span></span></span></span>ï¼Œå®æµ‹ä¸‹æ¥ä¼šç”¨åˆ°Strassençš„éƒ½æ˜¯icå’Œocå¤§äº256çš„æƒ…å†µã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TestStrassenCost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> e = <span class="number">64</span> * <span class="number">64</span>, ep = <span class="number">24</span>;</span><br><span class="line">    <span class="keyword">float</span> penalty = <span class="number">1.5</span>;</span><br><span class="line">    <span class="function">std::ofstream <span class="title">fout</span><span class="params">(<span class="string">&quot;strassen_cost.txt&quot;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> ic = <span class="number">2</span>; ic &lt;= <span class="number">512</span>; ic += <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> oc = <span class="number">2</span>; oc &lt;= <span class="number">512</span>; oc += <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> origin_cost = e / ep * (ep / <span class="number">2</span> * oc + ep / <span class="number">2</span> * ic + ic * oc / <span class="number">4</span>);</span><br><span class="line">            <span class="keyword">int</span> strassen_cost = e * ic + ic * oc + (<span class="number">7</span> * e * oc) / <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">if</span> (origin_cost - strassen_cost * penalty &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                fout &lt;&lt; <span class="string">&quot;use strassen, ic:&quot;</span> &lt;&lt; ic &lt;&lt; <span class="string">&quot;, oc: &quot;</span> &lt;&lt; oc &lt;&lt; <span class="string">&quot;, rate: &quot;</span> &lt;&lt; origin_cost / (strassen_cost * penalty) &lt;&lt; std::endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fout.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>è‡´è°¢</h1><p>æ–‡ç« ä¸»ä½“æ¡†æ¶å‚è€ƒè‡ª<a href="https://github.com/yizhaoyanbo">ä¸œå“¥</a>çš„MNNæºç è§£è¯»çš„å†…éƒ¨åˆ†äº«ï¼ŒåŠ ä¸Šäº†è‡ªå·±çš„ä¸€äº›çœ‹æ³•ã€‚æœ‰å¹¸è¢«çœ‹åˆ°çš„è¯ï¼Œå¸Œæœ›èƒ½ç»™ç‚¹ä¸ªèµ~~</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Algorithm </tag>
            
            <tag> MNN </tag>
            
            <tag> Strassen </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [6]ï¼šStrassenç®—æ³•åŸç†</title>
      <link href="/2021/11/18/AI-Algorithm-6-Strassen/"/>
      <url>/2021/11/18/AI-Algorithm-6-Strassen/</url>
      
        <content type="html"><![CDATA[<h1>å‰è¨€</h1><p>Strassenæœ€æ—©äº1968å¹´ç”±Volker Srassenå‘è¡¨äºè®ºæ–‡ã€Š<a href="http://bioinfo.ict.ac.cn/~dbu/AlgorithmCourses/Lectures/Lec5-Matrix-Multiplication-Strassen1969.pdf">Gaussian Elimination is not Optimal</a>ã€‹ï¼Œå°†çŸ©é˜µä¹˜æ³•çš„ç®—æ³•å¤æ‚åº¦é¦–æ¬¡ä»<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mtext>Â </mtext><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>8</mn><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">O(n^3),where\space log_2(8)=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ere</span><span class="mspace">Â </span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">8</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span>é™ä½åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mi mathvariant="normal">.</mi><mn>807</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mtext>Â </mtext><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mn>2.807</mn></mrow><annotation encoding="application/x-tex">O(n^2.807),where\space log_2(7)â‰ˆ2.807</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">.807</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">h</span><span class="mord mathnormal">ere</span><span class="mspace">Â </span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">7</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2.807</span></span></span></span>ã€‚åæ¥æœ‰ä¸åŒçš„æ–¹æ³•åŸºäºæ­¤ç®—æ³•è¿›è¡Œæ”¹è¿›ã€‚</p><p>MNN <code>Strassenconv1x1</code>é‡‡ç”¨çš„æ˜¯2008å¹´å‘è¡¨çš„è¿™è¾¹æ–‡ç« ä¸­çš„ç®—æ³•ã€Š<a href="https://lig-membres.imag.fr/pernet/Publications/fp05-dumas.pdf">Memory efficient scheduling of Strassen-Winogradâ€™s matrix multiplication algorithm</a>ã€‹ï¼Œä¸»è¦é’ˆå¯¹memoryè®¿é—®ä¸Šè¿›è¡Œä¼˜åŒ–ã€‚</p><h1>åŸç†</h1><h2 id="æ™®é€šçŸ©é˜µä¹˜">æ™®é€šçŸ©é˜µä¹˜</h2><p>ä»¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">C=AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ä¸ºä¾‹ï¼Œå‡è®¾<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>å‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n Ã— n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>çŸ©é˜µï¼Œåˆ™<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ä¸­æ¯ä¸ªå…ƒç´ éœ€è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¡ç®—ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mstyle scriptlevel="0" displaystyle="true"><munderover><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><msub><mi>b</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">c_{ij}=\displaystyle\sum_{k=1}^na_{ik}b_{kj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9535em;vertical-align:-1.3021em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.3021em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">kj</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>å³æ¯ä¸ªå…ƒç´ è®¡ç®—éœ€è¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>æ¬¡ä¹˜æ³•ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>æ¬¡åŠ æ³•ï¼ŒCå…±æœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>ä¸ªå…ƒç´ ï¼Œæ•…ä¸€å…±éœ€è¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">n^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>æ¬¡ä¹˜æ³•å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>n</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n^2(n-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>æ¬¡åŠ æ³•ï¼Œæ•…ç®—æ³•å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚</p><h2 id="åˆ†æ²»æ³•">åˆ†æ²»æ³•</h2><p>Strassenç®—æ³•åŸºäºåˆ†æ²»çš„æ€æƒ³ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆè€ƒè™‘ä¸€ä¸ªç®€å•çš„åˆ†æ²»ç­–ç•¥ã€‚</p><p>å‡è®¾çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>å’ŒçŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>éƒ½æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>n</mi><mo>=</mo><msup><mn>2</mn><mi>k</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">nÃ—n,(n=2^k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0991em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>çš„æ–¹é˜µï¼Œæ±‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">C=AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ï¼Œåˆ™æ¯ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">nÃ—n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>çš„çŸ©é˜µéƒ½å¯ä»¥åˆ†å‰²ä¸ºå››ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n/2) Ã—( n/2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord">/2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord">/2</span><span class="mclose">)</span></span></span></span>çš„çŸ©é˜µï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext>Â </mtext><mi>B</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext>Â </mtext><mi>C</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">A=\begin{bmatrix}A_{11} &amp; A_{12} \\A_{21} &amp; A_{22}\end{bmatrix} \spaceB=\begin{bmatrix}B_{11} &amp; B_{12} \\B_{21} &amp; B_{22}\end{bmatrix} \spaceC=\begin{bmatrix}C_{11} &amp; C_{12} \\C_{21} &amp; C_{22}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>äºæ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>A</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">C=AB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>å¯ä»¥æ”¹å†™ä¸ºï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>C</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>A</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>B</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}C_{11} &amp; C_{12} \\C_{21} &amp; C_{22}\end{bmatrix}=\begin{bmatrix}A_{11} &amp; A_{12} \\A_{21} &amp; A_{22}\end{bmatrix}\begin{bmatrix}B_{11} &amp; B_{12} \\B_{21} &amp; B_{22}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>å±•å¼€æœ‰ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>C</mi><mn>11</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><msub><mi>B</mi><mn>11</mn></msub><mo>+</mo><msub><mi>A</mi><mn>12</mn></msub><msub><mi>B</mi><mn>21</mn></msub><mspace linebreak="newline"></mspace><msub><mi>C</mi><mn>12</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><msub><mi>B</mi><mn>12</mn></msub><mo>+</mo><msub><mi>A</mi><mn>12</mn></msub><msub><mi>B</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>C</mi><mn>21</mn></msub><mo>=</mo><msub><mi>A</mi><mn>21</mn></msub><msub><mi>B</mi><mn>11</mn></msub><mo>+</mo><msub><mi>A</mi><mn>22</mn></msub><msub><mi>B</mi><mn>21</mn></msub><mspace linebreak="newline"></mspace><msub><mi>C</mi><mn>22</mn></msub><mo>=</mo><msub><mi>A</mi><mn>21</mn></msub><msub><mi>B</mi><mn>12</mn></msub><mo>+</mo><msub><mi>A</mi><mn>22</mn></msub><msub><mi>B</mi><mn>22</mn></msub></mrow><annotation encoding="application/x-tex">C_{11} = A_{11}B_{11}+A_{12}B_{21} \\C_{12} = A_{11}B_{12}+A_{12}B_{22} \\C_{21} = A_{21}B_{11}+A_{22}B_{21} \\C_{22} = A_{21}B_{12}+A_{22}B_{22}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>æ¯ä¸ªç­‰å¼éœ€è¦ä¸¤æ¬¡çŸ©é˜µä¹˜æ³•å’Œä¸€æ¬¡çŸ©é˜µåŠ æ³•ã€‚è‹¥ç”¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºä¸¤ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">nÃ—n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>çŸ©é˜µä¹‹é—´çš„ä¹˜æ³•ï¼Œåˆ™æœ‰å¦‚ä¸‹é€’å½’å¼ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>8</mn><mi>T</mi><mo stretchy="false">(</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>+</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)=8T(\frac{n}{2})+\varTheta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em;"></span><span class="mord">8</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­ï¼š</p><ul><li><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mi>T</mi><mo stretchy="false">(</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">8T(\frac{n}{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mord">8</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>è¡¨ç¤º8æ¬¡å­çŸ©é˜µä¹˜æ³•ï¼Œå­çŸ©é˜µè§„æ¨¡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mo stretchy="false">(</mo><mi>n</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n/2) Ã—( n/2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord">/2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord">/2</span><span class="mclose">)</span></span></span></span>ï¼›</li></ol></li><li><ol start="2"><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varTheta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>è¡¨ç¤º4æ¬¡å­çŸ©é˜µåŠ æ³•ä»¥åŠåˆå¹¶<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>çŸ©é˜µçš„æ—¶é—´å¤æ‚åº¦ã€‚</li></ol></li></ul><p>æ ¹æ®<a href="https://zhuanlan.zhihu.com/p/267890781">é€’å½’å¼æ±‚è§£</a>ï¼Œå¾—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mi>l</mi><mi>o</mi><msubsup><mi>g</mi><mn>2</mn><mn>8</mn></msubsup></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)=\varTheta(n^{log_2^8})=\varTheta(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2369em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.214em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œä¸æ™®é€šçŸ©é˜µä¹˜çš„æ—¶é—´å¤æ‚åº¦ç›¸åŒã€‚åˆ†æ²»æ³•å¹¶ä¸èƒ½èµ·åˆ°åŠ é€Ÿçš„æ•ˆæœã€‚</p><h2 id="åŸå§‹ç‰ˆæœ¬Strassen">åŸå§‹ç‰ˆæœ¬Strassen</h2><p>åˆ†æ²»æ³•åŒ…å«äº†8æ¬¡çŸ©é˜µç›¸ä¹˜å’Œ4æ¬¡çŸ©é˜µç›¸åŠ ï¼Œç›¸æ¯”çŸ©é˜µåŠ æ³•ï¼ŒçŸ©é˜µä¹˜æ³•æ˜¯éå¸¸æ…¢çš„ã€‚è¿™8æ¬¡çŸ©é˜µç›¸ä¹˜æ­£æ˜¯ç“¶é¢ˆçš„æ¥æºã€‚äºæ˜¯æˆ‘ä»¬æƒ³åˆ°èƒ½ä¸èƒ½å‡å°‘çŸ©é˜µç›¸ä¹˜çš„æ¬¡æ•°ï¼Œå“ªæ€•ä»£ä»·æ˜¯æ›´å¤šçš„çŸ©é˜µç›¸åŠ ã€‚Strassenæ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ã€‚</p><ul><li><ol><li>åŒæ ·è¿˜æ˜¯æ¯ä¸ªçŸ©é˜µåˆ†æˆ4ä»½ï¼Œç„¶ååˆ›å»ºå¦‚ä¸‹10ä¸ªä¸­é—´çŸ©é˜µï¼ˆ10æ¬¡çŸ©é˜µåŠ æ³•<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mo>Ã—</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo>Ã—</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">10Ã—\frac{n}{2}Ã—\frac{n}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">10</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varTheta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼‰ï¼š</li></ol></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>S</mi><mn>1</mn></msub><mo>=</mo><msub><mi>B</mi><mn>12</mn></msub><mo>âˆ’</mo><msub><mi>B</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><mo>+</mo><msub><mi>A</mi><mn>12</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>3</mn></msub><mo>=</mo><msub><mi>A</mi><mn>21</mn></msub><mo>+</mo><msub><mi>A</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>4</mn></msub><mo>=</mo><msub><mi>B</mi><mn>21</mn></msub><mo>âˆ’</mo><msub><mi>B</mi><mn>11</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>5</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><mo>+</mo><msub><mi>A</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>6</mn></msub><mo>=</mo><msub><mi>B</mi><mn>11</mn></msub><mo>+</mo><msub><mi>B</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>7</mn></msub><mo>=</mo><msub><mi>A</mi><mn>12</mn></msub><mo>âˆ’</mo><msub><mi>A</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>8</mn></msub><mo>=</mo><msub><mi>B</mi><mn>21</mn></msub><mo>+</mo><msub><mi>B</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>9</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><mo>âˆ’</mo><msub><mi>A</mi><mn>21</mn></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mn>10</mn></msub><mo>=</mo><msub><mi>B</mi><mn>11</mn></msub><mo>+</mo><msub><mi>B</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">S_1=B_{12}-B_{22} \\S_2=A_{11}+A_{12} \\S_3=A_{21}+A_{22} \\S_4=B_{21}-B_{11} \\S_5=A_{11}+A_{22} \\S_6=B_{11}+B_{22} \\S_7=A_{12}-A_{22} \\S_8=B_{21}+B_{22} \\S_9=A_{11}-A_{21} \\S_{10}=B_{11}+B_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><ol start="2"><li>è€Œåæ˜¯æ‰§è¡Œ7æ¬¡çŸ©é˜µä¹˜æ³•ï¼ˆæ—¶é—´å¤æ‚åº¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7</mn><mi>T</mi><mo stretchy="false">(</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>=</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mi>l</mi><mi>o</mi><msubsup><mi>g</mi><mn>2</mn><mn>7</mn></msubsup></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2.807</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">7T(\frac{n}{2})=\varTheta(n^{log_2^7})=\varTheta(n^{2.807})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mord">7</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2369em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.214em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2.807</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼‰ï¼š</li></ol></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><msub><mi>S</mi><mn>1</mn></msub><mspace linebreak="newline"></mspace><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><msub><mi>S</mi><mn>2</mn></msub><msub><mi>B</mi><mn>22</mn></msub><mspace linebreak="newline"></mspace><msub><mi>P</mi><mn>3</mn></msub><mo>=</mo><msub><mi>S</mi><mn>3</mn></msub><msub><mi>B</mi><mn>11</mn></msub><mspace linebreak="newline"></mspace><msub><mi>P</mi><mn>4</mn></msub><mo>=</mo><msub><mi>A</mi><mn>22</mn></msub><msub><mi>S</mi><mn>4</mn></msub><mspace linebreak="newline"></mspace><msub><mi>p</mi><mn>5</mn></msub><mo>=</mo><msub><mi>S</mi><mn>5</mn></msub><msub><mi>S</mi><mn>6</mn></msub><mspace linebreak="newline"></mspace><msub><mi>P</mi><mn>6</mn></msub><mo>=</mo><msub><mi>S</mi><mn>7</mn></msub><msub><mi>S</mi><mn>8</mn></msub><mspace linebreak="newline"></mspace><msub><mi>P</mi><mn>7</mn></msub><mo>=</mo><msub><mi>S</mi><mn>9</mn></msub><msub><mi>S</mi><mn>10</mn></msub></mrow><annotation encoding="application/x-tex">P_1=A_{11}S_1 \\P_2=S_2B_{22} \\P_3=S_3B_{11} \\P_4=A_{22}S_4 \\p_5=S_5S_6 \\P_6=S_7S_8 \\P_7=S_9S_{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><ol start="3"><li>æœ€åé€šè¿‡è¿™7ä¸ªçŸ©é˜µè®¡ç®—å¾—åˆ°CçŸ©é˜µï¼ˆ8æ¬¡çŸ©é˜µåŠ æ³•<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>Ã—</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo>Ã—</mo><mfrac><mi>n</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">8Ã—\frac{n}{2}Ã—\frac{n}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0404em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œæ—¶é—´å¤æ‚åº¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\varTheta(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼‰ï¼š</li></ol></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>C</mi><mn>11</mn></msub><mo>=</mo><msub><mi>P</mi><mn>5</mn></msub><mo>+</mo><msub><mi>P</mi><mn>4</mn></msub><mo>âˆ’</mo><msub><mi>P</mi><mn>2</mn></msub><mo>+</mo><msub><mi>P</mi><mn>6</mn></msub><mspace linebreak="newline"></mspace><msub><mi>C</mi><mn>12</mn></msub><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>+</mo><msub><mi>P</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><msub><mi>C</mi><mn>21</mn></msub><mo>=</mo><msub><mi>P</mi><mn>3</mn></msub><mo>+</mo><msub><mi>P</mi><mn>4</mn></msub><mspace linebreak="newline"></mspace><msub><mi>C</mi><mn>22</mn></msub><mo>=</mo><msub><mi>P</mi><mn>5</mn></msub><mo>+</mo><msub><mi>P</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>P</mi><mn>3</mn></msub><mo>âˆ’</mo><msub><mi>P</mi><mn>7</mn></msub></mrow><annotation encoding="application/x-tex">C_{11}=P_5+P_4-P_2+P_6 \\C_{12}=P_1+P_2 \\C_{21}=P_3+P_4 \\C_{22}=P_5+P_1-P_3-P_7</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>ç»¼åˆå¯å¾—å¦‚ä¸‹é€’å½’å¼ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>Î˜</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ </mtext><mi>n</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>7</mn><mi>T</mi><mo stretchy="false">(</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo stretchy="false">)</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>ifÂ </mtext><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">T(n)=\begin{cases}   \varTheta(1) &amp;\text{if } n=1 \\   7T(\frac{n}{2})\varTheta(n^2) &amp;\text{if } n&gt;1\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3em;vertical-align:-1.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">7</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6954em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">ifÂ </span></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>è¿›è€Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mi>l</mi><mi>o</mi><msubsup><mi>g</mi><mn>2</mn><mn>7</mn></msubsup></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>Î˜</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2.807</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(n)=\varTheta(n^{log_2^7})=\varTheta(n^{2.807})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2369em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.214em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathit">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2.807</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><h2 id="æ”¹è¿›ç‰ˆæœ¬Strassen">æ”¹è¿›ç‰ˆæœ¬Strassen</h2><ul><li><ol><li>8æ¬¡çŸ©é˜µåŠ æ³•ï¼š</li></ol></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>S</mi><mn>1</mn></msub><mo>=</mo><msub><mi>A</mi><mn>21</mn></msub><mo>+</mo><msub><mi>A</mi><mn>22</mn></msub><mspace width="1em"><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><msub><mi>B</mi><mn>12</mn></msub><mo>âˆ’</mo><msub><mi>B</mi><mn>11</mn></msub></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>S</mi><mn>2</mn></msub><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>A</mi><mn>11</mn></msub><mspace width="1em"><mspace width="0.5em"><msub><mi>T</mi><mn>2</mn></msub><mo>=</mo><msub><mi>B</mi><mn>22</mn></msub><mo>âˆ’</mo><msub><mi>T</mi><mn>1</mn></msub></mspace></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>S</mi><mn>3</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><mo>âˆ’</mo><msub><mi>A</mi><mn>21</mn></msub><mspace width="1em"><msub><mi>T</mi><mn>3</mn></msub><mo>=</mo><msub><mi>B</mi><mn>22</mn></msub><mo>âˆ’</mo><msub><mi>B</mi><mn>12</mn></msub></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>S</mi><mn>4</mn></msub><mo>=</mo><msub><mi>A</mi><mn>12</mn></msub><mo>âˆ’</mo><msub><mi>S</mi><mn>2</mn></msub><mspace width="1em"><mspace width="0.5em"><msub><mi>T</mi><mn>4</mn></msub><mo>=</mo><msub><mi>T</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>B</mi><mn>21</mn></msub></mspace></mspace></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}&amp; S_1=A_{21}+A_{22} \quad T_1=B_{12}-B_{11} \\&amp; S_2=S_1-A_{11} \quad\enspace T_2=B_{22}-T_1 \\&amp; S_3=A_{11}-A_{21} \quad T_3=B_{22}-B_{12} \\&amp; S_4=A_{12}-S_2 \quad\enspace T_4=T_2-B_{21}\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-0.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.5em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><ol start="2"><li>7æ¬¡çŸ©é˜µä¹˜æ³•ï¼š</li></ol></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><msub><mi>A</mi><mn>11</mn></msub><msub><mi>B</mi><mn>11</mn></msub><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>P</mi><mn>5</mn></msub><mo>=</mo><msub><mi>S</mi><mn>1</mn></msub><msub><mi>T</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>P</mi><mn>2</mn></msub><mo>=</mo><msub><mi>A</mi><mn>12</mn></msub><msub><mi>B</mi><mn>21</mn></msub><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>P</mi><mn>6</mn></msub><mo>=</mo><msub><mi>S</mi><mn>2</mn></msub><msub><mi>T</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>P</mi><mn>3</mn></msub><mo>=</mo><msub><mi>S</mi><mn>4</mn></msub><msub><mi>B</mi><mn>22</mn></msub><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>P</mi><mn>7</mn></msub><mo>=</mo><msub><mi>S</mi><mn>3</mn></msub><msub><mi>T</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>P</mi><mn>4</mn></msub><mo>=</mo><msub><mi>A</mi><mn>22</mn></msub><msub><mi>T</mi><mn>4</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}&amp; P_1=A_{11}B_{11} \quad &amp; P_5=S_1T_1 \\&amp; P_2=A_{12}B_{21} \quad &amp; P_6=S_2T_2 \\&amp; P_3=S_4B_{22} \quad &amp; P_7=S_3T_3 \\&amp; P_4=A_{22}T_4\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-0.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.25em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><ol start="3"><li>7æ¬¡çŸ©é˜µåŠ æ³•ï¼š</li></ol></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>U</mi><mn>1</mn></msub><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>+</mo><msub><mi>P</mi><mn>2</mn></msub><mspace width="1em"><msub><mi>U</mi><mn>5</mn></msub><mo>=</mo><msub><mi>U</mi><mn>4</mn></msub><mo>+</mo><msub><mi>P</mi><mn>3</mn></msub></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>U</mi><mn>2</mn></msub><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub><mo>+</mo><msub><mi>P</mi><mn>6</mn></msub><mspace width="1em"><msub><mi>U</mi><mn>6</mn></msub><mo>=</mo><msub><mi>U</mi><mn>3</mn></msub><mo>âˆ’</mo><msub><mi>P</mi><mn>4</mn></msub></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>U</mi><mn>3</mn></msub><mo>=</mo><msub><mi>U</mi><mn>2</mn></msub><mo>+</mo><msub><mi>P</mi><mn>7</mn></msub><mspace width="1em"><msub><mi>U</mi><mn>7</mn></msub><mo>=</mo><msub><mi>U</mi><mn>3</mn></msub><mo>+</mo><msub><mi>P</mi><mn>5</mn></msub></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>U</mi><mn>4</mn></msub><mo>=</mo><msub><mi>U</mi><mn>2</mn></msub><mo>+</mo><msub><mi>P</mi><mn>5</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}&amp;U_1=P_1+P_2 \quad U_5=U_4+P_3 \\&amp;U_2=P_1+P_6 \quad U_6=U_3-P_4 \\&amp;U_3=U_2+P_7 \quad U_7=U_3+P_5 \\&amp;U_4=U_2+P_5\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-0.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><ol start="4"><li>æœ€ç»ˆç»“æœï¼š</li></ol></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>C</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>U</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>U</mi><mn>5</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>U</mi><mn>6</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>U</mi><mn>7</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">C=\begin{bmatrix}U_1 &amp; U_5 \\U_6 &amp; U_7\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>æ”¹è¿›ç‰ˆæœ¬çš„<code>Strassen</code>ç›¸æ¯”åŸå§‹ç‰ˆæœ¬çŸ©é˜µåŠ æ³•æ¬¡æ•°ç”±18æ¬¡é™ä½åˆ°15æ¬¡ã€‚åŒæ—¶è¯¥ç®—æ³•åŒæ—¶åˆ†æå„ä¸­é—´çŸ©é˜µå—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå……åˆ†è€ƒè™‘åˆ°äº†è®¡ç®—ä¸­çš„å†…å­˜å¤ç”¨ï¼Œæ¯æ¬¡é€’å½’åªéœ€è¦åŠ¨æ€åˆ†é…ä¸¤å—ä¸´æ—¶å†…å­˜<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">X_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">X_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å³å¯ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>11</mn></msub></mrow><annotation encoding="application/x-tex">C_{11}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>12</mn></msub></mrow><annotation encoding="application/x-tex">C_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">12</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>21</mn></msub></mrow><annotation encoding="application/x-tex">C_{21}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">21</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>22</mn></msub></mrow><annotation encoding="application/x-tex">C_{22}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">22</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>éƒ½å¯ä»¥åœ¨è®¡ç®—ä¸­å¤ç”¨ã€‚</p><p>è®¡ç®—æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><img src="/2021/11/18/AI-Algorithm-6-Strassen/1.png" alt="1" style="zoom:67%;"><p>è®¡ç®—æµç¨‹è¡¨å¦‚ä¸‹ï¼š</p><img src="/2021/11/18/AI-Algorithm-6-Strassen/2.png" alt="2" style="zoom:50%;"><h1>æ€»ç»“</h1><p><code>Strassen</code>ä¼˜åŒ–åŸç†æ˜¯å‡å°‘çŸ©é˜µä¹˜æ³•ï¼Œé¢å¤–å¢åŠ çš„æ˜¯æ›´å¤šçŸ©é˜µåŠ æ³•ï¼ŒçŸ©é˜µä¹˜æ³•çš„æ—¶é—´å¤æ‚åº¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œè€ŒçŸ©é˜µåŠ æ³•çš„å¤æ‚åº¦æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ã€‚æ€»ä½“ä¸Šä¹˜åŠ è¿ç®—æ¬¡æ•°æ˜¯å‡å°‘çš„ï¼Œæ¥è¾¾åˆ°åŠ é€Ÿç›®çš„ã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº†æ™®é€šçŸ©é˜µä¹˜æ³•å’Œ<code>Strassen</code>ç®—æ³•çš„æ€§èƒ½å·®å¼‚ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>è¶Šå¤§ï¼Œ<code>Strassen</code>ç®—æ³•èŠ‚çº¦çš„æ—¶é—´è¶Šå¤šã€‚</p><img src="/2021/11/18/AI-Algorithm-6-Strassen/3.jpg" alt="3" style="zoom:150%;"><p>å®é™…ä½¿ç”¨ä¸­ï¼Œè€ƒè™‘åˆ°æ¯æ¬¡é€’å½’è®¡ç®—åˆ†å—çŸ©é˜µçš„è®¿å­˜é—®é¢˜ï¼Œä¼šä¸æ™®é€šçŸ©é˜µä¹˜æ³•çš„åšä¸€ä¸ªcostæ¯”è¾ƒï¼Œæ»¡è¶³ä¸€å®šæ¡ä»¶ä¸‹åˆ‡æ¢åˆ°æ™®é€šçŸ©é˜µä¹˜æ³•ï¼Œç»ˆæ­¢é€’å½’ã€‚</p><h1>å‚è€ƒ</h1><ul><li><ol><li><a href="https://zhuanlan.zhihu.com/p/268392799">çŸ©é˜µä¹˜æ³•Strassenç®—æ³•</a></li></ol></li></ul><h1>è‡´è°¢</h1><p>æ–‡ç« ä¸»ä½“æ¡†æ¶å‚è€ƒè‡ª<a href="https://github.com/yizhaoyanbo">ä¸œå“¥</a>çš„MNNæºç è§£è¯»çš„å†…éƒ¨åˆ†äº«ï¼ŒåŠ ä¸Šäº†è‡ªå·±çš„ä¸€äº›çœ‹æ³•ã€‚æœ‰å¹¸è¢«çœ‹åˆ°çš„è¯ï¼Œå¸Œæœ›èƒ½ç»™ç‚¹ä¸ªèµ~~</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Strassen </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [5]ï¼šMNNä¸­çš„Winogradå®ç°</title>
      <link href="/2021/11/16/AI-Algorithm-5-WinogradInMnn/"/>
      <url>/2021/11/16/AI-Algorithm-5-WinogradInMnn/</url>
      
        <content type="html"><![CDATA[<h1>å‰è¨€</h1><p>ä¸»è¦é’ˆå¯¹CPUåç«¯ï¼ŒåŸºäº<mnnrootdir>/source/backend/cpu/compute/ConvolutionWinograd.cppæºç å±•å¼€ã€‚</mnnrootdir></p><p>éƒ¨åˆ†ç« èŠ‚ä»¥è¾“å…¥å¤§å°ï¼š<code>1 x 8 x 224 x 224</code>ï¼Œæƒé‡å¤§å°: <code>16 x 8 x 3 x 3</code>, è¾“å‡º<code>1 x 16 x 222 x 222</code> ä¸ºä¾‹è¿›è¡Œè¾…åŠ©è¯´æ˜ã€‚</p><p>MNNå·ç§¯ç›¸å…³è¿ç®—ç»Ÿä¸€ä½¿ç”¨CAFFE_C4æ ¼å¼ï¼Œå³MNNè‡ªåˆ›çš„NC4HW4æ ¼å¼ï¼Œå…·ä½“æ’å¸ƒä»‹ç»ï¼š<a href="https://no5-aaron-wu.github.io/2021/11/14/AI-Algorithm-2-NC4HW4/">NC4HW4æ•°æ®æ’å¸ƒ</a></p><h1>Winogradé€‚ç”¨æ¡ä»¶</h1><p><code>canUseWinograd</code>å‡½æ•°ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ConvolutionWinograd::canUseWinograd</span><span class="params">(<span class="keyword">const</span> Convolution2DCommon *common)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (common-&gt;<span class="built_in">kernelY</span>() != common-&gt;<span class="built_in">kernelX</span>() || common-&gt;<span class="built_in">kernelY</span>() &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (common-&gt;<span class="built_in">dilateX</span>() != <span class="number">1</span> || common-&gt;<span class="built_in">dilateY</span>() != <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (common-&gt;<span class="built_in">strideX</span>() != <span class="number">1</span> || common-&gt;<span class="built_in">strideY</span>() != <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“å‡ºæ¥å°±æ˜¯:</p><ul><li><ol><li>å¿…é¡»æ˜¯<code>kernelX = kernelY</code>çš„å·ç§¯æ ¸ï¼Œå¹¶ä¸”å·ç§¯æ ¸å°ºå¯¸å¤§äº<code>1x1</code>ã€‚<code>1x1</code>çš„å·ç§¯æ ¸MNNä½¿ç”¨çš„æ˜¯<strong>Convolution1x1Strassen</strong>å®ç°ï¼Œæš‚ä¸”æŒ‰ä¸‹ä¸è¡¨ã€‚</li></ol></li><li><ol start="2"><li>ä¸é€‚ç”¨äº<code>dilateConv</code>ã€‚</li></ol></li><li><ol start="3"><li>ä¸é€‚ç”¨äº<code>stride != 1</code>çš„convã€‚</li></ol></li></ul><h1>é€‰å–æœ€ä½³çš„Unit</h1><p><code>bestWinogradUnit</code>å‡½æ•°ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ConvolutionWinograd::bestWinogradUnit</span><span class="params">(<span class="keyword">const</span> Convolution2DCommon *common, <span class="keyword">const</span> Tensor *inputTensor,</span></span></span><br><span class="line"><span class="params"><span class="function">                                          <span class="keyword">const</span> Tensor *outputTensor, <span class="keyword">int</span> threadNumber, Backend* b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> core = <span class="keyword">static_cast</span>&lt;CPUBackend*&gt;(b)-&gt;<span class="built_in">functions</span>();</span><br><span class="line">    <span class="keyword">int</span> ow      = outputTensor-&gt;<span class="built_in">width</span>();</span><br><span class="line">    <span class="keyword">int</span> oh      = outputTensor-&gt;<span class="built_in">height</span>();</span><br><span class="line">    <span class="keyword">int</span> oc      = outputTensor-&gt;<span class="built_in">channel</span>();</span><br><span class="line">    <span class="keyword">int</span> ePack, hPack, lPack;</span><br><span class="line">    core-&gt;<span class="built_in">MNNGetMatMulPackMode</span>(&amp;ePack, &amp;lPack, &amp;hPack);</span><br><span class="line">    <span class="keyword">int</span> unit2   = <span class="built_in">UP_DIV</span>(ow * oh, ePack * threadNumber);</span><br><span class="line">    <span class="keyword">int</span> maxUnit = (<span class="keyword">int</span>)::<span class="built_in">sqrtf</span>((<span class="keyword">float</span>)unit2);</span><br><span class="line">    maxUnit     = std::<span class="built_in">min</span>(maxUnit, CONVOLUTION_WINOGRAD_MAX_UNIT);</span><br><span class="line">    maxUnit     = std::<span class="built_in">max</span>(maxUnit, CONVOLUTION_WINOGRAD_MIN_UNIT);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ic           = inputTensor-&gt;<span class="built_in">channel</span>();</span><br><span class="line">    <span class="keyword">auto</span> kernelSize  = common-&gt;<span class="built_in">kernelY</span>();</span><br><span class="line">    <span class="keyword">int</span> unit         = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">float</span> maxRate    = <span class="number">0.0f</span>;</span><br><span class="line">    <span class="keyword">float</span> originCost = (<span class="keyword">float</span>)ow * oh * (<span class="keyword">float</span>)ic * oc * kernelSize * kernelSize;</span><br><span class="line">    std::set&lt;<span class="keyword">int</span>&gt; supportSu&#123;<span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> u = CONVOLUTION_WINOGRAD_MIN_UNIT; u &lt;= maxUnit; ++u) &#123;</span><br><span class="line">        <span class="keyword">auto</span> sui = u + kernelSize - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">auto</span> su = (<span class="keyword">float</span>)sui;</span><br><span class="line">        <span class="keyword">if</span> (supportSu.<span class="built_in">find</span>(sui) == supportSu.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">nullptr</span> == core-&gt;<span class="built_in">chooseWinoDestTransform</span>((<span class="keyword">int</span>)su, u)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*Let F(6,3) be choosed when it can speed up from F(2,3) than 0.6*/</span></span><br><span class="line">        <span class="keyword">float</span> penalty = (su * su) / (<span class="keyword">float</span>)(kernelSize * kernelSize) * <span class="number">0.12f</span>;</span><br><span class="line">        <span class="keyword">float</span> winogradCost =</span><br><span class="line">            (<span class="number">2</span> * su * su * ic + su * su * ic * oc + (su + u) * u * oc) * (<span class="built_in">UP_DIV</span>(ow, u) * <span class="built_in">UP_DIV</span>(oh, u));</span><br><span class="line">        <span class="keyword">float</span> reduceRate = originCost / winogradCost - penalty;</span><br><span class="line">        <span class="comment">// MNN_PRINT(&quot;ow=%d, oh=%d, %f, %f, winograd unit:%d\n&quot;, ow, oh, winogradCost, reduceRate, u);</span></span><br><span class="line">        <span class="keyword">if</span> (reduceRate &gt; maxRate) &#123;</span><br><span class="line">            maxRate = reduceRate;</span><br><span class="line">            unit    = u;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (maxRate &lt; <span class="number">1.0f</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> unit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><ol><li>ç»ç¡®è®¤ï¼ŒMNNä¸­è®¡ç®—Costå¹¶ä¸æ˜¯ä½¿ç”¨<code>ä¹˜åŠ æ¬¡æ•°</code>çš„åº¦é‡æ–¹å¼ï¼Œè€Œæ˜¯<code>è®¿å­˜é‡</code>çš„åº¦é‡æ–¹å¼ï¼Œå³ä¸€æ¬¡winogradè®¡ç®—ä¸­å¯¹å†…å­˜è¯»å–çš„æ¬¡æ•°ï¼›</li></ol></li><li><ol start="2"><li>ä¸Šè¿°ä»£ç çš„å¤§è‡´é€»è¾‘å°±æ˜¯éå†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>n</mi><mi>i</mi><mi>t</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>8</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">unit\in[2,8]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">u</span><span class="mord mathnormal">ni</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">8</span><span class="mclose">]</span></span></span></span>ï¼Œè®¡ç®—æ™®é€šå·ç§¯<code>originCost</code>å’Œ<code>winogradCost</code>çš„æ¯”å€¼ï¼Œå¯»æ‰¾æ¯”å€¼çš„æœ€å¤§å€¼ï¼Œæ¥ç¡®å®šæœ€ä½³unitï¼›</li></ol></li><li><ol start="3"><li>ä½†æ˜¯åœ¨è®¡ç®—è¾“å‡ºè½¬æ¢æ˜¯<code>(su + u) * u * oc</code>ï¼Œä½†æˆ‘è§‰å¾—åº”è¯¥æ˜¯<code>(su + u) * su * oc</code>æ‰å¯¹ï¼›</li></ol></li><li><ol start="4"><li>unité€‰å–å…¶å®æ˜¯ä¸ªæƒè¡¡å€¼ï¼Œåœ¨å†…å­˜è®¿é—®æ¬¡æ•°å’Œä¹˜æ³•æ¬¡æ•°ä¹‹é—´å­˜åœ¨ä¸€å®šæƒè¡¡ï¼Œunitå°çš„ä¹˜æ³•æ¬¡æ•°å°‘ï¼Œä½†æ˜¯å†…å­˜è®¿é—®æ¬¡æ•°å¤šï¼Œåä¹‹åä¹‹;</li></ol></li><li><ol start="5"><li><code>penalty</code>æ˜¯ä¸ªæƒ©ç½šå€¼ï¼Œå…·ä½“ä½œç”¨å¯ä»¥çœ‹è¿™ä¸ª<a href="https://github.com/alibaba/MNN/issues/1340">issue</a>ã€‚</li></ol></li></ul><h1>ç”Ÿæˆå˜æ¢çŸ©é˜µ</h1><p>é€šè¿‡<code>WinogradGenerater</code>ç±»å®ç°ï¼Œä¸»è¦æ ¹æ®<code>unit</code>å’Œ<code>kernelSize</code>å¤§å°è®¡ç®—ä¸‰ä¸ªè½¬æ¢çŸ©é˜µ:<code>G</code>ï¼Œ<code>A</code>ï¼Œ<code>B</code>ï¼Œæ ¹æ®<strong>ä¸­å›½ä½™æ•°å®šç†</strong>æ±‚è§£åŒä½™æ–¹ç¨‹ç»„ï¼Œè·å–å˜æ¢çŸ©é˜µã€‚æš‚ä¸”æŒ‰ä¸‹ä¸è¡¨</p><h1>æƒé‡å˜æ¢</h1><blockquote><p>ä»¥unit=6ä¸ºä¾‹</p></blockquote><p>åŸå§‹æƒé‡Tensorå¤§å°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>16</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Red}16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Red;">16</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Blue"><mn>8</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Blue}8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Blue;">8</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Green"><mn>3</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Green}3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Green;">3</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Green"><mn>3</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Green}3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Green;">3</span></span></span></span>ï¼Œæ¯ä¸ª3Ã—3 kernelå˜æ¢åTensorå¤§å°åº”ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>16</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Red}16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Red;">16</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Blue"><mn>8</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Blue}8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Blue;">8</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Green"><mn>8</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Green}8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Green;">8</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Green"><mn>8</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Green}8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Green;">8</span></span></span></span>ï¼Œç»è¿‡<code>NC4HW4</code>é‡æ’åçš„Tensorå¤§å° <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Green"><mn>64</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Green}64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Green;">64</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>4</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Red}4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Red;">4</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Blue"><mn>8</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Blue}8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Blue;">8</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Blue"><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Blue}1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Blue;">1</span></span></span></span> Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>4</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Red}4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Red;">4</span></span></span></span>ã€‚</p><p>é‡æ’åæ¯ä¸ªç»´åº¦å«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><ol><li>å˜æ¢çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>å¤§å°ä¸º <code>8 x 3</code>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>G</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">G^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ä¸º <code>3 x 8</code>ï¼Œæ ¹æ®å˜æ¢å…¬å¼ï¼Œæ¯ä¸ª<code>3 x 3</code>å·ç§¯æ ¸å˜æ¢åçš„å¤§å°ä¸º <code>8 x 8 = 64</code>ï¼Œå°†è¿™64ä¸ªå€¼æ‹†åˆ†åˆ°64ä¸ªbatchï¼ˆ<code>N</code>ç»´åº¦ï¼‰ï¼›</li></ol></li><li><ol start="2"><li>å·ç§¯æ ¸ä¸ªæ•°16æŒ‰ç…§<code>C4</code>è¿›è¡Œæ‹†åˆ†ï¼Œæ¯ä¸ª<code>C4 pack</code>æ’å¸ƒåˆ°<code>W</code>ç»´åº¦ï¼Œ<code>C</code>ç»´åº¦ä¸º4ï¼›</li></ol></li><li><ol start="3"><li>å•ä¸ªå·ç§¯æ ¸é€šé“æ•°8æ’å¸ƒåˆ°<code>H</code>ç»´åº¦ï¼›</li></ol></li></ul><p>è¿™æ ·åšçš„ç›®çš„æ˜¯ä¾¿äºåé¢<code>MatMul</code>æ—¶ï¼ŒæŒ‡ä»¤é›†å¯ä»¥ä¸€æ¬¡æ€§å¯¹<strong>åŒä¸€ä¸ªè¾“å…¥</strong>çš„<strong>4ä¸ªä¸åŒå·ç§¯æ ¸</strong>çš„<strong>å•ä¸ªé€šé“</strong>è¿›è¡Œä¹˜æ³•è®¡ç®—ã€‚åœ¨Hæ–¹å‘ç´¯åŠ å°±å¯ä»¥å®ç°<strong>åŒä¸€ä¸ªè¾“å…¥</strong>çš„<strong>ä¸åŒå·ç§¯æ ¸</strong>çš„å·ç§¯ç»“æœè¾“å‡ºã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/1.png" alt="1"></p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WinogradGenerater::transformWeight</span><span class="params">(<span class="keyword">const</span> Tensor* weightDest, <span class="keyword">const</span> Tensor* source, <span class="keyword">bool</span> ciFirst)</span> </span>&#123;</span><br><span class="line">    <span class="function">std::shared_ptr&lt;Tensor&gt; <span class="title">GT</span><span class="params">(Math::Matrix::create(mG-&gt;length(<span class="number">0</span>), mG-&gt;length(<span class="number">1</span>)))</span></span>;</span><br><span class="line">    Math::Matrix::<span class="built_in">transpose</span>(GT.<span class="built_in">get</span>(), mG.<span class="built_in">get</span>());</span><br><span class="line">    <span class="keyword">int</span> ci          = source-&gt;<span class="built_in">length</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> co          = source-&gt;<span class="built_in">length</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> kernelCount = source-&gt;<span class="built_in">length</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> unitCi      = weightDest-&gt;<span class="built_in">length</span>(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">int</span> unitCo      = weightDest-&gt;<span class="built_in">length</span>(<span class="number">4</span>);</span><br><span class="line">    <span class="keyword">auto</span> alpha      = mB-&gt;<span class="built_in">length</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ci % unitCi != <span class="number">0</span> || co % unitCo != <span class="number">0</span>) &#123;</span><br><span class="line">        ::<span class="built_in">memset</span>(weightDest-&gt;host&lt;<span class="keyword">float</span>&gt;(), <span class="number">0</span>, weightDest-&gt;<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">std::shared_ptr&lt;Tensor&gt; <span class="title">M</span><span class="params">(Math::Matrix::create(kernelCount, alpha))</span></span>;</span><br><span class="line">    <span class="function">std::shared_ptr&lt;Tensor&gt; <span class="title">K</span><span class="params">(Math::Matrix::createShape(kernelCount, kernelCount))</span></span>;</span><br><span class="line">    <span class="function">std::shared_ptr&lt;Tensor&gt; <span class="title">K_Transform</span><span class="params">(Math::Matrix::create(alpha, alpha))</span></span>;</span><br><span class="line">    <span class="keyword">auto</span> weightPtr      = source-&gt;host&lt;<span class="keyword">float</span>&gt;();</span><br><span class="line">    <span class="keyword">auto</span> KTransformData = K_Transform-&gt;host&lt;<span class="keyword">float</span>&gt;();</span><br><span class="line">    <span class="keyword">int</span> lCi = unitCo;</span><br><span class="line">    <span class="keyword">int</span> lCo = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (ciFirst) &#123;</span><br><span class="line">        lCi = <span class="number">1</span>;</span><br><span class="line">        lCo = unitCi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> oz = <span class="number">0</span>; oz &lt; co; ++oz) &#123;</span><br><span class="line">        <span class="keyword">auto</span> srcOz = weightPtr + oz * ci * kernelCount * kernelCount;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ozC4 = oz / unitCo;</span><br><span class="line">        <span class="keyword">int</span> mx   = oz % unitCo;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> dstOz = weightDest-&gt;host&lt;<span class="keyword">float</span>&gt;() + weightDest-&gt;<span class="built_in">stride</span>(<span class="number">1</span>) * ozC4 + mx * lCo;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> sz = <span class="number">0</span>; sz &lt; ci; ++sz) &#123;</span><br><span class="line">            <span class="keyword">int</span> szC4         = sz / unitCi;</span><br><span class="line">            <span class="keyword">int</span> my           = sz % unitCi;</span><br><span class="line">            <span class="keyword">auto</span> srcSz       = srcOz + kernelCount * kernelCount * sz;</span><br><span class="line">            K-&gt;<span class="built_in">buffer</span>().host = (<span class="keyword">uint8_t</span>*)srcSz;</span><br><span class="line">            <span class="comment">// M = G * K</span></span><br><span class="line">            Math::Matrix::<span class="built_in">multi</span>(M.<span class="built_in">get</span>(), mG.<span class="built_in">get</span>(), K.<span class="built_in">get</span>());</span><br><span class="line">            <span class="comment">// K_Transform = M*GT</span></span><br><span class="line">            Math::Matrix::<span class="built_in">multi</span>(K_Transform.<span class="built_in">get</span>(), M.<span class="built_in">get</span>(), GT.<span class="built_in">get</span>());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">auto</span> dstSz = dstOz + szC4 * weightDest-&gt;<span class="built_in">stride</span>(<span class="number">2</span>) + my * lCi;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; alpha * alpha; ++i) &#123;</span><br><span class="line">                *(dstSz + i * weightDest-&gt;<span class="built_in">stride</span>(<span class="number">0</span>)) = KTransformData[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>åˆ†å—å¤„ç†</h1><h2 id="å¸¸ç”¨æœ¯è¯­">å¸¸ç”¨æœ¯è¯­</h2><ul><li><ol><li><code>unit</code>ï¼šWinogradè¾“å‡ºFeatureMapçš„åˆ†å—å¤§å°ã€‚</li></ol></li></ul><blockquote><p>å‡è®¾å·ç§¯è¾“å‡ºçš„Tensorå¤§å°ä¸º: <code>1 x 16 x 222 x 222</code>ï¼Œ<code>kernel size = 3</code>ï¼Œ<code>unit = 6</code>ï¼Œåˆ™è¾“å‡ºæŒ‰ç…§<code>6 x 6</code>å¤§å°åˆ†å—è¾“å‡ºï¼Œè¾“å…¥ä¸­å°±ä½¿ç”¨<code>8 x 8</code>å¤§å°åˆ†å—ã€‚ç®€å•è¯´å°±æ˜¯åˆ©ç”¨è¾“å…¥çš„<code>8 x 8</code>å—è®¡ç®—è¾“å‡ºçš„<code>6 x 6</code>å—ã€‚é‚£ä¹ˆ<code>222 x 222</code> å°±å¯ä»¥åˆ†ä¸º <code>37 x 37</code>ä¸ªå—å¤§å°ã€‚</p></blockquote><ul><li><ol start="2"><li><code>epack</code>ï¼šåˆ†ç»„å•ä½ï¼Œå›ºå®šå€¼ï¼Œå¯¹äºä¸åŒçš„åç«¯è®¾ç½®ä¸ºä¸åŒçš„å€¼ã€‚è·å–æ–¹å¼å¦‚ä¸‹ï¼š</li></ol></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> ePack, lPack, hPack;</span><br><span class="line">core-&gt;<span class="built_in">MNNGetMatMulPackMode</span>(&amp;ePack, &amp;lPack, &amp;hPack);</span><br></pre></td></tr></table></figure><ul><li><ol start="3"><li><code>tile</code>ï¼š æŒ‰ç…§uintè¿›è¡Œåˆ†å—åï¼Œå†å¯¹æ‰€æœ‰å—è¿›è¡Œåˆ†ç»„çš„ä¸ªæ•°ã€‚</li></ol></li></ul><blockquote><p>å¦‚ä¸Šé¢<code>37 x 37</code>ä¸ªå—ï¼Œå¦‚æœ<code>epack = 24</code>ï¼Œåˆ™<code>tile =ï¼ˆ37 x 37 + 24 - 1ï¼‰/ 24 = 58</code>ã€‚ä¿è¯æ‰€æœ‰å—éƒ½èƒ½å¤„ç†åˆ°ï¼Œå› æ­¤é‡‡ç”¨å‘ä¸Šå–æ•´ã€‚</p></blockquote><h2 id="åˆ†å—åŸç†">åˆ†å—åŸç†</h2><p>åˆ†å—åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/2.png" alt="2"></p><p>åˆ†å—æµç¨‹ç¡®å®šåï¼Œå®æ“è¿‡ç¨‹å¹¶ä¸æ˜¯æŠŠæ‰€æœ‰è¾“å…¥<code>tile</code>éƒ½å¤„ç†å®Œï¼Œæ‰æ‰§è¡Œåé¢çš„ä¹˜åŠ åŠè¾“å‡ºå˜æ¢ï¼Œè¿™æ ·çš„å†…å­˜å¼€é”€å¤ªå¤§äº†ï¼Œä¸å¯å–ã€‚<br>MNNé‡‡ç”¨çš„æ˜¯ä»¥<code>tile</code>ä¸ºå•ä½è¿›è¡Œå¤„ç†ï¼Œæ¯ä¸ª<code>tile</code>è¿›è¡Œè¾“å…¥å˜æ¢ã€ä¹˜åŠ ã€è¾“å‡ºå˜æ¢ã€‚å°†ç»“æœé€ä¸ªå†™å…¥åˆ°è¾“å‡ºTensorä¸­ã€‚å¦å¤–ï¼Œç”±äº<code>tile</code>ä¹‹é—´æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œä¹Ÿæ–¹ä¾¿ä½¿ç”¨å¤šçº¿ç¨‹å¤„ç†ã€‚</p><p><code>1 x 2 x 224 x 224 x 4</code>çš„è¾“å…¥ï¼ŒæŒ‰ç…§<code>tile</code>åˆ’åˆ†åå˜å½¢ä¸º(NCHW): <code>1x 2 x 58</code> <code>x</code> <strong><code>tile</code></strong>ï¼Œè¿™å…¶ä¸­çš„2å®é™…æ˜¯è¾“å…¥é€šé“8ç»è¿‡<code>C4 Pack</code>åçš„å€¼ï¼Œåœ¨å·ç§¯è¿‡ç¨‹ä¸­æ˜¯è¦ä¸€èµ·ç´¯åŠ åˆ°è¾“å‡ºç»“æœçš„ã€‚å› æ­¤å®é™…è®¡ç®—çš„æ—¶å€™ï¼ŒæŒ‰ç…§ä¸€æ¬¡å¤„ç†tileçš„ä¸¤ä¸ªé€šé“è¿›è¡Œè®¡ç®—ã€‚ä¸€å…±å¾ªç¯å¤„ç†58æ¬¡ã€‚</p><h1>bufferåˆ†é…</h1><blockquote><p>å»¶ç»­å‰é¢ä¾‹å­çš„å°ºå¯¸æƒ…å†µ</p></blockquote><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">mTempBuffer.<span class="built_in">reset</span>(Tensor::createDevice&lt;<span class="keyword">uint8_t</span>&gt;(&#123;threadNumber, ePack, ic4 + oc4, pack * alpha2, bytes&#125;));</span><br><span class="line">mTransformMidBuffer.<span class="built_in">reset</span>(Tensor::createDevice&lt;<span class="keyword">uint8_t</span>&gt;(&#123;threadNumber, (<span class="number">1</span> + ic4 * ePack), alpha2, pack, bytes&#125;)); <span class="comment">// 1 means original small buffer of alpha2 * pack.</span></span><br><span class="line">mGemmMidBuffer.<span class="built_in">reset</span>(Tensor::createDevice&lt;<span class="keyword">uint8_t</span>&gt;(&#123;threadNumber, alpha, ePack * <span class="built_in">UP_DIV</span>(srcCount, pack) * pack, bytes&#125;));</span><br></pre></td></tr></table></figure><p>å‚æ•°çš„å…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><ol><li><code>ePack = 24</code>è¡¨ç¤ºä¸€ä¸ª<code>tile</code>æœ‰24ä¸ªå—ã€‚</li></ol></li><li><ol start="2"><li><code>ic4 = 2</code>ï¼Œ<code>oc4 = 4</code>ï¼Œåˆ†åˆ«ä»£è¡¨<code>CAFFE_C4</code>æ ¼å¼ä¸‹çš„è¾“å…¥ï¼Œè¾“å‡ºé€šé“æ•°ã€‚</li></ol></li><li><ol start="3"><li><code>pack = 4</code>è¡¨ç¤º4ä¸ªé€šé“ä¸ºä¸€ç»„packåˆ°ä¸€èµ·ã€‚</li></ol></li><li><ol start="4"><li><code>alpha2 = 8 x 8 = 64</code>ï¼Œè¡¨ç¤ºå•ä¸ªè¾“å…¥å—çš„æ•°æ®ä¸ªæ•°ã€‚</li></ol></li><li><ol start="5"><li><code>bytes=4</code>ï¼Œå¤„ç†floatç±»å‹ï¼Œ4ä¸ªå­—èŠ‚ã€‚</li></ol></li></ul><p>3ä¸ªbufferçš„æƒ…å†µå¦‚ä¸‹ï¼š</p><ul><li><ol><li><code>mTempBuffer</code>ï¼šå•çº¿ç¨‹ä¸ºä¾‹ï¼Œåˆ†é…çš„å¤§å°ä¸º <code>1 x 24 x (2 + 4) x (4 x 64) x 4</code>bytesã€‚å…¶ä¸­ï¼Œ<ul><li><code>1 x 24 x 2 x (4 x 64) x 4</code>bytesç”¨äºå­˜å‚¨è¾“å…¥å˜æ¢åçš„æ•°æ®ã€‚</li><li><code>1 x 24 x 4 x (4 x 64) x 4</code>bytesç”¨äºå­˜å‚¨è¾“å‡ºå˜æ¢åçš„æ•°æ®ã€‚</li></ul></li></ol></li><li><ol start="2"><li><code>mTransformMidBuffer</code>ï¼šå•çº¿ç¨‹ä¸ºä¾‹ï¼Œåˆ†é…çš„å¤§å°ä¸º <code>1 x 2 x 64 x 4 x 4</code>bytesï¼Œç”¨äºå­˜å‚¨å•ä¸ªè¾“å…¥å—çš„ä¸¤ä¸ªé€šé“å˜æ¢åçš„æ•°æ®ã€‚</li></ol></li><li><ol start="3"><li><code>mGemmMidBuffer</code>ï¼šå•çº¿ç¨‹ä¸ºä¾‹ï¼Œåˆ†é…çš„å¤§å°ä¸º<code>1 x (24 x 8) x 4</code>bytesï¼Œå•ä¸ªä¹˜åŠ æ¨¡å—éœ€è¦çš„è¾“å…¥æ•°æ®ï¼Œå³ï¼š<code>24 x 8</code>ä¸ªfloatï¼Œè‡³äºè¿™<code>24 x 8</code>æ˜¯ä»¥æ€æ ·çš„å½¢å¼å–å¾—ï¼Œä¸‹æ–‡æœ‰é˜è¿°ã€‚</li></ol></li></ul><p>é€šä¿—æ¥è¯´å°±æ˜¯é’ˆå¯¹æ¯ä¸ªè¾“å‡ºé€šé“ï¼Œä¸€æ¬¡å¤„ç†24ä¸ªè¾“å…¥çš„8é€šé“æ•°æ®ã€‚ä¹˜åŠ åå¾—åˆ°24ä¸ªè¾“å‡ºã€‚å¾ªç¯64æ¬¡ï¼Œå¾—åˆ°å•ä¸ªè¾“å‡ºé€šé“ä¸­ä¸€ä¸ª<code>tile</code>çš„æ‰€æœ‰è¾“å‡ºï¼ˆæœªåšè¾“å‡ºå˜æ¢å‰ï¼‰ï¼š <code>24 x 8 x 8</code>ã€‚</p><h1>è¾“å…¥å˜æ¢</h1><p>ç”±ä¸Šé¢ä¸€èŠ‚å¯çŸ¥ï¼Œä¸€æ¬¡å¤„ç†2ä¸ªé€šé“çš„tileï¼Œå³: <code>2 x 24 x 8 x 8 x4</code>çš„floatæ•°æ®é‡ã€‚</p><p>2ä¸ªé€šé“çš„å—å¤„ç†çš„æ ¸å¿ƒä»£ç éƒ¨åˆ†è§è¿™é‡Œï¼Œå¤–é¢ä¼šå¾ªç¯24æ¬¡ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> z = <span class="number">0</span>; z &lt; ic_4; ++z) &#123;</span><br><span class="line">    <span class="keyword">auto</span> srcZ = srcStart + z * sourceZStep * bytes;</span><br><span class="line">    <span class="comment">// Transform</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; srcUnit; ++i) &#123;</span><br><span class="line">        <span class="keyword">auto</span> srcFloatPtr = (<span class="keyword">const</span> <span class="keyword">float</span>*)(srcZ + i * iw * pack * bytes);</span><br><span class="line">        <span class="keyword">auto</span> dstFloatPtr = (<span class="keyword">float</span>*)(midBuffer1 + i * pack * bytes);</span><br><span class="line">        <span class="built_in">mSourceTransform</span>(srcFloatPtr, dstFloatPtr, pack, pack * srcUnit);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> dstZ = dst_x + z * dstZStep * bytes;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; srcUnit; ++i) &#123;</span><br><span class="line">        <span class="keyword">auto</span> srcFloatPtr = (<span class="keyword">const</span> <span class="keyword">float</span>*)(midBuffer1 + i * srcUnit * pack * bytes);</span><br><span class="line">        <span class="keyword">auto</span> dstFloatPtr = (<span class="keyword">float</span>*)(dstZ + i * unitStep * bytes);</span><br><span class="line">        <span class="built_in">mSourceTransform</span>(srcFloatPtr, dstFloatPtr, pack,</span><br><span class="line">                         unitStep * srcUnit);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>mSourceTransform</code>å‡½æ•°åŸºäº<code>unit</code>è€Œæœ‰ä¸åŒçš„å®ç°ï¼Œè¿™é‡Œè´´å‡º<code>8 x 8</code>çš„å®ç°ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LOAD8                                     \</span></span><br><span class="line"><span class="meta">    Vec4 s0 = Vec4::load(srcBlock + 0 * srcStep); \</span></span><br><span class="line"><span class="meta">    Vec4 s1 = Vec4::load(srcBlock + 1 * srcStep); \</span></span><br><span class="line"><span class="meta">    Vec4 s2 = Vec4::load(srcBlock + 2 * srcStep); \</span></span><br><span class="line"><span class="meta">    Vec4 s3 = Vec4::load(srcBlock + 3 * srcStep); \</span></span><br><span class="line"><span class="meta">    Vec4 s4 = Vec4::load(srcBlock + 4 * srcStep); \</span></span><br><span class="line"><span class="meta">    Vec4 s5 = Vec4::load(srcBlock + 5 * srcStep); \</span></span><br><span class="line"><span class="meta">    Vec4 s6 = Vec4::load(srcBlock + 6 * srcStep); \</span></span><br><span class="line"><span class="meta">    Vec4 s7 = Vec4::load(srcBlock + 7 * srcStep);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _sourceTransformUnit8x8(<span class="keyword">const</span> <span class="keyword">float</span>* srcBlock, <span class="keyword">float</span>* dstStart, <span class="keyword">size_t</span> srcStep, <span class="keyword">size_t</span> dstStep) &#123;</span><br><span class="line">    LOAD8;</span><br><span class="line">    Vec4 m0 = s0 * <span class="number">36.f</span> - s2 * <span class="number">49.f</span> + s4 * <span class="number">14.f</span> - s6;</span><br><span class="line">    Vec4 m1 = (s1 + s2) * <span class="number">36.f</span> - (s3 + s4) * <span class="number">13.f</span> + (s5 + s6);</span><br><span class="line">    Vec4 m2 = (s2 - s1) * <span class="number">36.f</span> + (s3 - s4) * <span class="number">13.f</span> + (s6 - s5);</span><br><span class="line">    Vec4 m3 = s1 * <span class="number">18.f</span> + s2 * <span class="number">9.f</span> - s3 * <span class="number">20.f</span> - s4 * <span class="number">10.f</span> + s5 * <span class="number">2.f</span> + s6;</span><br><span class="line">    Vec4 m4 = s2 * <span class="number">9.f</span> - s1 * <span class="number">18.f</span> + s3 * <span class="number">20.f</span> - s4 * <span class="number">10.f</span> - s5 * <span class="number">2.f</span> + s6;</span><br><span class="line">    Vec4 m5 = s1 * <span class="number">12.f</span> + s2 * <span class="number">4.f</span> - s3 * <span class="number">15.f</span> - s4 * <span class="number">5.f</span> + s5 * <span class="number">3.f</span> + s6;</span><br><span class="line">    Vec4 m6 = s2 * <span class="number">4.f</span> - s1 * <span class="number">12.f</span> + s3 * <span class="number">15.f</span> - s4 * <span class="number">5.f</span> - s5 * <span class="number">3.f</span> + s6;</span><br><span class="line">    Vec4 m7 = s3 * <span class="number">49.f</span> - s1 * <span class="number">36.f</span> - s5 * <span class="number">14.f</span> + s7;</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">0</span> * dstStep, m0);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">1</span> * dstStep, m1);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">2</span> * dstStep, m2);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">3</span> * dstStep, m3);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">4</span> * dstStep, m4);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">5</span> * dstStep, m5);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">6</span> * dstStep, m6);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">7</span> * dstStep, m7);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤„ç†ä¸€è¡Œè¾“å…¥æ•°æ®ï¼Œè°ƒç”¨äº†ä¸¤æ¬¡<code>mSouceTransform</code>ï¼Œå…¶ä¸­æ¯æ¬¡<code>mSouceTransform</code>é‡Œé¢åšçš„æ˜¯:</p><ul><li><ol><li><code>LOAD8</code>ï¼šæŒ‡ä»¤é›†è¿ç»­åŠ è½½ä¸€ä¸ªå—ä¸­ä¸€è¡Œçš„8ä¸ª<code>C4 Pack</code>çš„æ•°æ®ï¼ˆå¯ä»¥è§†ä¸ºä¸€ä¸ªè¡Œå‘é‡ï¼‰ï¼Œæ”¾åˆ°8ä¸ª128bitçš„å¯„å­˜å™¨<code>s0 - s7</code>ä¸­ï¼›</li></ol></li><li><ol start="2"><li>å³ä¹˜å˜æ¢çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ï¼Œå¾—åˆ°ç›¸ä¹˜ç»“æœ <code>m0 - m7</code>ï¼›</li></ol></li><li><ol start="3"><li><code>m0-m7</code>è½¬ç½®ï¼ˆ<code>+ n * dstStep</code>æŒ‰åˆ—å­˜æ”¾ï¼‰åï¼Œè¾“å‡ºåˆ°ä¸´æ—¶çš„<code>mTransformMidBuffer</code>ä¸­ã€‚</li></ol></li></ul><p>å…¶å®MNNå¯¹åŸå§‹å˜æ¢å…¬å¼åšäº†ç­‰ä»·è°ƒæ•´ï¼Œè¿™æ ·è°ƒæ•´èƒ½å¤Ÿä¾¿äºä»£ç å¤ç”¨ï¼Œä¸ç”¨åŒæ—¶ä¿ç•™çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>åŠçŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">B^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>B</mi><mi>T</mi></msup><mi>D</mi><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>D</mi><mi>B</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mi>B</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">B^TDB=((DB)^TB)^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></p><p>ä¸€è¡Œå¤„ç†å®Œæ¯•åï¼Œå¾ªç¯8æ¬¡ï¼Œå°†8è¡Œæ•°æ®å…¨éƒ¨å¤„ç†å®Œï¼Œå³å®Œæˆäº†<code>8x8</code>ä¸€ä¸ªå—çš„å˜æ¢ã€‚ç„¶åå¾ªç¯2æ¬¡ï¼ŒæŠŠä¸€ä¸ªå—(block)çš„2ä¸ª<code>C4 Pack</code>é€šé“ä¹Ÿå¤„ç†å®Œæ¯•ï¼Œä¿å­˜åˆ°<code>mTempBuffer</code>ä¸­ï¼Œä¿å­˜æ’å¸ƒæ˜¯è¿™æ ·çš„ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/3.png" alt="3"></p><h1>MatMul + Add ä¹˜åŠ è®¡ç®—</h1><p>å•ä¸ªtileçš„è¾“å…¥è½¬æ¢å®Œæ¯•åï¼Œå¯ä»¥å‡†å¤‡ä¹˜åŠ è®¡ç®—äº†ã€‚MNNæºç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; srcUnit2; ++i) &#123;</span><br><span class="line">    <span class="keyword">auto</span> srcTemp = (<span class="keyword">const</span> <span class="keyword">float</span>*)(_srcOrigin + i * ic_4 * pack * xC * bytes);</span><br><span class="line">    <span class="keyword">auto</span> _dstFloatPtr = (<span class="keyword">float</span>*)(_dstOrigin + i * dc_4 * pack * xC * bytes);</span><br><span class="line">    <span class="keyword">auto</span> _weightFloatPtr = (<span class="keyword">const</span> <span class="keyword">float</span>*)(weight + i * mResource-&gt;mWeight-&gt;<span class="built_in">stride</span>(<span class="number">0</span>));</span><br><span class="line">    core-&gt;<span class="built_in">MNNPackC4ForMatMul_A</span>((<span class="keyword">float</span>*)gemmBuffer, &amp;srcTemp, info, el);</span><br><span class="line">    core-&gt;<span class="built_in">MNNPackedMatMul</span>(_dstFloatPtr, (<span class="keyword">float</span>*)gemmBuffer, _weightFloatPtr, parameters.<span class="built_in">data</span>(), <span class="literal">nullptr</span>, <span class="literal">nullptr</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šé¢çš„è½¬æ¢å›¾å¯çŸ¥ï¼Œ<code>tile</code>ä¸­çš„æ•°æ®æ’å¸ƒæˆ64è¡Œï¼Œæ¯è¡Œ24ä¸ª<code>C4 Pack</code>ï¼Œä¸€å…±2ä¸ªé€šé“ã€‚</p><p>é¦–å…ˆæœ€å¤–å±‚forå¾ªç¯<code>srcUint2 = 8 x 8 = 64</code>ï¼Œå³é€è¡Œéå†ã€‚æ¯è¡Œçš„å¤„ç†åŒ…æ‹¬<code>MNNPackC4ForMatMul_A</code> åŠ <code>MNNPackedMatMul</code>ä¸¤ä¸ªæ­¥éª¤ï¼š</p><h2 id="MNNPackC4ForMatMul-A">MNNPackC4ForMatMul_A</h2><blockquote><p>æ­¤å¤„ä»£ç ä¸ºMNN release_1.1.7ç‰ˆæœ¬ï¼ˆä¸ºäº†ä¾¿äºè·Ÿä¸Šè¿°é€»è¾‘è¿è´¯ï¼‰ï¼Œåç»­ç‰ˆæœ¬AVXåŠ é€Ÿä»£ç æœ‰æ›´æ–°(AVXæœ‰256ä½å¯„å­˜å™¨ï¼Œå¯ä»¥ä»<code>C4 Pack</code> å‡åˆ°<code>C8 pack</code> )</p></blockquote><p><code>_AVX_MNNPackC4ForMatMul_A</code>å‡½æ•°æ ¸å¿ƒä»£ç ï¼ˆAVXæŒ‡ä»¤é›†åŠ é€Ÿç‰ˆæœ¬ï¼‰å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAIN_COMPUTE                        \</span></span><br><span class="line"><span class="meta">    auto s00 = _mm_loadu_ps(srcX + 0 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s01 = _mm_loadu_ps(srcX + 1 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s02 = _mm_loadu_ps(srcX + 2 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s03 = _mm_loadu_ps(srcX + 3 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s10 = _mm_loadu_ps(srcX + 4 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s11 = _mm_loadu_ps(srcX + 5 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s12 = _mm_loadu_ps(srcX + 6 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s13 = _mm_loadu_ps(srcX + 7 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s20 = _mm_loadu_ps(srcX + 8 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s21 = _mm_loadu_ps(srcX + 9 * pOffset);  \</span></span><br><span class="line"><span class="meta">    auto s22 = _mm_loadu_ps(srcX + 10 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s23 = _mm_loadu_ps(srcX + 11 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s30 = _mm_loadu_ps(srcX + 12 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s31 = _mm_loadu_ps(srcX + 13 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s32 = _mm_loadu_ps(srcX + 14 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s33 = _mm_loadu_ps(srcX + 15 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s40 = _mm_loadu_ps(srcX + 16 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s41 = _mm_loadu_ps(srcX + 17 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s42 = _mm_loadu_ps(srcX + 18 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s43 = _mm_loadu_ps(srcX + 19 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s50 = _mm_loadu_ps(srcX + 20 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s51 = _mm_loadu_ps(srcX + 21 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s52 = _mm_loadu_ps(srcX + 22 * pOffset); \</span></span><br><span class="line"><span class="meta">    auto s53 = _mm_loadu_ps(srcX + 23 * pOffset); \</span></span><br><span class="line"><span class="meta">    _MM_TRANSPOSE4_PS(s00, s01, s02, s03);  \</span></span><br><span class="line"><span class="meta">    _MM_TRANSPOSE4_PS(s10, s11, s12, s13);  \</span></span><br><span class="line"><span class="meta">    _MM_TRANSPOSE4_PS(s20, s21, s22, s23);  \</span></span><br><span class="line"><span class="meta">    _MM_TRANSPOSE4_PS(s30, s31, s32, s33);  \</span></span><br><span class="line"><span class="meta">    _MM_TRANSPOSE4_PS(s40, s41, s42, s43);  \</span></span><br><span class="line"><span class="meta">    _MM_TRANSPOSE4_PS(s50, s51, s52, s53);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STORE_TEMP(i)                               \</span></span><br><span class="line"><span class="meta">    _mm_storeu_ps(dstX + 4 * (6 * i + 0), s##0##i); \</span></span><br><span class="line"><span class="meta">    _mm_storeu_ps(dstX + 4 * (6 * i + 1), s##1##i); \</span></span><br><span class="line"><span class="meta">    _mm_storeu_ps(dstX + 4 * (6 * i + 2), s##2##i); \</span></span><br><span class="line"><span class="meta">    _mm_storeu_ps(dstX + 4 * (6 * i + 3), s##3##i); \</span></span><br><span class="line"><span class="meta">    _mm_storeu_ps(dstX + 4 * (6 * i + 4), s##4##i); \</span></span><br><span class="line"><span class="meta">    _mm_storeu_ps(dstX + 4 * (6 * i + 5), s##5##i);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; lC4; ++x) &#123;</span><br><span class="line">    <span class="keyword">auto</span> srcX = source + x * <span class="number">4</span> * eReal;</span><br><span class="line">    <span class="keyword">auto</span> dstX = dest + x * eDest * <span class="number">4</span>;</span><br><span class="line">    MAIN_COMPUTE;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">STORE_TEMP</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">STORE_TEMP</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">STORE_TEMP</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">STORE_TEMP</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨å›¾å±•ç¤ºå¦‚ä¸‹ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/4.png" alt="4"></p><p>å³å±äºåŒä¸€ä¸ªè¾“å…¥é€šé“çš„24ä¸ªå…ƒç´ æ’åœ¨ä¸€èµ·ï¼Œä¸¤ä¸ª<code>C4 Pack</code>é€šé“å¤„ç†å®Œå°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/5.png" alt="5"></p><h2 id="MNNPackedMatMul">MNNPackedMatMul</h2><blockquote><p>åŒæ ·æ˜¯AVXåŠ é€Ÿç‰ˆæœ¬ï¼Œè¿™é‡Œè´´å‡ºçš„æ˜¯release_1.2.3ç‰ˆæœ¬ï¼Œä¸1.1.7ç‰ˆæœ¬ç›¸æ¯”ï¼Œé€»è¾‘æ²¡æœ‰å˜åŒ–ï¼Œåªæ˜¯å‡½æ•°åç”±<code>_AVX_MNNPackedMatMul_24</code>æ”¹ä¸º<code>_AVX_MNNPackedMatMul_Main</code></p></blockquote><p><code>_AVX_MNNPackedMatMul_Main</code>å‡½æ•°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INIT_MAIN_24_4                                  \</span></span><br><span class="line"><span class="meta">    auto s0  = LOAD8(A + 0 * 24);             \</span></span><br><span class="line"><span class="meta">    auto s1  = LOAD8(A + 0 * 24 + 8);         \</span></span><br><span class="line"><span class="meta">    auto s2  = LOAD8(A + 0 * 24 + 16);        \</span></span><br><span class="line"><span class="meta">    auto w0  = BROAD_LOAD(weight + 0 * 4 + 0); \</span></span><br><span class="line"><span class="meta">    auto z0  = _mm256_mul_ps(s0, w0);                   \</span></span><br><span class="line"><span class="meta">    auto z1  = _mm256_mul_ps(s1, w0);                   \</span></span><br><span class="line"><span class="meta">    auto z2  = _mm256_mul_ps(s2, w0);                   \</span></span><br><span class="line"><span class="meta">    auto w1  = BROAD_LOAD(weight + 0 * 4 + 1); \</span></span><br><span class="line"><span class="meta">    auto z3  = _mm256_mul_ps(s0, w1);                   \</span></span><br><span class="line"><span class="meta">    auto z4  = _mm256_mul_ps(s1, w1);                   \</span></span><br><span class="line"><span class="meta">    auto z5  = _mm256_mul_ps(s2, w1);                   \</span></span><br><span class="line"><span class="meta">    auto w2  = BROAD_LOAD(weight + 0 * 4 + 2); \</span></span><br><span class="line"><span class="meta">    auto z6  = _mm256_mul_ps(s0, w2);                   \</span></span><br><span class="line"><span class="meta">    auto z7  = _mm256_mul_ps(s1, w2);                   \</span></span><br><span class="line"><span class="meta">    auto z8  = _mm256_mul_ps(s2, w2);                   \</span></span><br><span class="line"><span class="meta">    auto w3  = BROAD_LOAD(weight + 0 * 4 + 3); \</span></span><br><span class="line"><span class="meta">    auto z9  = _mm256_mul_ps(s0, w3);                   \</span></span><br><span class="line"><span class="meta">    auto z10 = _mm256_mul_ps(s1, w3);                   \</span></span><br><span class="line"><span class="meta">    auto z11 = _mm256_mul_ps(s2, w3);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COMPUTE_24_4                                \</span></span><br><span class="line"><span class="meta">    s0  = LOAD8(A + sy * 24);             \</span></span><br><span class="line"><span class="meta">    s1  = LOAD8(A + sy * 24 + 8);         \</span></span><br><span class="line"><span class="meta">    s2  = LOAD8(A + sy * 24 + 16);        \</span></span><br><span class="line"><span class="meta">    w0  = BROAD_LOAD(weight + sy * 4 + 0); \</span></span><br><span class="line"><span class="meta">    z0  = MNNAVXFMA(s0, w0, z0);                    \</span></span><br><span class="line"><span class="meta">    z1  = MNNAVXFMA(s1, w0, z1);                    \</span></span><br><span class="line"><span class="meta">    z2  = MNNAVXFMA(s2, w0, z2);                    \</span></span><br><span class="line"><span class="meta">    w1  = BROAD_LOAD(weight + sy * 4 + 1); \</span></span><br><span class="line"><span class="meta">    z3  = MNNAVXFMA(s0, w1, z3);                    \</span></span><br><span class="line"><span class="meta">    z4  = MNNAVXFMA(s1, w1, z4);                    \</span></span><br><span class="line"><span class="meta">    z5  = MNNAVXFMA(s2, w1, z5);                    \</span></span><br><span class="line"><span class="meta">    w2  = BROAD_LOAD(weight + sy * 4 + 2); \</span></span><br><span class="line"><span class="meta">    z6  = MNNAVXFMA(s0, w2, z6);                    \</span></span><br><span class="line"><span class="meta">    z7  = MNNAVXFMA(s1, w2, z7);                    \</span></span><br><span class="line"><span class="meta">    z8  = MNNAVXFMA(s2, w2, z8);                    \</span></span><br><span class="line"><span class="meta">    w3  = BROAD_LOAD(weight + sy * 4 + 3); \</span></span><br><span class="line"><span class="meta">    z9  = MNNAVXFMA(s0, w3, z9);                    \</span></span><br><span class="line"><span class="meta">    z10 = MNNAVXFMA(s1, w3, z10);                   \</span></span><br><span class="line"><span class="meta">    z11 = MNNAVXFMA(s2, w3, z11);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> TYPE&gt;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _AVX_MNNPackedMatMul_Main(TYPE* C, <span class="keyword">const</span> TYPE* A, <span class="keyword">const</span> TYPE* B, <span class="keyword">const</span> <span class="keyword">size_t</span>* parameter) &#123;</span><br><span class="line">    <span class="keyword">auto</span> h            = parameter[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">auto</span> l            = parameter[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">auto</span> cStride      = parameter[<span class="number">3</span>] / <span class="built_in"><span class="keyword">sizeof</span></span>(TYPE);</span><br><span class="line">    <span class="keyword">auto</span> bExtraStride = parameter[<span class="number">5</span>] / <span class="built_in"><span class="keyword">sizeof</span></span>(TYPE);</span><br><span class="line">    <span class="keyword">auto</span> bStride      = bExtraStride + l * <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">auto</span> hC4          = <span class="built_in">UP_DIV</span>(h, <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; hC4; ++y) &#123;</span><br><span class="line">        <span class="keyword">auto</span> weight = B + y * bStride;</span><br><span class="line">        <span class="keyword">auto</span> dst    = C + (y / <span class="number">2</span>) * cStride + <span class="number">4</span> * (y % <span class="number">2</span>);</span><br><span class="line">        INIT_MAIN_24_4;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> sy = <span class="number">1</span>; sy &lt; l; ++sy) &#123;</span><br><span class="line">            COMPUTE_24_4;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">TRANPOSE_SAVE</span>(<span class="number">0</span>, <span class="number">0</span>, z0, z3, z6, z9);</span><br><span class="line">        <span class="built_in">TRANPOSE_SAVE</span>(<span class="number">1</span>, <span class="number">0</span>, z0, z3, z6, z9);</span><br><span class="line">        <span class="built_in">TRANPOSE_SAVE</span>(<span class="number">0</span>, <span class="number">1</span>, z1, z4, z7, z10);</span><br><span class="line">        <span class="built_in">TRANPOSE_SAVE</span>(<span class="number">1</span>, <span class="number">1</span>, z1, z4, z7, z10);</span><br><span class="line">        <span class="built_in">TRANPOSE_SAVE</span>(<span class="number">0</span>, <span class="number">2</span>, z2, z5, z8, z11);</span><br><span class="line">        <span class="built_in">TRANPOSE_SAVE</span>(<span class="number">1</span>, <span class="number">2</span>, z2, z5, z8, z11);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢è¯¦ç»†çœ‹ä¸‹è®¡ç®—è¿‡ç¨‹ï¼š</p><p>é¦–å…ˆçœ‹ä¸‹å°†è¦å‚ä¸è¿ç®—çš„æ•°æ®æ’å¸ƒå½¢å¼æ˜¯æ€ä¹ˆæ ·çš„ï¼Œæˆ‘ä»¬å°†ä¸Šé¢<strong>æƒé‡å˜æ¢</strong>åï¼ˆå–<code>8x8</code>ä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œå…¶ä½™å¾ªç¯64æ¬¡å³å¯ï¼‰çš„å›¾ å’Œ <strong>è¾“å…¥å˜æ¢</strong>åï¼ˆå–ä¸€ä¸ª<code>tile</code>ä¸­<code>64 x 24 x 2</code>ä¸­çš„ä¸€è¡Œï¼Œå³<code>24 x 2</code> ï¼ˆæŒ‰ç…§<code>C4 Pack</code>å±•å¼€åå°±æ˜¯<code>24 x 8</code>ï¼‰ï¼Œå…¶ä½™å¾ªç¯64æ¬¡å³å¯ï¼‰çš„å›¾æ”¾åœ¨ä¸€èµ·ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/6.png" alt="6"></p><p>ä¹˜åŠ å·¥ä½œå°±æ˜¯è¦åœ¨ä¸Šé¢çš„ä¸¤ä¸ªå›¾å±•å¼€ã€‚ä¸ºäº†è§£é‡Šèµ·æ¥æ›´ç®€å•ï¼Œå†ä»ä¸Šé¢æƒé‡å›¾ä¸­<strong>æ‹¿1ä¸ª<code>8 x C4 Pack</code>ï¼ˆå³ï¼š4ä¸ªå·ç§¯æ ¸ï¼‰æ¥</strong>ï¼Œè‡³äºæ‰€æœ‰çš„4ä¸ª<code>8 x C4 Pack</code>ï¼ˆå³ï¼š16ä¸ªå·ç§¯æ ¸ï¼‰å·ç§¯æ ¸å¾ªç¯4æ¬¡å¤„ç†å³å¯ã€‚å–å‡ºæ¥çš„<code>Mul+Add</code>è¿ç®—å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/7.png" alt="7"></p><p>ä¸Šå›¾ä¸­çš„è®¡ç®—æµç¨‹å½’çº³ä¸€ä¸‹ï¼š</p><ul><li><ol><li><code>MUL</code>æ“ä½œæ—¶ï¼Œä»¥ä¸Šå›¾ä¸­ä¸¤ä¸ªé»‘è‰²æ¡†ä¸ºè®¡ç®—å•å…ƒã€‚è¾“å…¥çš„é»‘è‰²æ¡†ä¸­æ¯æ¬¡å–ä¸€ä¸ªå€¼å‡ºæ¥ï¼Œä¸æƒé‡ç¬¬ä¸€è¡Œé»‘è‰²æ¡†ä¸­4ä¸ªå€¼ä¾æ¬¡ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœpackåˆ°ä¸€èµ·ï¼Œç›´åˆ°24ä¸ªå€¼å…¨éƒ¨è®¡ç®—å®Œæˆï¼Œè¾“å‡ºä¸€è¡Œ<code>24 (x 4)</code>ã€‚</li></ol></li><li><ol start="2"><li>è¾“å…¥æ›´æ–°åˆ°ä¸‹ä¸€ä¸ªé€šé“24ä¸ªå€¼ï¼Œæƒé‡ä¹Ÿä¸‹ç§»ä¸€è¡Œï¼Œé‡å¤8æ¬¡ä¸Šè¿°è¿ç®—ã€‚å¾—åˆ°<code>8 x 24 (x 4)</code>ã€‚</li></ol></li><li><ol start="3"><li>å°†8è¡Œæ•°æ®å¯¹åº”ä½ç½®ç´¯åŠ (å³ï¼šåŒä¸€ä¸ªå·ç§¯æ ¸çš„ä¸åŒé€šé“ç´¯åŠ )ï¼Œå¾—åˆ°24ä¸ªç‚¹ä¸€ä¸ª<code>C4 Pack</code>çš„å·ç§¯ç»“æœï¼š<code>24 (x 4)</code>ã€‚</li></ol></li><li><ol start="4"><li>å·ç§¯æ ¸æœ‰16ä¸ªï¼Œå³ï¼š4ä¸ª<code>C4 Pack</code>ï¼Œå¾ªç¯4æ¬¡ï¼Œå°†æ‰€æœ‰å·ç§¯æ ¸å¤„ç†å®Œï¼Œå¾—åˆ°24ä¸ªç‚¹æ‰€æœ‰å·ç§¯æ ¸çš„å·ç§¯ç»“æœï¼š<code>24 (x 4) x 4</code></li></ol></li></ul><p>è‡³æ­¤ï¼Œä¸€ä¸ª<code>tile</code>çš„<strong>ä¸€è¡Œ</strong>æ•°æ®å¤„ç†å®Œæˆï¼Œå¾ªç¯64æ¬¡ï¼Œå°±æŠŠæ•´ä¸ª<code>tile</code>çš„æ•°æ®å…¨éƒ¨è®¡ç®—å®Œæˆã€‚å¹¶ä»æ—§æŒ‰ç…§64 Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Green"><mn>24</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Green}24</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Green;">24</span></span></span></span> Ã— (Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Blue"><mn>4</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Blue}4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Blue;">4</span></span></span></span>) Ã— <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>4</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Red}4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Red;">4</span></span></span></span>ï¼ˆè¿™é‡ŒæŠŠ<code>C4 Pack</code>çš„é€šé“æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>4</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Red}4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Red;">4</span></span></span></span> æ”¾åˆ°æœ€åï¼Œæ˜¯ä¸ºäº†ä¾¿äºç†è§£å…¶è·ŸPack çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Blue"><mn>4</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Blue}4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Blue;">4</span></span></span></span>æ˜¯åŒä¸€ç»´åº¦çš„ï¼Œè™½ç„¶åœ¨æ•°æ®æ’å¸ƒä¸Šï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>4</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Red}4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Red;">4</span></span></span></span>åº”è¯¥åœ¨<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Green"><mn>24</mn></mstyle></mrow><annotation encoding="application/x-tex">\color{Green}24</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord" style="color:Green;">24</span></span></span></span>ä¹‹å‰ï¼‰çš„æ–¹å¼æ”¾å…¥å†…å­˜ä¸­ã€‚ä¸€ä¸ªtileå…¨éƒ¨å¤„ç†å®Œåçš„æ’å¸ƒå¦‚å›¾ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/8.png" alt="8"></p><p>ä¸ºäº†ç›´è§‚æ–¹ä¾¿å¯¹æ¯”ï¼Œæˆ‘ä»¬æŠŠä¹˜åŠ å‰å’Œä¹˜åŠ åçš„å›¾æ”¾åœ¨ä¸€èµ·å†çœ‹ä¸€éï¼š</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/3.png" alt="3"></p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/9.png" alt="9"></p><h1>è¾“å‡ºå˜æ¢</h1><p>å•ä¸ª<code>tile</code>çš„<code>MatMul + ADD</code> è®¡ç®—å®Œæˆåï¼Œéœ€è¦æ ¹æ®è¾“å‡ºå˜æ¢çŸ©é˜µè®¡ç®—å¾—åˆ°æœ€ç»ˆçš„å·ç§¯è¾“å‡ºç»“æœã€‚å…¶è¿‡ç¨‹ä»æ—§å’Œè¾“å…¥å˜æ¢ç±»ä¼¼ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> z = <span class="number">0</span>; z &lt; dc_4; ++z) &#123;</span><br><span class="line">    <span class="keyword">auto</span> dstZAddr = dstStart + z * dstZStep * bytes;</span><br><span class="line">    <span class="keyword">auto</span> srcZ     = srcXi + z * srcZStep * bytes;</span><br><span class="line">    <span class="comment">// Transform</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; srcUnit; ++i) &#123;</span><br><span class="line">        <span class="keyword">auto</span> srcFloatPtr = (<span class="keyword">const</span> <span class="keyword">float</span>*)(srcZ + i * unitStep * bytes);</span><br><span class="line">        <span class="keyword">auto</span> dstFloatPtr = (<span class="keyword">float</span>*)(midBuffer0 + i * dstUnit * pack * bytes);</span><br><span class="line">        <span class="built_in">mDestTransform</span>(srcFloatPtr, dstFloatPtr, srcUnit * unitStep, pack);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ey; ++i) &#123;</span><br><span class="line">        <span class="keyword">auto</span> srcFloatPtr = (<span class="keyword">const</span> <span class="keyword">float</span>*)(midBuffer0 + i * pack * bytes);</span><br><span class="line">        <span class="keyword">auto</span> dstFloatPtr = (<span class="keyword">float</span>*)(dstZAddr + i * pack * ow * bytes);</span><br><span class="line">        <span class="built_in">mDestTransform</span>(srcFloatPtr, dstFloatPtr, pack * dstUnit, pack);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œä¾æ—§æ˜¯æ‰§è¡Œäº†ä¸¤æ¬¡<code>mDestTransform</code>å‡½æ•°ï¼ŒåŒè¾“å…¥å˜æ¢ä¸€æ ·ï¼ŒMNNå¯¹è¾“å‡ºå˜æ¢ä¹Ÿåšäº†å¦‚ä¸‹çš„ç­‰ä»·è°ƒæ•´ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup><mi>O</mi><mi>A</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>O</mi><mi>T</mi></msup><mi>A</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">A^TOA=(O^TA)^TA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8913em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span></span></p><p><code>mDestTransform</code>å‡½æ•°åŒæ ·åŸºäº<code>unit</code>è€Œæœ‰ä¸åŒçš„å®ç°ï¼Œè¿™é‡Œè´´å‡º<code>8 x 6</code>çš„å®ç°ï¼š</p><blockquote><p>åŒæ ·ä¸ºäº†ä¿æŒé€»è¾‘è¿è´¯æ€§ï¼Œæ­¤å¤„é‡‡ç”¨Vec4ç‰ˆæœ¬å®ç°ï¼ŒAVXå¯ä»¥ä½¿ç”¨Vec8ç‰ˆæœ¬å®ç°</p></blockquote><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> _destTransformUnit8x6(<span class="keyword">const</span> <span class="keyword">float</span>* srcBlock, <span class="keyword">float</span>* dstStart, <span class="keyword">size_t</span> srcStep, <span class="keyword">size_t</span> dstStep) &#123;</span><br><span class="line">    Vec4 s0 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">0</span> * srcStep);</span><br><span class="line">    Vec4 s1 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">1</span> * srcStep);</span><br><span class="line">    Vec4 s2 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">2</span> * srcStep);</span><br><span class="line">    Vec4 s3 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">3</span> * srcStep);</span><br><span class="line">    Vec4 s4 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">4</span> * srcStep);</span><br><span class="line">    Vec4 s5 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">5</span> * srcStep);</span><br><span class="line">    Vec4 s6 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">6</span> * srcStep);</span><br><span class="line">    Vec4 s7 = Vec4::<span class="built_in">load</span>(srcBlock + <span class="number">7</span> * srcStep);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> m0 = s0 + s1 + s2 + s3 + s4 + s5 + s6;</span><br><span class="line">    <span class="keyword">auto</span> m1 = (s1 - s2) + (s3 - s4) * <span class="number">2.f</span> + (s5 - s6) * <span class="number">3.f</span>;</span><br><span class="line">    <span class="keyword">auto</span> m2 = (s1 + s2) + (s3 + s4) * <span class="number">4.f</span> + (s5 + s6) * <span class="number">9.f</span>;</span><br><span class="line">    <span class="keyword">auto</span> m3 = (s1 - s2) + (s3 - s4) * <span class="number">8.f</span> + (s5 - s6) * <span class="number">27.f</span>;</span><br><span class="line">    <span class="keyword">auto</span> m4 = (s1 + s2) + (s3 + s4) * <span class="number">16.f</span> + (s5 + s6) * <span class="number">81.f</span>;</span><br><span class="line">    <span class="keyword">auto</span> m5 = (s1 - s2) + (s3 - s4) * <span class="number">32.f</span> + (s5 - s6) * <span class="number">243.f</span> + s7;</span><br><span class="line"></span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">0</span> * dstStep, m0);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">1</span> * dstStep, m1);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">2</span> * dstStep, m2);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">3</span> * dstStep, m3);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">4</span> * dstStep, m4);</span><br><span class="line">    Vec4::<span class="built_in">save</span>(dstStart + <span class="number">5</span> * dstStep, m5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„è½¬ç½®æ“ä½œå®é™…éšè—åœ¨<code>load</code>æ“ä½œä¸­ï¼Œå› ä¸º<code>srcStep=srcUnit * unitStep</code>ï¼Œä¼šå¯¼è‡´è·³è¡Œè¯»å–ã€‚</p><p>ä¸€æ¬¡<code>mDestTransform</code>å¤„ç†ä¸€è¡Œï¼ˆ8ä¸ª<code>C4 Pack</code>ï¼‰ï¼Œå¾ªç¯<code>srcUnit=8</code>æ¬¡å¾—åˆ°<code>8 x 6 x (x 4) </code>çš„ä¸­é—´ç»“æœ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>O</mi><mi>T</mi></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">O^TA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span>ï¼Œå†å¾ªç¯<code>ey=6</code>æ¬¡å¾—åˆ°<code>6 x 6 x (x 4)</code>çš„æœ€ç»ˆç»“æœã€‚</p><p>ç„¶åå¾ªç¯4æ¬¡ï¼ŒæŠŠ4ä¸ªé€šé“ä¹Ÿå¤„ç†å®Œæ¯•ã€‚ç„¶åå¾ªç¯24æ¬¡ï¼ŒæŠŠä¸€ä¸ªtileå¤„ç†å®Œæ¯•ã€‚ç„¶åå¤„ç†å…¶ä»–tileï¼Œ58ä¸ªtileå…¨éƒ¨å¤„ç†å®Œï¼Œåˆ™å®Œæ•´æ•´ä¸ªè¾“å…¥çš„å·ç§¯æ“ä½œã€‚</p><p><img src="/2021/11/16/AI-Algorithm-5-WinogradInMnn/9.png" alt="9.png"></p><h1>PostTransform (Bias, Relu, Relu6)</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">MNN_CONCURRENCY_BEGIN</span>(tId, threadNumber) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> dy=(<span class="keyword">int</span>)tId; dy &lt; dc_4; dy += threadNumber) &#123;</span><br><span class="line">        <span class="keyword">auto</span> dataFloatPtr = (<span class="keyword">float</span>*)(dstOrigin + ow * oh * batch * dy * pack * bytes);</span><br><span class="line">        <span class="keyword">auto</span> biasFloatPtr = (<span class="keyword">const</span> <span class="keyword">float</span>*)(bias + pack * dy * bytes);</span><br><span class="line">        core-&gt;<span class="built_in">MNNAxByClampBroadcastUnit</span>(dataFloatPtr, dataFloatPtr, biasFloatPtr, ow * oh * batch, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>,  mPostParameters.<span class="built_in">data</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">MNN_CONCURRENCY_END</span>();</span><br></pre></td></tr></table></figure><p><code>core-&gt;MNNAxByClampBroadcastUnit</code>çš„AVXå®ç°ä¸º<code>_AVX_MNNAxByClampBroadcastUnit</code>å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><blockquote><p>è¿™é‡Œé€»è¾‘æ¯”è¾ƒç®€å•ï¼Œå°±ä¸æ”¾ä¹‹å‰ç‰ˆæœ¬çš„<code>C4 Pack</code>å®ç°äº†ï¼Œè¿™é‡Œæ˜¯<code>C8 Pack</code>å®ç°</p></blockquote><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> _AVX_MNNAxByClampBroadcastUnit(<span class="keyword">float</span>* C, <span class="keyword">const</span> <span class="keyword">float</span>* A, <span class="keyword">const</span> <span class="keyword">float</span>* B, <span class="keyword">size_t</span> width, <span class="keyword">size_t</span> cStride, <span class="keyword">size_t</span> aStride, <span class="keyword">size_t</span> height, <span class="keyword">const</span> <span class="keyword">float</span>* parameters) &#123;</span><br><span class="line">    <span class="keyword">auto</span> minF = _mm256_broadcast_ss(parameters + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">auto</span> maxF = _mm256_broadcast_ss(parameters + <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; height; ++y) &#123;</span><br><span class="line">        <span class="keyword">auto</span> a = A + aStride * y;</span><br><span class="line">        <span class="keyword">auto</span> b = B + PACK_UNIT * y;</span><br><span class="line">        <span class="keyword">auto</span> bv = _mm256_loadu_ps(b);</span><br><span class="line">        <span class="keyword">auto</span> c = C + cStride * y;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; width; ++x) &#123;</span><br><span class="line">            <span class="keyword">auto</span> av = _mm256_loadu_ps(a);</span><br><span class="line">            <span class="keyword">auto</span> cv = _mm256_add_ps(av, bv);</span><br><span class="line">            cv = _mm256_min_ps(cv, maxF);</span><br><span class="line">            cv = _mm256_max_ps(cv, minF);</span><br><span class="line">            _mm256_storeu_ps(c, cv);</span><br><span class="line">            a += PACK_UNIT;</span><br><span class="line">            c += PACK_UNIT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯<code>C8 Pack</code>ç»Ÿä¸€åŠ ä¸Šä¸€ç»„<code>bias</code>ï¼Œå†æ ¹æ®<code>minF/maxF</code>(åœ¨æ¨¡å‹åˆå§‹åŒ–æ—¶å°±æ ¹æ®æ˜¯reluè¿˜æ˜¯relu6æ¥ç¡®å®šï¼Œæ”¾åˆ°<code>mPostParameters</code>ä¸­äº†)å»å¤„ç†æ¿€æ´»å±‚ã€‚</p><h1>è‡´è°¢</h1><p>æ–‡ç« ä¸»ä½“æ¡†æ¶å‚è€ƒè‡ª<a href="https://github.com/yizhaoyanbo">ä¸œå“¥</a>çš„MNNæºç è§£è¯»çš„å†…éƒ¨åˆ†äº«ï¼ŒåŠ ä¸Šäº†è‡ªå·±çš„ä¸€äº›çœ‹æ³•ã€‚æœ‰å¹¸è¢«çœ‹åˆ°çš„è¯ï¼Œå¸Œæœ›èƒ½ç»™ç‚¹ä¸ªèµ~~</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Algorithm </tag>
            
            <tag> MNN </tag>
            
            <tag> Winograd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [4]ï¼šWinogradç®—æ³•åŸç†</title>
      <link href="/2021/11/16/AI-Algorithm-4-Winograd/"/>
      <url>/2021/11/16/AI-Algorithm-4-Winograd/</url>
      
        <content type="html"><![CDATA[<h1>ç®€ä»‹</h1><p>Winogradç®—æ³•èµ·æºäº1980å¹´ï¼Œä½œè€…Shmuel Winograd åœ¨æ–‡ç« <a href="https://epubs.siam.org/doi/abs/10.1137/0209021">ã€ŠOn multiplication of polynomials modulo a polynomialã€‹</a>ä¸­æå‡ºçš„å‡å°‘FIRæ»¤æ³¢å™¨è®¡ç®—é‡çš„ä¸€ä¸ªç®—æ³•ã€‚ä»–æŒ‡å‡ºï¼Œå¯¹äºè¾“å‡ºä¸ªæ•°ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span>ï¼Œå‚æ•°ä¸ªæ•°ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>çš„FIRæ»¤æ³¢å™¨ï¼Œä¸éœ€è¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>Ã—</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">mÃ—r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>æ¬¡ä¹˜æ³•è®¡ç®—ï¼Œè€Œåªéœ€è¦<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mo>+</mo><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">u(F(m,r))=m+r-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>æ¬¡ä¹˜æ³•è®¡ç®—å³å¯ã€‚</p><p>åæ¥ï¼Œæœ‰äººå‘ç°æ­¤ç®—æ³•å¯ä»¥ç”¨æ¥ä¼˜åŒ–åŠ é€ŸCNNç½‘ç»œçš„å·ç§¯è®¡ç®—<a href="https://arxiv.org/pdf/1509.09308.pdf">ã€ŠFast Algorithms for Convolutional Neural Networksã€‹</a>ï¼Œä»æ­¤Winogradç®—æ³•è¢«å¹¿æ³›åº”ç”¨äºå„æ¨ç†æ¡†æ¶ä¸­ã€‚</p><h1>åŸç†</h1><h2 id="1D-Winogradç®—æ³•">1D Winogradç®—æ³•</h2><p>1ç»´å·ç§¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(2,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span> ä¸ºä¾‹ï¼Œè¾“å…¥ä¿¡å·<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>d</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>d</mi><mn>3</mn></msub><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">d=[d_0,d_1,d_2,d_3]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ï¼Œå·ç§¯æ ¸<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>g</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>g</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>g</mi><mn>2</mn></msub><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">g=[g_0,g_1,g_2]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ï¼Œåˆ™å·ç§¯å¯ä»¥å†™æˆå¦‚ä¸‹çŸ©é˜µä¹˜æ³•å½¢å¼ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>r</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>r</mi><mn>1</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">F(2,3)=\begin{bmatrix}   d_0 &amp; d_1 &amp; d_2 \\   d_1 &amp; d_2 &amp; d_3\end{bmatrix} \begin{bmatrix}   g_0 \\ g_1 \\ g_2 \\\end{bmatrix} = \begin{bmatrix}   r_0 \\ r_1\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>å¦‚æœè¿™ä¸ªè®¡ç®—è¿‡ç¨‹ä½¿ç”¨æ™®é€šçš„çŸ©é˜µä¹˜æ³•ï¼Œä¸€å…±éœ€è¦ <em><strong>6 æ¬¡ä¹˜æ³• å’Œ 4æ¬¡åŠ æ³•</strong></em>ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ï¼Œå·ç§¯è¿ç®—ä¸­è¾“å…¥ä¿¡å·è½¬æ¢å¾—åˆ°çš„çŸ©é˜µä¸æ˜¯ä»»æ„çŸ©é˜µï¼Œå…¶æœ‰è§„å¾‹çš„åˆ†å¸ƒç€å¤§é‡çš„é‡å¤å…ƒç´ ï¼Œä¾‹å¦‚<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">d_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">d_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€‚Winogradåšäº†å¦‚ä¸‹å˜æ¢ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>+</mo><msub><mi>m</mi><mn>2</mn></msub><mo>+</mo><mi>m</mi><mn>3</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>m</mi><mn>3</mn></msub><mo>âˆ’</mo><msub><mi>m</mi><mn>4</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">F(2,3)=\begin{bmatrix}   d_0 &amp; d_1 &amp; d_2 \\   d_1 &amp; d_2 &amp; d_3\end{bmatrix} \begin{bmatrix}   g_0 \\ g_1 \\ g_2 \\\end{bmatrix} = \begin{bmatrix}   m_1+m_2+m3 \\ m_2-m_3-m_4\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">m</span><span class="mord">3</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>d</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mn>0</mn></msub><mspace width="1em"><msub><mi>m</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>d</mi><mn>1</mn></msub><mo>+</mo><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>+</mo><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mspace linebreak="newline"></mspace><msub><mi>m</mi><mn>4</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>d</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>d</mi><mn>3</mn></msub><mo stretchy="false">)</mo><msub><mi>g</mi><mn>2</mn></msub><mspace width="1em"><msub><mi>m</mi><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>d</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>d</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mfrac><mrow><msub><mi>g</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>g</mi><mn>1</mn></msub><mo>+</mo><msub><mi>g</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac></mspace></mspace></mrow><annotation encoding="application/x-tex">m_1=(d_0-d_2)g_0 \quad m_2=(d_1+d_2)\frac{g_0+g_1+g_2}{2} \\m_4=(d_1-d_3)g_2 \quad m_3=(d_2-d_1)\frac{g_0-g_1+g_2}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.9463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.9463em;vertical-align:-0.686em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>åœ¨CNNçš„æ¨ç†é˜¶æ®µï¼Œå·ç§¯æ ¸ä¸Šçš„å…ƒç´ æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸Šå¼ä¸­å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>ç›¸å…³çš„å¼å­å¯ä»¥æå‰åœ¨æ¨¡å‹åˆå§‹åŒ–é˜¶æ®µç®—å¥½ï¼Œæ•´ä¸ªæ¨ç†é˜¶æ®µåªç”¨è®¡ç®—ä¸€æ¬¡ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥ã€‚æ‰€ä»¥è¿™é‡Œä¸€å…±éœ€è¦ <em><strong>4æ¬¡ä¹˜æ³• å’Œ 8æ¬¡åŠ æ³•</strong></em>ã€‚</p><p>ä¸Šé¢å…¶å®å°±æ˜¯<em>1Dçš„Winogradç®—æ³•</em>ï¼Œæˆ‘ä»¬å°†ä¸Šé¢çš„è®¡ç®—è¿‡ç¨‹å†™æˆçŸ©é˜µçš„å½¢å¼å¦‚ä¸‹ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><mi>g</mi><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mi>d</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Y=A^T[(Gg)\odot(B^Td)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mclose">)]</span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âŠ™</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">âŠ™</span></span></span></span>è¡¨ç¤ºelement-wise multiplicationï¼ˆHadamard productï¼‰ï¼Œå³å¯¹åº”ä½ç½®ç›¸ä¹˜æ“ä½œï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>è¡¨ç¤ºå·ç§¯æ ¸ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span>è¡¨ç¤ºè¾“å…¥ç‰¹å¾å›¾ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>è¡¨ç¤ºå·ç§¯æ ¸å˜æ¢çŸ©é˜µï¼Œå°ºå¯¸ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">(u+k-1)Ã—k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">B^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºè¾“å…¥å˜æ¢çŸ©é˜µï¼Œå°ºå¯¸ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(u+k-1)Ã—(u+k-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">A^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>è¡¨ç¤ºè¾“å‡ºå˜æ¢çŸ©é˜µï¼Œå°ºå¯¸ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo><mo>Ã—</mo><mi>u</mi></mrow><annotation encoding="application/x-tex">(u+k-1)Ã—u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>è¡¨ç¤ºè¾“å‡ºå°ºå¯¸ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>è¡¨ç¤ºå·ç§¯æ ¸å°ºå¯¸ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mo>=</mo><mo stretchy="false">(</mo><mi>u</mi><mo>+</mo><mi>k</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">su=(u+k-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºè¾“å…¥å°ºå¯¸ã€‚<br>å„çŸ©é˜µå…·ä½“å€¼å¦‚ä¸‹ï¼š</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>B</mi><mi>T</mi></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>G</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>A</mi><mi>T</mi></msup><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>g</mi><mo>=</mo><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>g</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>d</mi><mo>=</mo><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>0</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>d</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}&amp; B^T=\begin{bmatrix}   1 &amp; 0 &amp; -1 &amp; 0 \\   0 &amp; 1 &amp; 1 &amp; 0 \\   0 &amp; -1 &amp; 1 &amp; 0 \\   0 &amp; 1 &amp; 0 &amp; -1 \end{bmatrix} \\&amp; G=\begin{bmatrix}1 &amp; 0 &amp; 0 \\\frac{1}{2} &amp; \frac{1}{2} &amp; \frac{1}{2} \\\frac{1}{2} &amp; -\frac{1}{2} &amp; \frac{1}{2} \\0 &amp; 0 &amp; 1 \\\end{bmatrix} \\ &amp; A^T = \begin{bmatrix}   1 &amp; 1 &amp; 1 &amp; 0 \\   0 &amp; 1 &amp; -1 &amp; -1 \\\end{bmatrix} \\&amp; g = \begin{bmatrix}&amp; g_0 &amp; g_1 &amp; g_2\end{bmatrix}^T \\&amp; d = \begin{bmatrix}d_0 &amp; d_1 &amp; d_2 &amp; d_3\end{bmatrix}^T\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:16.3928em;vertical-align:-7.9464em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.4464em;"><span style="top:-10.4515em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"></span></span><span style="top:-5.3463em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"></span></span><span style="top:-1.4412em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"></span></span><span style="top:0.89em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"></span></span><span style="top:2.6313em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.9464em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.4464em;"><span style="top:-10.4515em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-5.3463em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6551em;"><span style="top:-4.8151em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.4049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.2049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1551em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6551em;"><span style="top:-4.8151em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.4049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.2049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1551em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6551em;"><span style="top:-4.8151em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.4049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.2049em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.1551em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-1.4412em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span><span style="top:0.89em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-2.85em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0812em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:2.6313em;"><span class="pstrut" style="height:4.6551em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0812em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:7.9464em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">B^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">A^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ä¸‰ä¸ªå˜æ¢çŸ©é˜µçš„æ¨å¯¼åŸç†åŠè¿‡ç¨‹å¯ä»¥å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/102351953">è¯¦è§£Winogradå˜æ¢çŸ©é˜µç”ŸæˆåŸç†</a> ã€‚å½“ç„¶ï¼Œgithubæœ‰ä¸ªå·¥å…·<a href="https://github.com/andravin/wincnn">wincnn</a>å¯ä»¥ç›´æ¥å¸®æˆ‘ä»¬è®¡ç®—ã€‚</p><h2 id="2D-Winogradç®—æ³•">2D Winogradç®—æ³•</h2><p>å°†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(2,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>æ‰©å±•åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mo>Ã—</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo>Ã—</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(2Ã—2, 3Ã—3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>ï¼Œå½¢è±¡çš„å±•ç¤ºå¦‚ä¸‹å›¾ï¼š</p><p><img src="/2021/11/16/AI-Algorithm-4-Winograd/1.png" alt="1"></p><p>ä¸Šå›¾ä¸­æœ€åå¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>0</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_0...M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">...</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>çš„æ“ä½œä¸º4æ¬¡çŸ©é˜µåŠ æ³•å’Œ4æ¬¡çŸ©é˜µä¹˜æ³•ï¼Œç”±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>0</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_0...M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">...</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å¾—åˆ°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>R</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>1</mn></msub><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[R_0, R_1]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>ä¸º4æ¬¡çŸ©é˜µåŠ æ³•ï¼ŒåŒæ ·<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span>çŸ©é˜µçš„è½¬æ¢çš„è®¡ç®—é‡å¿½ç•¥ä¸è®¡ã€‚</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>0...3</mn></msub></mrow><annotation encoding="application/x-tex">K_{0...3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0...3</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¹‹é—´çš„4æ¬¡çŸ©é˜µåŠ æ³•ï¼Œ æ¯æ¬¡å®é™…ä¸º4æ¬¡åŠ æ³•ï¼ˆæ³¨æ„ä¸è¦è¢«ä¸Šé¢æ‰©å±•åçš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span>çŸ©é˜µåˆ’åˆ†çš„å°æ–¹å—ä¸­6ä¸ªå…ƒç´ æ‰€è¿·æƒ‘ï¼Œå…¶ä¸­æœ‰é‡å¤çš„å…ƒç´ ï¼‰ï¼Œå…±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>4</mn><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">4Ã—4=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>æ¬¡åŠ æ³•ï¼›</li><li>4æ¬¡çŸ©é˜µä¹˜æ³•å¯ä»¥è½¬æ¢ä¸º4æ¬¡ <em><strong>1D Winograd</strong></em> æ¥è®¡ç®—ï¼Œæ¯æ¬¡ <em><strong>1D Winograd</strong></em> è®¡ç®—ä¸­æœ‰4æ¬¡ä¹˜æ³•ï¼Œ8æ¬¡åŠ æ³•ï¼Œå…±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>4</mn><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">4Ã—4=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>æ¬¡ä¹˜æ³•ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>8</mn><mo>=</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">4Ã—8=32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span></span></span></span>æ¬¡åŠ æ³•ï¼›</li><li>æœ€å<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>0</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_0...M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">...</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¹‹é—´çš„4æ¬¡çŸ©é˜µåŠ æ³•ï¼Œç”±äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>çŸ©é˜µçš„å°ºå¯¸ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2Ã—1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>ï¼Œæ‰€ä»¥å…±<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo><mn>2</mn><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">4Ã—2=8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">8</span></span></span></span>æ¬¡åŠ æ³•ï¼›<br>ç»¼ä¸Šï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mo>Ã—</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo>Ã—</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(2Ã—2, 3Ã—3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>çš„Winogradç®—æ³•å…± <em><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="OrangeRed"><mn>16</mn><mtext>æ¬¡ä¹˜æ³•å’Œ</mtext><mn>56</mn><mtext>æ¬¡åŠ æ³•</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{OrangeRed}16 æ¬¡ä¹˜æ³• å’Œ 56æ¬¡åŠ æ³•</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="color:OrangeRed;">16</span><span class="mord cjk_fallback" style="color:OrangeRed;">æ¬¡ä¹˜æ³•å’Œ</span><span class="mord" style="color:OrangeRed;">56</span><span class="mord cjk_fallback" style="color:OrangeRed;">æ¬¡åŠ æ³•</span></span></span></span></strong></em>ï¼Œå¦‚æœä½¿ç”¨å¸¸è§„å·ç§¯è¿ç®—ï¼Œåˆ™éœ€è¦ <em><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="OrangeRed"><mn>36</mn><mtext>æ¬¡ä¹˜æ³•å’Œ</mtext><mn>32</mn><mtext>æ¬¡åŠ æ³•</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{OrangeRed}36 æ¬¡ä¹˜æ³• å’Œ 32æ¬¡åŠ æ³•</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord" style="color:OrangeRed;">36</span><span class="mord cjk_fallback" style="color:OrangeRed;">æ¬¡ä¹˜æ³•å’Œ</span><span class="mord" style="color:OrangeRed;">32</span><span class="mord cjk_fallback" style="color:OrangeRed;">æ¬¡åŠ æ³•</span></span></span></span></strong></em></li></ul><p>ä¸Šé¢çš„è®¡ç®—è¿‡ç¨‹å†™æˆçŸ©é˜µçš„å½¢å¼å¦‚ä¸‹</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Y</mi><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">[</mo><mi>G</mi><mi>g</mi><msup><mi>G</mi><mi>T</mi></msup><mo stretchy="false">]</mo><mo>âŠ™</mo><mo stretchy="false">[</mo><msup><mi>B</mi><mi>T</mi></msup><mi>d</mi><mi>B</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">Y = A^T[[GgG^T]\odot[B^TdB]]A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[[</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]]</span><span class="mord mathnormal">A</span></span></span></span></span></p><h2 id="1D-åˆ°-2Dçš„-å…¬å¼æ¨å¯¼">1D åˆ° 2Dçš„ å…¬å¼æ¨å¯¼</h2><blockquote><p>çº¦å®šï¼šå¤§å†™å­—æ¯æˆ–å°å†™å­—æ¯åŠ ä¸Šç®­å¤´å‡ä»£è¡¨çŸ©é˜µæˆ–å‘é‡ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">K_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="true">â†’</mo></mover></mrow><annotation encoding="application/x-tex">\overrightarrow{d_0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3664em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>å‡è¡¨ç¤ºè¾“å…¥çŸ©é˜µçš„ç¬¬ä¸€è¡Œï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">W_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ä¸<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true">â†’</mo></mover></mrow><annotation encoding="application/x-tex">\overrightarrow{k_0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3664em;vertical-align:-0.15em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>å‡è¡¨ç¤ºå·ç§¯æ ¸çš„ç¬¬ä¸€è¡Œ</p><p>è¿™é‡Œæ²¿ç”¨2D Winogradæ¨å¯¼ä¸­çš„å­—æ¯è¡¨ç¤ºï¼Œæœ€åä¼šè½¬ä¸º1D Winogradæ¨å¯¼ä¸­çš„å­—æ¯è¡¨ç¤º</p></blockquote><p>é¦–å…ˆå¯¹ä¸Šè¿°å…¬å¼è¿›è¡Œé‡æ’ï¼Œè¾“å‡ºä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>Ã—</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2Ã—2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>çŸ©é˜µï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>R</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><msub><mi>M</mi><mn>0</mn></msub><mo>+</mo><msub><mi>M</mi><mn>1</mn></msub><mo>+</mo><mi>M</mi><mn>2</mn><mo separator="true">,</mo><msub><mi>M</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>M</mi><mn>2</mn></msub><mo>âˆ’</mo><mi>M</mi><mn>3</mn><mo stretchy="false">]</mo><mspace linebreak="newline"></mspace><mo>=</mo><mo stretchy="false">[</mo><msub><mi>M</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>3</mn></msub><mo stretchy="false">]</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mi>M</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>3</mn></msub><mo stretchy="false">]</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">[R_0,R_1] = [M_0+M_1+M2, M_1-M_2-M3] \\= [M_0,M_1,M_2,M_3]\begin{bmatrix}1 &amp; 0 \\1 &amp; 1 \\1 &amp; -1 \\0 &amp; -1\end{bmatrix} = [M_0,M_1,M_2,M_3]A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">3</span><span class="mclose">]</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.8001em;vertical-align:-2.15em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord mathnormal">A</span></span></span></span></span></p><p>ç»“åˆä¸Šé¢è®¡ç®—ä»£å…¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">M_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>å¾—ä¸‹å¼ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msub><mi>R</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo>=</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">[</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><msub><mi>W</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><mfrac><mrow><msub><mi>W</mi><mn>0</mn></msub><mo>+</mo><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><mfrac><mrow><msub><mi>W</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><msub><mi>W</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">]</mo><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">[</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><msub><mi>W</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><mfrac><mrow><msub><mi>W</mi><mn>0</mn></msub><mo>+</mo><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><mfrac><mrow><msub><mi>W</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><msub><mi>W</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">(</mo><msub><mi>K</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">]</mo><mi>A</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}&amp; [R_0,R_1] = \\ &amp; \bigg[A^T[(GW_0)\odot(B^T(K_0-K_2))],A^T[(G\frac{W_0+W_1+W_2}{2})\odot(B^T(K_1+K_2))],\\&amp; A^T[(G\frac{W_0-W_1+W_2}{2})\odot(B^T(K_2-K_1))],A^T[(GW_2)\odot(B^T(K_1-K_3))]\bigg]A \\&amp; = A^T\bigg[[(GW_0)\odot(B^T(K_0-K_2))],[(G\frac{W_0+W_1+W_2}{2})\odot(B^T(K_1+K_2))],\\&amp; [(G\frac{W_0-W_1+W_2}{2})\odot(B^T(K_2-K_1))],[(GW_2)\odot(B^T(K_1-K_3))]\bigg]A \\\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:12.3001em;vertical-align:-5.9001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.4001em;"><span style="top:-9.0101em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"></span></span><span style="top:-6.9001em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"></span></span><span style="top:-4.2em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"></span></span><span style="top:1.2em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:5.9001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:6.4001em;"><span style="top:-9.0101em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span><span style="top:-6.9001em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mpunct">,</span></span></span><span style="top:-4.2em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mord"><span class="delimsizing size3">]</span></span><span class="mord mathnormal">A</span></span></span><span style="top:-1.5em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">[</span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mpunct">,</span></span></span><span style="top:1.2em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))]</span><span class="mord"><span class="delimsizing size3">]</span></span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:5.9001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>ç”±äºhadamard productï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âŠ™</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">âŠ™</span></span></span></span>ï¼‰å’Œconcatï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3em;vertical-align:-0.1944em;"></span><span class="mpunct">,</span></span></span></span>ï¼‰æ“ä½œå¯ä»¥äº¤æ¢è€Œä¸å½±å“ç»“æœï¼Œå› æ­¤ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo stretchy="false">[</mo><msub><mi>R</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>R</mi><mn>1</mn></msub><mo stretchy="false">]</mo><mo>=</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>A</mi><mi>T</mi></msup><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">[</mo><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">[</mo><msub><mi>W</mi><mn>0</mn></msub><mo separator="true">,</mo><mfrac><mrow><msub><mi>W</mi><mn>0</mn></msub><mo>+</mo><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo separator="true">,</mo><mfrac><mrow><msub><mi>W</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>W</mi><mn>2</mn></msub></mrow><mn>2</mn></mfrac><mo separator="true">,</mo><msub><mi>W</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">[</mo><msub><mi>K</mi><mn>0</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>1</mn></msub><mo>+</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>2</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>1</mn></msub><mo>âˆ’</mo><msub><mi>K</mi><mn>3</mn></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">]</mo><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">[</mo><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">[</mo><msub><mi>W</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>W</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>W</mi><mn>2</mn></msub><mo stretchy="false">]</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">[</mo><msub><mi>K</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>K</mi><mn>3</mn></msub><mo stretchy="false">]</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">]</mo><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">[</mo><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">[</mo><mover accent="true"><msub><mi>k</mi><mn>0</mn></msub><mo stretchy="true">â†’</mo></mover><mo separator="true">,</mo><mover accent="true"><msub><mi>k</mi><mn>1</mn></msub><mo stretchy="true">â†’</mo></mover><mo separator="true">,</mo><mover accent="true"><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="true">â†’</mo></mover><mo stretchy="false">]</mo><msup><mi>G</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mover accent="true"><msub><mi>d</mi><mn>0</mn></msub><mo stretchy="true">â†’</mo></mover><mo separator="true">,</mo><mover accent="true"><msub><mi>d</mi><mn>1</mn></msub><mo stretchy="true">â†’</mo></mover><mo separator="true">,</mo><mover accent="true"><msub><mi>d</mi><mn>2</mn></msub><mo stretchy="true">â†’</mo></mover><mo separator="true">,</mo><mover accent="true"><msub><mi>d</mi><mn>3</mn></msub><mo stretchy="true">â†’</mo></mover><mo stretchy="false">]</mo><mi>B</mi><mo stretchy="false">)</mo><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">]</mo><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><mi>K</mi><msup><mi>G</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mi>D</mi><mi>B</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mi>A</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}&amp; [R_0,R_1] = \\ &amp; A^T\bigg[(G[W_0, \frac{W_0+W_1+W_2}{2}, \frac{W_0-W_1+W_2}{2}, W_2])\odot(B^T[K_0-K_2, K_1+K_2, K_2-K_1, K_1-K_3])\bigg]A \\&amp; =A^T\bigg[(G[W_0,W_1,W_2]\begin{bmatrix}1 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 0 \\0 &amp; \frac{1}{2} &amp; -\frac{1}{2} &amp; 0 \\0 &amp; \frac{1}{2} &amp; \frac{1}{2} &amp; 1\end{bmatrix}) \odot(B^T[K_0,K_1,K_2,K_3]\begin{bmatrix}1 &amp; 0 &amp; 0 &amp; 0 \\0 &amp; 1 &amp; -1 &amp; 1 \\-1 &amp; 1 &amp; 1 &amp; 0 \\0 &amp; 0 &amp; 0 &amp; -1\end{bmatrix}) \bigg]A \\&amp; = A^T\bigg[(G[\overrightarrow{k_0},\overrightarrow{k_1},\overrightarrow{k_2}]G^T)\odot(B^T[\overrightarrow{d_0},\overrightarrow{d_1},\overrightarrow{d_2},\overrightarrow{d_3}]B) \bigg]A \\&amp; = A^T[(GKG^T)\odot(B^TDB)]A\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:13.5515em;vertical-align:-6.5257em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.0257em;"><span style="top:-10.8358em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"></span></span><span style="top:-8.7258em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"></span></span><span style="top:-4.8257em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"></span></span><span style="top:-0.9257em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"></span></span><span style="top:1.2157em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:6.5257em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.0257em;"><span style="top:-10.8358em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"><span class="mord"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span><span style="top:-8.7258em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">[</span></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">])</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">])</span><span class="mord"><span class="delimsizing size3">]</span></span><span class="mord mathnormal">A</span></span></span><span style="top:-4.8257em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">[</span></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0577em;"><span style="top:-4.2126em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0074em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8023em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5577em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0577em;"><span style="top:-4.2126em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.0074em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.8023em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5577em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0577em;"><span style="top:-4.2126em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.0074em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.8023em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5577em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0577em;"><span style="top:-4.2126em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0074em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8023em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.5577em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-2.25em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-3.397em;"><span class="pstrut" style="height:3.155em;"></span><span style="height:0.016em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="0.016em" style="width:0.6667em" viewbox="0 0 666.67 16" preserveaspectratio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05em;"><span class="pstrut" style="height:3.155em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â£</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-1.711em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¦</span></span></span><span style="top:-2.858em;"><span class="pstrut" style="height:3.216em;"></span><span style="height:1.216em;width:0.6667em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.6667em" height="1.216em" style="width:0.6667em" viewbox="0 0 666.67 1216" preserveaspectratio="xMinYMin"><path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"/></svg></span></span><span style="top:-4.7111em;"><span class="pstrut" style="height:3.216em;"></span><span class="delimsizinginner delim-size4"><span>â¤</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="delimsizing size3">]</span></span><span class="mord mathnormal">A</span></span></span><span style="top:-0.9257em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size3">[</span></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mopen">[</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2164em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6944em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewbox="0 0 400000 522" preserveaspectratio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mclose">]</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size3">]</span></span><span class="mord mathnormal">A</span></span></span><span style="top:1.2157em;"><span class="pstrut" style="height:4.65em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)]</span><span class="mord mathnormal">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:6.5257em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h2 id="å·¥ç¨‹åº”ç”¨è§’åº¦çœ‹">å·¥ç¨‹åº”ç”¨è§’åº¦çœ‹</h2><p>Winogradç®—æ³•å¯ä»¥åˆ†ä¸º4ä¸ªæ­¥éª¤ï¼š</p><ul><li><ol><li>åˆå§‹åŒ–æœŸé—´å®Œæˆå·ç§¯æ ¸çš„å˜æ¢<code>weightTransform</code>ï¼Œå³ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>K</mi><msup><mi>G</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">GKG^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></li></ol></li><li><ol start="2"><li>è¿è¡ŒæœŸé—´å®Œæˆè¾“å…¥æ•°æ®çš„å˜æ¢<code>sourceTransform</code>ï¼Œå³ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mi>T</mi></msup><mi>D</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">B^TDB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></li></ol></li><li><ol start="3"><li>è¿è¡ŒæœŸé—´å®Œæˆè¾“å…¥æ•°æ®ä¸æƒé‡çš„<code>MatMul</code>ï¼Œå³ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>G</mi><mi>K</mi><msup><mi>G</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mi>D</mi><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(GKG^T)\odot(B^TDB)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></li></ol></li><li><ol start="4"><li>è¿è¡ŒæœŸé—´å®Œæˆè¾“å‡ºæ•°æ®çš„å˜æ¢<code>dstTransform</code>ï¼Œå³ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>G</mi><mi>K</mi><msup><mi>G</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mo>âŠ™</mo><mo stretchy="false">(</mo><msup><mi>B</mi><mi>T</mi></msup><mi>D</mi><mi>B</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">A^T[(GKG^T)\odot(B^TDB)]A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âŠ™</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">)]</span><span class="mord mathnormal">A</span></span></span></span></li></ol></li></ul><h1>å…³äºè®¡ç®—é‡çš„è®¨è®º</h1><p>å…³äº1D Winogradï¼Œ ç½‘ä¸Šæœ€å¸¸è§çš„è§£é‡Šæ˜¯ï¼šç›¸æ¯”äºæ™®é€šçš„çŸ©é˜µä¹˜æ³•ï¼Œä½¿ç”¨Winogradç®—æ³•ä¹‹åä¹˜æ³•æ¬¡æ•°å‡å°‘2æ¬¡ï¼ŒåŠ æ³•æ¬¡æ•°å¢å¤š4æ¬¡ï¼Œå®é™…ä½¿ç”¨ä¸­ï¼Œä¹˜æ³•æŒ‡ä»¤å‘¨æœŸæ¯”åŠ æ³•è¦é•¿ï¼Œé€šä¿—æ¥è®²Winogradå°±æ˜¯å‡å°‘ä¹˜æ³•æ“ä½œï¼Œç”¨æ›´å¿«çš„åŠ æ³•æ“ä½œæ¥è¾¾åˆ°åŠ é€Ÿç›®çš„ã€‚</p><p>ä½†æ˜¯è¿™æ ·çš„è§£é‡Šæ˜¯æœ‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="OrangeRed"><mtext>å±€é™æ€§</mtext></mstyle></mrow><annotation encoding="application/x-tex">\color{OrangeRed}å±€é™æ€§</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback" style="color:OrangeRed;">å±€é™æ€§</span></span></span></span>çš„ï¼š</p><h2 id="å…¶ä»–åˆ†å—æƒ…å†µ">å…¶ä»–åˆ†å—æƒ…å†µ</h2><ul><li>é¦–å…ˆï¼Œä¸Šæ–‡ä¸­åˆ—ä¸¾çš„æ˜¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(2,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>çš„æƒ…å†µï¼ŒæŸ¥çœ‹å˜æ¢çŸ©é˜µå¾—åˆ°ï¼Œè¯¥æƒ…å†µä¸‹çš„è¾“å…¥ã€è¾“å‡ºå˜æ¢çŸ©é˜µï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>ï¼‰ç³»æ•°é0å³1ï¼ˆ-1ï¼‰ï¼Œæ­¤ç§æƒ…å†µä¸‹ç¡®å®ä¸éœ€è¦ä¹˜æ³•ã€‚</li><li>ä½†å¯¹äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>4</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(4,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>ï¼Œæˆ–è€…<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mn>6</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(6,3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span>ç­‰blockæ›´å¤§æƒ…å†µï¼Œå˜æ¢çŸ©é˜µä¸­å­˜åœ¨å¾ˆå¤šé0å’Œ1çš„ç³»æ•°ï¼Œå•ç‹¬çš„MatMulä¹˜æ³•è®¡ç®—æ˜¯å‡å°‘äº†ï¼Œä½†æ˜¯å¼•å…¥äº†é¢å¤–çš„è¾“å…¥ã€è¾“å‡ºå˜æ¢ä¸­éœ€è¦çš„ä¹˜æ³•ï¼Œä¼šå­˜åœ¨ä¹˜æ³•æ¬¡æ•°å˜å¤šçš„æƒ…å†µï¼Œè¿™ä¸ªåœ¨åŸå§‹è®ºæ–‡ä¸­ä¹Ÿæœ‰æåŠã€‚</li></ul><h2 id="CPUæ¶æ„">CPUæ¶æ„</h2><ul><li>å…¶æ¬¡ï¼Œå…³äºæµ®ç‚¹ä¹˜æ³•æ¯”æµ®ç‚¹åŠ æ³•æŒ‡ä»¤å‘¨æœŸé•¿çš„é—®é¢˜ï¼Œè¿™ä¸ªåœ¨æ—§çš„CPUæ¶æ„ä¸‹ä¼šå­˜åœ¨ï¼Œä½†æ˜¯ç›®å‰ä½¿ç”¨çš„CPUæ¶æ„ä¸‹ï¼Œæµ®ç‚¹çš„ä¹˜æ³•å’ŒåŠ æ³•æŒ‡ä»¤å‘¨æœŸæ˜¯ä¸€æ ·çš„ã€‚<br>æ¯”å¦‚X86ç«¯ Intel CPUï¼Œä»ç¬¬5ä»£Broadwellæ¶æ„å¼€å§‹ï¼Œä¸¤è€…çš„å»¶è¿Ÿå°±æ²¡æœ‰å·®åˆ«äº†ï¼Œåœ¨intel core i7 9700 CPUï¼ˆCoffee lake ç¬¬9ä»£ï¼‰ä¸Šæµ‹è¯•SSEæŒ‡ä»¤é›†çš„æµ®ç‚¹ä¹˜æ³•å’ŒåŠ æ³•ï¼Œç»è¿‡å®æµ‹ï¼Œä¸¤è€…æ€§èƒ½ç¡®å®æ²¡æœ‰å·®å¼‚ã€‚</li><li>SSEæŒ‡ä»¤é›†<a href="https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html#expand=3416&amp;ig_expand=153,153&amp;techs=SSE">SIMDåŠ æ³•</a>å’Œ<a href="https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html#expand=3416&amp;ig_expand=153,153,4911&amp;techs=SSE&amp;text=mul">SIMDä¹˜æ³•</a>çš„å¯¹æ¯”å¯ä»¥ç‚¹å‡»è·³è½¬æ‰‹å†ŒæŸ¥çœ‹ï¼›</li><li>å…³äºSSEæŒ‡ä»¤é›†ä¸­æ‰€åˆ—å‡ºçš„ä¸¤ä¸ªå±æ€§<code>latencyï¼ˆå»¶è¿Ÿï¼‰</code>å’Œ<code>throughputï¼ˆCPIï¼‰ååé‡</code>çš„å…·ä½“å«ä¹‰å¯ä»¥çœ‹<a href="https://blog.csdn.net/Johnsonjjj/article/details/109790335">è¿™é‡Œ</a>ï¼Œæˆ‘çš„ç†è§£å°±æ˜¯ï¼š<ul><li>latencyå°±æ˜¯å®Œæˆä¸€æ¡æŒ‡ä»¤æ‰€éœ€è¦çš„æ—¶é—´ï¼Œå³ç”Ÿæˆç»“æœçš„æŒ‡ä»¤ä¸ä½¿ç”¨è¯¥ç»“æœçš„æŒ‡ä»¤ä¹‹é—´çš„å‘¨æœŸæ•°ï¼Œæ¯”å¦‚Broadwellæ¶æ„ä¸‹<code>_mm_add_ps</code>æµ®ç‚¹åŠ æ³•çš„latencyä¸º3ï¼Œåˆ™è¡¨ç¤ºï¼ˆåœ¨ä¸å‘ç”ŸRAWå†’é™©ï¼ˆæ•°æ®å†’é™©çš„ä¸€ç§ï¼Œå†™åè¯»å†’é™©ï¼‰çš„æƒ…å†µä¸‹ï¼‰æœ€å¿«ä¹Ÿè¦3ä¸ªå‘¨æœŸï¼Œå…¶ä»–æŒ‡ä»¤æ‰èƒ½è·å¾—æµ®ç‚¹åŠ æ³•çš„è¿ç®—ç»“æœã€‚</li><li>throughputååé‡ï¼Œåˆç§°CPIï¼ˆcycle per instructionï¼Œæ¯æŒ‡ä»¤å‘¨æœŸæ•°ï¼‰ï¼Œæ˜¯å‘å°„ä¸€æ¡æŒ‡ä»¤æ‰€éœ€è¦çš„æ—¶é’Ÿå‘¨æœŸæ•°ï¼Œæ¯”å¦‚Broadwellæ¶æ„ä¸‹<code>_mm_mul_ps</code>æµ®ç‚¹ä¹˜æ³•çš„throughputä¸º0.5ï¼Œåˆ™è¡¨ç¤ºä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…å¯ä»¥å‘å°„2æ¡æµ®ç‚¹ä¹˜æ³•æŒ‡ä»¤ã€‚</li><li>æ¯”å–»ä¸€ä¸‹ï¼šå»¶è¿Ÿ=æ°´ç®¡ä¸­æ°´çš„æµé€Ÿï¼Œååé‡=æ°´ç®¡çš„ç²—ç»†</li></ul></li></ul><h2 id="è€ƒè™‘å¤šé€šé“è¾“å…¥è¾“å‡º">è€ƒè™‘å¤šé€šé“è¾“å…¥è¾“å‡º</h2><p>å®é™…è¦è€ƒè™‘å·ç§¯ä¸­çš„è¾“å…¥é€šé“æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">IC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ï¼Œè¾“å‡ºé€šé“æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">OC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span></span></span></span>ã€‚å› ä¸ºè¾“å…¥å˜æ¢åªä¸<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">IC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>æœ‰å…³ï¼Œè¾“å‡ºå˜æ¢åªä¸<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">OC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span></span></span></span>æœ‰å…³ã€‚è€Œæ™®é€šæ»‘çª—å·ç§¯è®¡ç®—ä¸<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">IC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">OC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span></span></span></span>å‡ç›¸å…³ã€‚</p><p>å®Œæ•´çš„è®¡ç®—é‡å¯¹æ¯”ï¼š</p><ul><li><p>æ™®é€šå·ç§¯ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>O</mi><mi>r</mi><mi>i</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mi>O</mi><mi>W</mi><mo>âˆ—</mo><mi>O</mi><mi>H</mi><mo>âˆ—</mo><mi>O</mi><mi>C</mi><mo stretchy="false">(</mo><mn>2</mn><mo>âˆ—</mo><mi>I</mi><mi>C</mi><mo>âˆ—</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mi>X</mi><mo>âˆ—</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mi>Y</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">OriginalCost = OW*OH*OC(2*IC*kernelX*kernelY-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">ina</span><span class="mord mathnormal" style="margin-right:0.07153em;">lC</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.07847em;">lX</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p></li><li><p>Winogradå·ç§¯ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>S</mi><mi>r</mi><mi>c</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mn>2</mn><mo>âˆ—</mo><mi>s</mi><mi>u</mi><mo>âˆ—</mo><mi>M</mi><mo>âˆ—</mo><mi>I</mi><mi>C</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>M</mi><mi>a</mi><mi>t</mi><mi>M</mi><mi>u</mi><mi>l</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mi>s</mi><mi>u</mi><mo>âˆ—</mo><mi>s</mi><mi>u</mi><mo>âˆ—</mo><mi>I</mi><mi>C</mi><mo>âˆ—</mo><mi>O</mi><mi>C</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>D</mi><mi>s</mi><mi>t</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><mi>s</mi><mi>u</mi><mo>+</mo><mi>u</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><mi>N</mi><mo>âˆ—</mo><mi>O</mi><mi>C</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>W</mi><mi>i</mi><mi>n</mi><mi>o</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><mi>S</mi><mi>r</mi><mi>c</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>+</mo><mi>M</mi><mi>a</mi><mi>t</mi><mi>M</mi><mi>u</mi><mi>l</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>+</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>T</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>f</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>O</mi><mi>W</mi><mi mathvariant="normal">/</mi><mi>u</mi><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>O</mi><mi>H</mi><mi mathvariant="normal">/</mi><mi>u</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}&amp; SrcTransformCost = 2*su*M*IC \\&amp; MatMulCost = su*su*IC*OC \\&amp; DstTransformCost = (su+u)*N*OC \\&amp; WinogradCost = (SrcTransformCost+MatMulCost+DstTransformCost)*(OW/u)*(OH/u)\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span><span style="top:-0.75em;"><span class="pstrut" style="height:2.84em;"></span><span class="mord"></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">rc</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.10903em;">tM</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.07153em;">lC</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal" style="margin-right:0.13889em;">tT</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span></span></span><span style="top:-0.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal">Win</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">rc</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.10903em;">tM</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.07153em;">lC</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal" style="margin-right:0.13889em;">tT</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">an</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal">os</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord">/</span><span class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord">/</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>å…¶ä¸­ï¼š</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>8</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">u\in[2,8]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">8</span><span class="mclose">]</span></span></span></span>è¡¨ç¤º<strong>å•ä¸ªå—</strong>çš„è¾“å‡ºå°ºå¯¸<code>Unit</code>ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>u</mi><mo>=</mo><mi>u</mi><mo>+</mo><mi>k</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">su=u+kernel-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.02778em;">er</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>è¡¨ç¤º<strong>å•ä¸ªå—</strong>çš„è¾“å…¥å°ºå¯¸<code>Source Unit</code>ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>âˆˆ</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>s</mi><mi>u</mi><mo>âˆ—</mo><mi>s</mi><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M\in(0,su*su)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºè¾“å…¥å˜æ¢ä¸­ä¸€è¡Œå…ƒç´ çš„ä¹˜åŠ æ¬¡æ•°ï¼›</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>âˆˆ</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>s</mi><mi>u</mi><mo>âˆ—</mo><mi>s</mi><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N\in(0,su*su)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mclose">)</span></span></span></span>è¡¨ç¤ºè¾“å‡ºå˜æ¢ä¸­ä¸€è¡Œå…ƒç´ çš„ä¹˜åŠ æ¬¡æ•°ã€‚</li></ul></li></ul><p>è€ƒè™‘åˆ°è½¬æ¢çŸ©é˜µçš„ç¨€ç–æ€§ï¼ˆå³å­˜åœ¨0å’Œ1ï¼ˆ-1ï¼‰ï¼‰ï¼Œå› æ­¤ä¸Šé¢çš„<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>å’Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>å€¼ä¸ <code>Unit</code>çš„é€‰å–ç›¸å…³ä¸”ä¸ºå®šå€¼ã€‚è‡³äº<code>Uint</code>å¦‚ä½•ç¡®å®šï¼Œæ”¾åˆ°ä¸‹ä¸€ç¯‡æ¥è®²ã€‚</p><p>æ ¹æ®å¯¹ä¸åŒ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">IC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">OC</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span></span></span></span>éå†å®æµ‹ï¼Œå°±ä¹˜åŠ æ¬¡æ•°è€Œè¨€ï¼Œä»…å½“<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>C</mi><mtext>æˆ–</mtext><mi>O</mi><mi>C</mi><mo>â‰¤</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">ICæˆ–OCâ‰¤2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.136em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord cjk_fallback">æˆ–</span><span class="mord mathnormal" style="margin-right:0.07153em;">OC</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>çš„ä¸ªåˆ«æƒ…å†µä¸‹ï¼ˆå®é™…åº”ç”¨ä¸­ï¼Œé€šé“&lt;=2çš„å·ç§¯æƒ…å†µéå¸¸å°‘ï¼‰ï¼ŒWinogradåœ¨è®¡ç®—æ¬¡æ•°ä¸Šæ˜¯å¢åŠ çš„ï¼Œå…·ä½“å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç ç®€å•éªŒè¯ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">UnitTest</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> unit, <span class="keyword">const</span> <span class="keyword">int</span> &amp;st, <span class="keyword">const</span> <span class="keyword">int</span> &amp;dt, <span class="keyword">const</span> <span class="keyword">int</span> &amp;ic, <span class="keyword">const</span> <span class="keyword">int</span> &amp;oc, std::ofstream &amp;fout, <span class="keyword">int</span> kernel = <span class="number">3</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">float</span> original_cost = (<span class="keyword">float</span>)(<span class="number">2</span> * ic * kernel * kernel - <span class="number">1</span>) * oc;</span><br><span class="line">    <span class="keyword">float</span> src_transform_cost = <span class="number">2</span> * (unit + kernel - <span class="number">1</span>) * st * ic;</span><br><span class="line">    <span class="keyword">float</span> matmul_cost = (unit + kernel - <span class="number">1</span>) * (unit + kernel - <span class="number">1</span>) * ic * oc;</span><br><span class="line">    <span class="keyword">float</span> dst_transform_cost = (<span class="number">2</span> * unit + kernel - <span class="number">1</span>) * dt * oc;</span><br><span class="line">    <span class="keyword">float</span> winograd_cost = (src_transform_cost + matmul_cost + dst_transform_cost) / (unit * unit);</span><br><span class="line">    <span class="keyword">float</span> rate = original_cost / winograd_cost;</span><br><span class="line">    <span class="keyword">if</span> (rate &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;uint: %d, ic: %d, oc: %d, rate: %f\n&quot;</span>, unit, ic, oc, rate);</span><br><span class="line">    &#125;</span><br><span class="line">    fout &lt;&lt; <span class="string">&quot;unit:&quot;</span> &lt;&lt; unit &lt;&lt; <span class="string">&quot;, ic:&quot;</span> &lt;&lt; ic &lt;&lt; <span class="string">&quot;, oc:&quot;</span> &lt;&lt; oc &lt;&lt; <span class="string">&quot;, rate:&quot;</span> &lt;&lt; rate &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WinogradUnitTest3x3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::vector&lt;<span class="keyword">int</span>&gt; u = &#123; <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span> &#125;;</span><br><span class="line">    <span class="comment">// mul + add</span></span><br><span class="line">    std::vector&lt;<span class="keyword">int</span>&gt; st = &#123; <span class="number">0</span> + <span class="number">4</span>, <span class="number">10</span> + <span class="number">16</span>, <span class="number">30</span> + <span class="number">36</span> &#125;;</span><br><span class="line">    std::vector&lt;<span class="keyword">int</span>&gt; dt = &#123; <span class="number">0</span> + <span class="number">4</span>, <span class="number">2</span> + <span class="number">11</span>, <span class="number">10</span> + <span class="number">32</span> &#125;;</span><br><span class="line">    <span class="function">std::ofstream <span class="title">fout</span><span class="params">(<span class="string">&quot;unit_info.txt&quot;</span>)</span></span>;</span><br><span class="line">    <span class="comment">// unit</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; u.<span class="built_in">size</span>(); ++k) &#123;</span><br><span class="line">        <span class="comment">// input channel</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">64</span>; ++i) &#123;</span><br><span class="line">            <span class="comment">// output channel</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">64</span>; ++j) &#123;</span><br><span class="line">                <span class="built_in">UnitTest</span>(u[k], st[k], dt[k], i, j, fout);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fout.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>è‡´è°¢</h1><p>æ–‡ç« ä¸»ä½“æ¡†æ¶å‚è€ƒè‡ª<a href="https://github.com/yizhaoyanbo">ä¸œå“¥</a>çš„MNNæºç è§£è¯»çš„å†…éƒ¨åˆ†äº«ï¼ŒåŠ ä¸Šäº†è‡ªå·±çš„ä¸€äº›çœ‹æ³•ã€‚æœ‰å¹¸è¢«çœ‹åˆ°çš„è¯ï¼Œå¸Œæœ›èƒ½ç»™ç‚¹ä¸ªèµ~~</p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Winograd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIæ•°æ®é›† [1]ï¼šCOCOæ•°æ®é›†</title>
      <link href="/2021/11/16/AI-Dataset-1-coco/"/>
      <url>/2021/11/16/AI-Dataset-1-coco/</url>
      
        <content type="html"><![CDATA[<h1>ç®€ä»‹</h1><ul><li>MS COCOçš„å…¨ç§°æ˜¯Microsoft Common Objects in Contextï¼Œèµ·æºäºå¾®è½¯äº2014å¹´å‡ºèµ„æ ‡æ³¨çš„Microsoft COCOæ•°æ®é›†ï¼Œä¸ImageNetç«èµ›ä¸€æ ·ï¼Œè¢«è§†ä¸ºæ˜¯è®¡ç®—æœºè§†è§‰é¢†åŸŸæœ€å—å…³æ³¨å’Œæœ€æƒå¨çš„æ¯”èµ›ä¹‹ä¸€ã€‚</li><li>COCOæ•°æ®é›†æ˜¯ä¸€ä¸ªå¤§å‹çš„ã€ä¸°å¯Œçš„ç‰©ä½“æ£€æµ‹ï¼Œåˆ†å‰²å’Œå­—å¹•æ•°æ®é›†ã€‚è¿™ä¸ªæ•°æ®é›†ä»¥scene understandingä¸ºç›®æ ‡ï¼Œä¸»è¦ä»å¤æ‚çš„æ—¥å¸¸åœºæ™¯ä¸­æˆªå–ï¼Œå›¾åƒä¸­çš„ç›®æ ‡é€šè¿‡ç²¾ç¡®çš„segmentationè¿›è¡Œä½ç½®çš„æ ‡å®šã€‚å›¾åƒåŒ…æ‹¬91ç±»ç›®æ ‡ï¼Œ328,000å½±åƒå’Œ2,500,000ä¸ªlabelã€‚ç›®å‰ä¸ºæ­¢æœ‰è¯­ä¹‰åˆ†å‰²çš„æœ€å¤§æ•°æ®é›†ï¼Œæä¾›çš„ç±»åˆ«æœ‰80 ç±»ï¼Œæœ‰è¶…è¿‡33 ä¸‡å¼ å›¾ç‰‡ï¼Œå…¶ä¸­20 ä¸‡å¼ æœ‰æ ‡æ³¨ï¼Œæ•´ä¸ªæ•°æ®é›†ä¸­ä¸ªä½“çš„æ•°ç›®è¶…è¿‡150 ä¸‡ä¸ªã€‚</li></ul><h1>COCO API</h1><h2 id="install">install</h2><h3 id="clone">clone</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;workdir&gt;</span><br><span class="line">git <span class="built_in">clone</span> https://hub.fastgit.org/cocodataset/cocoapi.git</span><br></pre></td></tr></table></figure><h3 id="setup">setup</h3><ul><li>ç¼–è¯‘å¹¶å®‰è£…åˆ°æœ¬åœ°ï¼š</li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> cocoapi/PythonAPI/</span><br><span class="line">python setup.py build_ext --inplace</span><br></pre></td></tr></table></figure><ul><li>æŠ¥é”™å¦‚ä¸‹ï¼š</li></ul><blockquote><p>cl: å‘½ä»¤è¡Œ error D8021 :æ— æ•ˆçš„æ•°å€¼å‚æ•°â€œ/Wno-cppâ€</p></blockquote><ul><li><a href="http://xn--setup-hr2j95q.py">æ‰“å¼€setup.py</a>ï¼Œå°†ä¸‹é¢ä¸€è¡Œæ³¨é‡Šæ‰ï¼š</li></ul><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">extra_compile_args=[<span class="string">&#x27;-Wno-cpp&#x27;</span>,Â <span class="string">&#x27;-Wno-unused-function&#x27;</span>,Â <span class="string">&#x27;-std=c99&#x27;</span>],</span><br></pre></td></tr></table></figure><ul><li>å†æ¬¡æ‰§è¡Œï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</li></ul><blockquote><p>c1: fatal error C1083: æ— æ³•æ‰“å¼€æºæ–‡ä»¶: â€œpycocotools/_mask.câ€: No such file or directory</p></blockquote><ul><li>æœç´¢å¾—çŸ¥ç¼–è¯‘ä¾èµ–åº“ï¼šCython</li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip install Cython</span><br></pre></td></tr></table></figure><ul><li>å†æ¬¡æ‰§è¡Œï¼ŒæˆåŠŸï¼Œç»§ç»­æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼Œå®‰è£…åº“åˆ°pyhton site-packagesï¼š</li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pythonÂ setup.pyÂ build_extÂ install</span><br></pre></td></tr></table></figure><ul><li>å¦‚é‡åˆ°ä¾èµ–çš„æŸä¸ªåº“æ²¡æœ‰å®‰è£…ï¼Œåˆ™ä¼šé»˜è®¤ä»https://pypi.org/ä¸‹è½½ï¼Œä¼šå¾ˆæ…¢ï¼Œå¯ä»¥Ctrl+Cä¸­æ­¢ï¼Œè‡ªå·±æ‰§è¡Œpip installï¼ˆå‡è®¾è‡ªå·±å·²ç»é…ç½®è¿‡å›½å†…æºï¼‰<br>å®‰è£…æˆåŠŸåï¼Œç”¨jupyter notebook æ‰“å¼€ pycocoDemo.ipynbï¼Œæ‰§è¡Œç¬¬ä¸€æ®µimportåº“æ“ä½œï¼Œæ²¡æœ‰æŠ¥é”™åˆ™è¯´æ˜å®‰è£…æˆåŠŸã€‚</li></ul><h2 id="COCO-DataSet-Download">COCO DataSet Download</h2><h3 id="å®˜ç½‘ä¸‹è½½æ•°æ®é›†æ²¡ååº”">å®˜ç½‘ä¸‹è½½æ•°æ®é›†æ²¡ååº”</h3><p><img src="/2021/11/16/AI-Dataset-1-coco/1.png" alt="1"></p><ul><li>F12æ‰“å¼€ç½‘é¡µè°ƒè¯•ï¼Œè½¬åˆ°Consoleï¼Œå¯ä»¥çœ‹åˆ°é”™è¯¯ä¿¡æ¯ï¼Œæ„æ€æ˜¯åŸé“¾æ¥åœ°å€æ˜¯ä¸ªä¸å®‰å…¨çš„åœ°å€ï¼ŒHTTPè¦æ”¹æˆHTTPSï¼Œå¤åˆ¶é“¾æ¥ä¿®æ”¹åæ‹·è´åˆ°æµè§ˆå™¨ä¾¿å¯æˆåŠŸä¸‹è½½ï¼ˆç‚’é¸¡æ…¢ï¼‰ã€‚</li><li>å¥½åƒç›´æ¥ç‚¹å‡»consoleé‡Œé¢çš„ç½‘å€ä¹Ÿå¯ä»¥ä¸‹è½½ï¼Ÿ</li><li>ç½‘é¡µä¸‹è½½å¤ªæ…¢äº†ï¼Œè¯•äº†ä¸‹é¢çš„æ–¹æ³•ï¼š</li></ul><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">wget -c https://images.cocodataset.org/zips/val2017.zip --no-check-certificate</span><br></pre></td></tr></table></figure><ul><li><code>-c</code> æ–­ç‚¹ç»­ä¼ ï¼›</li><li><code>--no-check-certificate</code> å¯¹éå®‰å…¨ç½‘å€ä¸æ£€æŸ¥éªŒè¯</li><li>0.5-1M/sï¼Œä¹Ÿä¸æ˜¯å¾ˆå¿«ï¼Œä½†å¯ä»¥æ¥å—äº†ï¼ˆ ï¼š</li></ul><h3 id="è§£å‹">è§£å‹</h3><ul><li>åœ¨cocoapiæ ¹ç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹imageså’Œannotationsï¼Œå°†å›¾ç‰‡å’Œæ ‡æ³¨åˆ†åˆ«æ‹·è´åˆ°è¿™ä¸¤ä¸ªç›®å½•ä¸‹ï¼Œè§£å‹ï¼Œå›¾ç‰‡ä¿ç•™<code>val2017</code>è¿™ä¸€çº§å­ç›®å½•ï¼Œæ³¨é‡Šçš„jsonæ–‡ä»¶åˆ™ç›´æ¥æ”¾åœ¨annotationsæ–‡ä»¶å¤¹ä¸‹ï¼›</li><li>æ•°æ®å‡†å¤‡å®Œæ¯•ï¼ŒpycocoDemo.ipynbå¯ä»¥ä¸€è·¯æ‰§è¡Œä¸‹å»ï¼Œè§‚å¯ŸAPIçš„åŠŸèƒ½ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®é›† </tag>
            
            <tag> coco </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [3]ï¼šmAP</title>
      <link href="/2021/11/15/AI-Algorithm-3-mAP/"/>
      <url>/2021/11/15/AI-Algorithm-3-mAP/</url>
      
        <content type="html"><![CDATA[<h1>å‰è¨€</h1><ul><li><p><code>APï¼ˆAverage Precisionï¼Œå¹³å‡ç²¾åº¦ï¼‰</code>æ˜¯è¡¡é‡ç›®æ ‡æ£€æµ‹ç®—æ³•å¥½åçš„å¸¸ç”¨æŒ‡æ ‡ï¼Œåœ¨Faster R-CNNï¼ŒSSDç­‰ç®—æ³•ä¸­ä½œä¸ºè¯„ä¼°æŒ‡æ ‡ã€‚</p></li><li><p><code>AP</code>ç­‰äº<code>å¬å›ç‡ï¼ˆRecallï¼‰</code>å€¼å–0-1æ—¶ï¼Œå‡†ç¡®ç‡ï¼ˆprecisionï¼‰å€¼çš„å¹³å‡å€¼ã€‚</p></li></ul><h1>Precision</h1><ul><li>æ­£ç¡®é¢„æµ‹ç»“æœå æ‰€æœ‰é¢„æµ‹æ­£ä¾‹çš„ç™¾åˆ†æ¯”</li><li>æ¯”å¦‚ä½ é¢„æµ‹100ä¸ªå›¾ç‰‡æ˜¯è‹¹æœï¼Œå…¶ä¸­80ä¸ªçœŸçš„æ˜¯è‹¹æœï¼Œåˆ™Precision=0.8<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Precision=\frac{TP} {TP+FP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">FP</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul><h1>Recall</h1><ul><li>æ­£ç¡®é¢„æµ‹ç»“æœå æ‰€æœ‰äº‹å®æ­£ä¾‹çš„ç™¾åˆ†æ¯”</li><li>æ¯”å¦‚æ€»å…±æœ‰100ä¸ªå›¾ç‰‡æ˜¯è‹¹æœï¼Œä½ æˆåŠŸé¢„æµ‹äº†50ä¸ªï¼Œåˆ™Recall=0.5<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Recall=\frac{TP} {TP+FN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2757em;vertical-align:-0.4033em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8723em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FN</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4033em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></li></ul><h1>IoU</h1><ul><li>å‚è§<a href="https://no5-aaron-wu.github.io/2021/11/11/AI-Algorithm-1-mIoU/">mIoU</a>ç¬”è®°</li></ul><h1>AP</h1><p>ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºAPæ€ä¹ˆè®¡ç®—çš„</p><p><img src="/2021/11/15/AI-Algorithm-3-mAP/1.png" alt="1"></p><ul><li><ol><li>å…±è¿›è¡Œ10æ¬¡é¢„æµ‹ï¼Œç›´åˆ°recallä¸º1ä¸ºæ­¢ï¼›</li></ol></li><li><ol start="2"><li>ç¬¬äºŒåˆ—è¡¨ç¤ºé¢„æµ‹æ˜¯å¦æ­£ç¡®ï¼Œæ ‡å‡†å°±æ˜¯IoUâ‰¥0.5ï¼›</li></ol></li><li><ol start="3"><li>éšç€é¢„æµ‹è¿›è¡Œï¼Œrecallå€¼ä¼šä¸€ç›´å¢åŠ ï¼Œä½†precisionä¼šå…·æœ‰é”¯é½¿å½¢çŠ¶ï¼ˆFPä¸‹é™ï¼ŒTPä¸Šå‡ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼›</li></ol></li></ul><p><img src="/2021/11/15/AI-Algorithm-3-mAP/2.png" alt="2"></p><ul><li><ol start="4"><li>APä¸€èˆ¬å°±å®šä¹‰ä¸ºä»¥ä¸Šé”¯é½¿å½¢æ‰€åŒ…å«çš„é¢ç§¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>P</mi><mo>=</mo><msubsup><mo>âˆ«</mo><mn>0</mn><mn>1</mn></msubsup><mi>p</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mtext>d</mtext><mi>r</mi></mrow><annotation encoding="application/x-tex">AP=\int_{0}^{1}p(r)\text{d}r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3648em;vertical-align:-0.3558em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.009em;"><span style="top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.2579em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3558em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord text"><span class="mord">d</span></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>ï¼›</li></ol></li><li><ol start="5"><li>precision å’Œ recall æ€»æ˜¯åœ¨0-1ä¹‹é—´ï¼Œæ‰€ä»¥APä¹Ÿæ˜¯åœ¨0-1ä¹‹é—´ï¼›</li></ol></li><li><ol start="6"><li>é€šå¸¸ä¼šé¦–å…ˆå¯¹é”¯é½¿å½¢è¿›è¡Œå¹³æ»‘ï¼Œå°†æ¯ä¸ªprecisionå€¼æ›¿æ¢ä¸ºå…¶å³ä¾§æœ€å¤§çš„precisionå€¼ï¼Œä»è€Œä½¿å¾—æ›²çº¿å•è°ƒé€’å‡è€Œä¸æ˜¯å‘ˆç°é”¯é½¿å½¢ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å‡å°‘å› ä¸ºTPå‡ºç°çš„å…ˆåæ¬¡åºçš„å·®å¼‚å¯¼è‡´çš„æ³¢åŠ¨ï¼Œå¦‚ä¸‹ç»¿çº¿æ‰€ç¤ºï¼š</li></ol></li></ul><p><img src="/2021/11/15/AI-Algorithm-3-mAP/3.png" alt="3"></p><ul><li><ol start="7"><li>ç”¨å…¬å¼è¡¨ç¤ºä¸ºï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow><mover accent="true"><mi>r</mi><mo stretchy="true">~</mo></mover><mo>â‰¥</mo><mi>r</mi></mrow></msub><mrow><mi>p</mi><mo stretchy="false">(</mo><mover accent="true"><mi>r</mi><mo stretchy="true">~</mo></mover><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">p_{interp}(r)=max_{\widetilde{r}\geq{r}}{p(\widetilde{r})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3334em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6906em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span><span class="svg-align" style="width:calc(100% - 0.1111em);margin-left:0.1111em;top:-3.1306em;"><span class="pstrut" style="height:2.7em;"></span><span class="mtight" style="height:0.26em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mrel mtight">â‰¥</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2452em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6906em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span><span class="svg-align" style="width:calc(100% - 0.1111em);margin-left:0.1111em;top:-3.4306em;"><span class="pstrut" style="height:3em;"></span><span style="height:0.26em;"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.26em" viewbox="0 0 600 260" preserveaspectratio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128-68.267.847-113-73.952-191-73.952z"/></svg></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li></ol></li><li><ol start="8"><li>è¿›ä¸€æ­¥å¯ä»¥ç”¨<strong>11ç‚¹æ’å€¼</strong>æ–¹å¼è®¡ç®—APï¼š</li></ol></li></ul><p><img src="/2021/11/15/AI-Algorithm-3-mAP/4.png" alt="4"></p><ul><li><ol start="9"><li>å…¬å¼è¡¨ç¤ºä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>P</mi><mo>=</mo><mfrac><mn>1</mn><mn>11</mn></mfrac><msub><mo>âˆ‘</mo><mrow><mi>r</mi><mo>âˆˆ</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>0.1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow></mrow></msub><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>p</mi></mrow></msub><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">AP={\frac {1} {11}}\sum_{r\in{\{0,0.1,...,1\}}}{p_{interp}(r)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.3198em;vertical-align:-0.4747em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2253em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mopen mtight">{</span><span class="mord mtight">0</span><span class="mpunct mtight">,</span><span class="mord mtight">0.1</span><span class="mpunct mtight">,</span><span class="mord mtight">...</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span><span class="mclose mtight">}</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4747em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></span></li></ol></li></ul>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mAP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [2]ï¼šNC4HW4æ•°æ®æ’å¸ƒ</title>
      <link href="/2021/11/14/AI-Algorithm-2-NC4HW4/"/>
      <url>/2021/11/14/AI-Algorithm-2-NC4HW4/</url>
      
        <content type="html"><![CDATA[<h1>å‰è¨€</h1><ul><li>NC4HW4çš„æ•°æ®æ’å¸ƒå…¶å®å°±æ˜¯å’ŒRGBAè¿™ç§äº¤ç»‡çš„æ•°æ®æ’å¸ƒç±»ä¼¼</li></ul><h1>NCHW-&gt;NC4HW4</h1><ul><li>é¦–å…ˆbatchç»´åº¦å°±æ˜¯Nä¸å˜</li><li>ç„¶åæŠŠæ¯ä¸ªæ ·æœ¬æ‰€æœ‰feature mapæŒ‰æ¯å››ä¸ªé€šé“ä¸ºä¸€ç»„åˆ†æˆC/4ä¸ªç»„ï¼Œå¦‚æœé€šé“æ•°ä¸èƒ½æ•´é™¤4åˆ™è¡¥é½åˆ°4çš„å€æ•°ï¼Œè¡¥ä¸Šçš„feature mapå…¨å¡«0</li><li>ç„¶åæŠŠæ¯ç»„å†…çš„4ä¸ªfeature mapæŒ‰ç…§RGBAäº¤ç»‡çš„å½¢å¼é‡æ–°æ’åˆ—ä¸€ä¸‹å°±å¾—åˆ°NC4HW4çš„æ•°æ®äº†ã€‚</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/1.png" alt="1"></p><h1>ä¼˜ç‚¹</h1><ul><li>ä»¥å·ç§¯æ“ä½œä¸¾ä¾‹ï¼Œæ­¤å¤„åªè®¨è®ºæš´åŠ›æ–¹æ³•ï¼Œä¸æ¶‰åŠim2colï¼Œgemmï¼Œ winogradç­‰æ–¹æ³•ã€‚</li><li>å¯¹äºå·ç§¯æ“ä½œ, æ ¹æ®è®¡ç®—æœºå†…å­˜æ’å¸ƒç‰¹ç‚¹ï¼ŒæŒ‰è¡Œè¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œä¸€ä¸ªé€šé“çš„æ•°æ®ï¼Œè½¬å…¥ä¸‹ä¸€ä¸ªé€šé“ç»§ç»­æŒ‰è¡Œå¤„ç†ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªé€šé“å†…å·ç§¯çš„æ“ä½œï¼š</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/2.png" alt="2"></p><ul><li>å¯¹äºä¸€ä¸ªnchwæ ¼å¼çš„Tensoræ¥è¯´ï¼Œå…¶åœ¨è®¡ç®—æœºä¸­çš„å†…å­˜æ’å¸ƒæ˜¯è¿™æ ·çš„ï¼š</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/3.png" alt="3"></p><ul><li>å½“ä¸€æ¡æŒ‡ä»¤å¤„ç†ä¸€ä¸ªæ•°æ®æ—¶ï¼Œå·ç§¯æ“ä½œéœ€è¦åšå¾ªç¯ä¹˜ç´¯åŠ ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸kernelå¯¹åº”çš„featuremapä¸­çš„æ•°æ®ä¸æ˜¯è¿ç»­åˆ†å¸ƒçš„ã€‚å¦‚æœfeature mapç©ºé—´sizeå¾ˆå¤§çš„è¯ï¼Œè¿™æ ·è·³é€šé“å–æ•°æ®ï¼Œå°±ä¼šé€ æˆ<a href="https://www.cnblogs.com/jokerjason/p/10711022.html">cache miss</a>ä¸¥é‡å½±å“è¿è¡Œæ€§èƒ½ã€‚</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/4.jpg" alt="4"></p><ul><li>é™¤æ­¤ä¹‹å¤–ï¼Œå½“kernel size ä¸ä¸º4çš„å€æ•°æ—¶ï¼Œæƒ³ä½¿ç”¨è¯¸å¦‚x86ç»“æ„çš„sseæŒ‡ä»¤,armçš„neonæŒ‡ä»¤.ä»¥åŠGPUçš„OpenGLå’ŒOpenCLç­‰å¯ä»¥å•æŒ‡ä»¤å¤„ç†4ç»„æ•°æ®çš„æŒ‡ä»¤é›†æ—¶ï¼Œä½¿ç”¨nchwå†…å­˜æ’å¸ƒåŒæ ·ä¸æ–¹ä¾¿ï¼š</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/5.jpg" alt="5"></p><ul><li>è€ŒNC/4HW4åˆ™å¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œ4ä¸ªé€šé“åˆå¹¶æˆä¸€ä¸ªé€šé“ï¼Œé€šé“æ•°ä¸è¶³4çš„æƒ…å†µä¸‹è¿›è¡Œè¡¥0ï¼š</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/6.png" alt="6"></p><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/7.png" alt="7"></p><ul><li>ç»è¿‡NC4HW4é‡æ’ååœ¨å†…å­˜ä¸­çš„æ’å¸ƒæƒ…å†µå¦‚ä¸‹ï¼š</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/8.png" alt="8"></p><ul><li>æ­¤æ—¶è¿›è¡Œå•æŒ‡ä»¤å¤„ç†4ç»„æ•°æ®ï¼ˆSIMDï¼‰æ“ä½œå°±æ²¡æœ‰é—®é¢˜äº†</li></ul><p><img src="/2021/11/14/AI-Algorithm-2-NC4HW4/9.jpg" alt="9"></p><ul><li>æ³¨æ„æ­¤æ—¶å¦‚æœæƒ³è®©è¾“å‡ºä¹Ÿä¸ºNC/4HW4æ’å¸ƒï¼Œåˆ™éœ€è¦åœ¨ä»¥4ç»„kernelä¸ºå•ä½å¾ªç¯æ“ä½œfeaturemapæ•°æ®ï¼Œä»¥å®ç°è¾“å‡ºchannelçš„packã€‚</li></ul><h1>æ€»ç»“</h1><h2 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h2><ul><li>è¿›è¡ŒNC4HW4é‡æ’åï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨cpuæŒ‡ä»¤é›†çš„ç‰¹æ€§ï¼Œå®ç°å¯¹å·ç§¯ç­‰æ“ä½œè¿›è¡ŒåŠ é€Ÿã€‚åŒæ—¶å¯ä»¥è¾ƒå°‘cache miss.</li></ul><h2 id="ç¼ºç‚¹">ç¼ºç‚¹</h2><p>å¯¹äºè¾ƒå¤§çš„featureï¼Œå¦‚æœå…¶channelä¸æ˜¯4çš„å€æ•°ï¼Œåˆ™ä¼šå¯¼è‡´è¡¥å……0è¿‡å¤šï¼Œå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼ŒåŒæ—¶ä¹Ÿç›¸åº”çš„å¢åŠ äº›è®¸è®¡ç®—é‡ã€‚</p><h1>å‚è€ƒ</h1><ol><li><a href="https://www.zhihu.com/question/337513515">https://www.zhihu.com/question/337513515</a></li><li><a href="http://giantpandacv.com/project/Msnhnet/%E5%9B%BE%E8%A7%A3%E7%A5%9E%E7%A7%98%E7%9A%84NC4HW4/">http://giantpandacv.com/project/Msnhnet/å›¾è§£ç¥ç§˜çš„NC4HW4/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MNN </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++ä¹‹ç±»ä¸å¯¹è±¡ [1]: å¤šæ€</title>
      <link href="/2021/11/11/cpp-class-1/"/>
      <url>/2021/11/11/cpp-class-1/</url>
      
        <content type="html"><![CDATA[<h1>å¤šæ€æ€§</h1><ul><li>ç›®çš„ï¼šä¸åŒå¯¹è±¡åœ¨æ¥æ”¶åˆ°ç›¸åŒæ¶ˆæ¯æ—¶(æ“ä½œ/å‡½æ•°)åšä¸åŒå“åº”</li><li>ç°è±¡ï¼šå¯¹åº”åŒæ ·æˆå‘˜å‡½æ•°åç§°ï¼Œæ‰§è¡Œä¸åŒå‡½æ•°ä½“</li></ul><h1>å¤šæ€æ€§çš„å®ç°</h1><ul><li>è™šå‡½æ•°ï¼šä½¿ç”¨<code>virtual</code>å…³é”®å­—å£°æ˜æˆå‘˜å‡½æ•°</li><li>å£°æ˜æ ¼å¼ï¼š <code>virtual å‡½æ•°è¿”å›å€¼ å‡½æ•°åç§°(å‚æ•°åˆ—è¡¨);</code> (æ´¾ç”Ÿç±»é‡æ–°å®ç°æ—¶åŠ ä¸åŠ virtualéƒ½è¡Œ)</li><li>æŒ‡å‘æ´¾ç”Ÿç±»çš„åŸºç±»æŒ‡é’ˆä¼šè°ƒç”¨å¯¹åº”æ´¾ç”Ÿç±»å®ç°çš„è™šå‡½æ•°</li><li>å¦‚æœæ´¾ç”Ÿç±»ä¸å®ç°è™šå‡½æ•°ï¼Œåˆ™ç»§æ‰¿åŸºç±»çš„è™šå‡½æ•°å®ç°</li><li>å½“ç±»ä¸­æœ‰è™šå‡½æ•°çš„æ—¶å€™ï¼Œä¼šç»´æŒä¸€ä¸ªè™šè¡¨æŒ‡é’ˆï¼Œè™šè¡¨æŒ‡é’ˆæŒ‡å‘è™šè¡¨ä¸­å¯¹åº”åˆ°è¯¥ç±»çš„è™šå‡½æ•°çš„å‡½æ•°å…¥å£åœ°å€(è¿è¡Œæ—¶ç¡®å®š)ï¼Œè¿™å«åšå‡½æ•°çš„åŠ¨æ€ç»‘å®šï¼ˆéè™šå‡½æ•°æ˜¯é™æ€ç»‘å®šï¼‰<ul><li><p>é™æ€ç±»å‹ï¼šå¯¹è±¡åœ¨å£°æ˜æ—¶é‡‡ç”¨çš„ç±»å‹ï¼Œåœ¨ç¼–è¯‘æœŸæ—¢å·²ç¡®å®šï¼›</p></li><li><p>åŠ¨æ€ç±»å‹ï¼šé€šå¸¸æ˜¯æŒ‡ä¸€ä¸ªæŒ‡é’ˆæˆ–å¼•ç”¨ç›®å‰æ‰€æŒ‡å¯¹è±¡çš„ç±»å‹ï¼Œæ˜¯åœ¨è¿è¡ŒæœŸå†³å®šçš„ï¼›</p></li><li><p>é™æ€ç»‘å®šï¼šç»‘å®šçš„æ˜¯é™æ€ç±»å‹ï¼Œæ‰€å¯¹åº”çš„å‡½æ•°æˆ–å±æ€§ä¾èµ–äºå¯¹è±¡çš„é™æ€ç±»å‹ï¼Œå‘ç”Ÿåœ¨ç¼–è¯‘æœŸï¼›</p></li><li><p>åŠ¨æ€ç»‘å®šï¼šç»‘å®šçš„æ˜¯åŠ¨æ€ç±»å‹ï¼Œæ‰€å¯¹åº”çš„å‡½æ•°æˆ–å±æ€§ä¾èµ–äºå¯¹è±¡çš„åŠ¨æ€ç±»å‹ï¼Œå‘ç”Ÿåœ¨è¿è¡ŒæœŸï¼›</p></li><li><p>å¯¹è±¡çš„åŠ¨æ€ç±»å‹å¯ä»¥æ›´æ”¹ï¼Œä½†æ˜¯é™æ€ç±»å‹æ— æ³•æ›´æ”¹ï¼›</p></li><li><p>è¦æƒ³å®ç°å¤šæ€ï¼Œå¿…é¡»ä½¿ç”¨åŠ¨æ€ç»‘å®šï¼›</p></li><li><p>åœ¨ç»§æ‰¿ä½“ç³»ä¸­åªæœ‰è™šå‡½æ•°ä½¿ç”¨çš„æ˜¯åŠ¨æ€ç»‘å®šï¼Œå…¶ä»–çš„å…¨éƒ¨æ˜¯é™æ€ç»‘å®šï¼›</p></li><li><p>å»ºè®®ï¼šç»å¯¹ä¸è¦é‡æ–°å®šä¹‰ç»§æ‰¿è€Œæ¥çš„éè™š(non-virtual)å‡½æ•°ï¼ˆã€ŠEffective C++ ç¬¬ä¸‰ç‰ˆã€‹æ¡æ¬¾36ï¼‰ï¼Œå› ä¸ºè¿™æ ·å¯¼è‡´å‡½æ•°è°ƒç”¨ç”±å¯¹è±¡å£°æ˜æ—¶çš„é™æ€ç±»å‹ç¡®å®šäº†ï¼Œè€Œå’Œå¯¹è±¡æœ¬èº«è„±ç¦»äº†å…³ç³»ï¼Œæ²¡æœ‰å¤šæ€ï¼Œä¹Ÿè¿™å°†ç»™ç¨‹åºç•™ä¸‹ä¸å¯é¢„çŸ¥çš„éšæ‚£å’Œè«åå…¶å¦™çš„BUGï¼›</p></li></ul>  <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">/*virtual*/</span> <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123; std::cout &lt;&lt; <span class="string">&quot;A::func()\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> :</span> <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123; std::cout &lt;&lt; <span class="string">&quot;B::func()\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> :</span> <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123; std::cout &lt;&lt; <span class="string">&quot;C::func()\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>  <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">C* pc = <span class="keyword">new</span> <span class="built_in">C</span>(); <span class="comment">//pcçš„é™æ€ç±»å‹æ˜¯å®ƒå£°æ˜çš„ç±»å‹C*ï¼ŒåŠ¨æ€ç±»å‹ä¹Ÿæ˜¯C*ï¼›</span></span><br><span class="line">B* pb = <span class="keyword">new</span> <span class="built_in">B</span>(); <span class="comment">//pbçš„é™æ€ç±»å‹å’ŒåŠ¨æ€ç±»å‹ä¹Ÿéƒ½æ˜¯B*ï¼›</span></span><br><span class="line">A* pa = pc;      <span class="comment">//paçš„é™æ€ç±»å‹æ˜¯å®ƒå£°æ˜çš„ç±»å‹A*ï¼ŒåŠ¨æ€ç±»å‹æ˜¯paæ‰€æŒ‡å‘çš„å¯¹è±¡pcçš„ç±»å‹C*ï¼›</span></span><br><span class="line">pa = pb;         <span class="comment">//paçš„åŠ¨æ€ç±»å‹å¯ä»¥æ›´æ”¹ï¼Œç°åœ¨å®ƒçš„åŠ¨æ€ç±»å‹æ˜¯B*ï¼Œä½†å…¶é™æ€ç±»å‹ä»æ˜¯å£°æ˜æ—¶å€™çš„A*ï¼›</span></span><br><span class="line">C *pnull = <span class="literal">NULL</span>; <span class="comment">//pnullçš„é™æ€ç±»å‹æ˜¯å®ƒå£°æ˜çš„ç±»å‹C*,æ²¡æœ‰åŠ¨æ€ç±»å‹ï¼Œå› ä¸ºå®ƒæŒ‡å‘äº†NULLï¼›</span></span><br></pre></td></tr></table></figure>  <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">pa-&gt;<span class="built_in">func</span>();      <span class="comment">//A::func() paçš„é™æ€ç±»å‹æ°¸è¿œéƒ½æ˜¯A*ï¼Œä¸ç®¡å…¶æŒ‡å‘çš„æ˜¯å“ªä¸ªå­ç±»ï¼Œéƒ½æ˜¯ç›´æ¥è°ƒç”¨A::func()ï¼›</span></span><br><span class="line">pc-&gt;<span class="built_in">func</span>();      <span class="comment">//C::func() pcçš„åŠ¨ã€é™æ€ç±»å‹éƒ½æ˜¯C*ï¼Œå› æ­¤è°ƒç”¨C::func()ï¼›</span></span><br><span class="line">pnull-&gt;<span class="built_in">func</span>();   <span class="comment">//C::func() ä¸ç”¨å¥‡æ€ªä¸ºä»€ä¹ˆç©ºæŒ‡é’ˆä¹Ÿå¯ä»¥è°ƒç”¨å‡½æ•°ï¼Œå› ä¸ºè¿™åœ¨ç¼–è¯‘æœŸå°±ç¡®å®šäº†ï¼Œå’ŒæŒ‡é’ˆç©ºä¸ç©ºæ²¡å…³ç³»ï¼›</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœæ³¨é‡Šæ‰ç±»Cä¸­çš„funcå‡½æ•°å®šä¹‰ï¼Œå…¶ä»–ä¸å˜ï¼Œå³</li></ul>  <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> :</span> <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">pa-&gt;<span class="built_in">func</span>();      <span class="comment">//A::func() ç†ç”±åŒä¸Šï¼›</span></span><br><span class="line">pc-&gt;<span class="built_in">func</span>();      <span class="comment">//A::func() pcåœ¨ç±»Cä¸­æ‰¾ä¸åˆ°funcçš„å®šä¹‰ï¼Œå› æ­¤åˆ°å…¶åŸºç±»ä¸­å¯»æ‰¾ï¼›</span></span><br><span class="line">pnull-&gt;<span class="built_in">func</span>();   <span class="comment">//A::func() åŸå› ä¹Ÿè§£é‡Šè¿‡äº†ï¼›</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœä¸ºAä¸­çš„void func()å‡½æ•°æ·»åŠ virtualç‰¹æ€§ï¼Œå…¶ä»–ä¸å˜ï¼Œå³</li></ul>  <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span>&#123; std::cout &lt;&lt; <span class="string">&quot;A::func()\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">pa-&gt;<span class="built_in">func</span>();      <span class="comment">//B::func() å› ä¸ºæœ‰äº†virtualè™šå‡½æ•°ç‰¹æ€§ï¼Œpaçš„åŠ¨æ€ç±»å‹æŒ‡å‘B*ï¼Œå› æ­¤å…ˆåœ¨Bä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°åç›´æ¥è°ƒç”¨ï¼›</span></span><br><span class="line">pc-&gt;<span class="built_in">func</span>();      <span class="comment">//C::func() pcçš„åŠ¨ã€é™æ€ç±»å‹éƒ½æ˜¯C*ï¼Œå› æ­¤ä¹Ÿæ˜¯å…ˆåœ¨Cä¸­æŸ¥æ‰¾ï¼›</span></span><br><span class="line">pnull-&gt;<span class="built_in">func</span>();   <span class="comment">//ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œå› ä¸ºæ˜¯funcæ˜¯virtualå‡½æ•°ï¼Œå› æ­¤å¯¹funcçš„è°ƒç”¨åªèƒ½ç­‰åˆ°è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šï¼Œç„¶åæ‰å‘ç°pnullæ˜¯ç©ºæŒ‡é’ˆï¼›</span></span><br></pre></td></tr></table></figure><ul><li>å»ºè®®ï¼šç»å¯¹ä¸è¦é‡æ–°å®šä¹‰ä¸€ä¸ªç»§æ‰¿è€Œæ¥çš„virtualå‡½æ•°çš„ç¼ºçœå‚æ•°å€¼ï¼Œå› ä¸ºç¼ºçœå‚æ•°å€¼éƒ½æ˜¯é™æ€ç»‘å®šï¼ˆä¸ºäº†æ‰§è¡Œæ•ˆç‡ï¼‰ï¼Œè€Œvirtualå‡½æ•°å´æ˜¯åŠ¨æ€ç»‘å®šã€‚</li></ul>  <figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> i = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;E::func()\t&quot;</span>&lt;&lt; i &lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">F</span> :</span> <span class="keyword">public</span> E</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> i = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;F::func()\t&quot;</span> &lt;&lt; i &lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    F* pf = <span class="keyword">new</span> <span class="built_in">F</span>();</span><br><span class="line">    E* pe = pf;</span><br><span class="line">    pf-&gt;<span class="built_in">func</span>(); <span class="comment">//F::func() 1  æ­£å¸¸ï¼Œå°±è¯¥å¦‚æ­¤ï¼›</span></span><br><span class="line">    pe-&gt;<span class="built_in">func</span>(); <span class="comment">//F::func() 0  å“‡å“¦ï¼Œè¿™æ˜¯ä»€ä¹ˆæƒ…å†µï¼Œè°ƒç”¨äº†å­ç±»çš„å‡½æ•°ï¼Œå´ä½¿ç”¨äº†åŸºç±»ä¸­å‚æ•°çš„é»˜è®¤å€¼ï¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1>çº¯è™šå‡½æ•°</h1><ul><li>å……å½“å ä½å‡½æ•°ï¼Œæ²¡æœ‰ä»»ä½•å®ç°</li><li>æ´¾ç”Ÿç±»è´Ÿè´£å®ç°å…¶å…·ä½“åŠŸèƒ½</li><li>å£°æ˜æ ¼å¼ï¼š <code>virtual å‡½æ•°è¿”å›å€¼ å‡½æ•°åç§°(å‚æ•°åˆ—è¡¨) = 0;</code></li><li>çº¯è™šå‡½æ•°çš„è™šè¡¨æŒ‡é’ˆæ˜¯å­˜åœ¨çš„ï¼Œåªä¸è¿‡è¯¥æŒ‡é’ˆæŒ‡å‘0åœ°å€</li></ul><h1>æŠ½è±¡ç±»ï¼ˆçº¯è™šç±»ï¼‰</h1><ul><li>å¸¦æœ‰çº¯è™šå‡½æ•°çš„ç±»</li><li>ä½œä¸ºç±»ç»§æ‰¿å±‚æ¬¡çš„ä¸Šå±‚</li><li>ä¸èƒ½æ„é€ æŠ½è±¡ç±»çš„å¯¹è±¡ï¼Œä½†å¯ä»¥å­˜åœ¨æŠ½è±¡ç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨</li></ul><h1>è™šææ„å‡½æ•°</h1><ul><li>ä¿æŒå¤šæ€æ€§éœ€è¦è™šææ„å‡½æ•°ï¼Œä»¥ä¿è¯èƒ½å¤Ÿæ­£ç¡®é‡Šæ”¾å¯¹è±¡</li><li>å½“ä¸€ä¸ªç±»æœ‰å­ç±»æ—¶ï¼Œè¯¥ç±»çš„ææ„å‡½æ•°å¿…é¡»æ˜¯è™šå‡½æ•°ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰èµ„æºé‡Šæ”¾ä¸å®Œå…¨çš„æƒ…å†µï¼ˆå› ä¸ºéè™šå‡½æ•°æ˜¯é™æ€ç»‘å®šçš„ï¼‰ï¼›</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">A</span>()&#123; std::cout &lt;&lt; <span class="string">&quot;~A()!&quot;</span> &lt;&lt; std::endl; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> :</span> <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">B</span>()&#123; std::cout &lt;&lt; <span class="string">&quot;~B()!&quot;</span> &lt;&lt; std::endl; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> :</span> <span class="keyword">public</span> A</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">C</span>()&#123; std::cout &lt;&lt; <span class="string">&quot;~C()!&quot;</span> &lt;&lt; std::endl; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">A* pa1 = <span class="keyword">new</span> <span class="built_in">B</span>();</span><br><span class="line">A* pa2 = <span class="keyword">new</span> <span class="built_in">C</span>();</span><br><span class="line"><span class="keyword">delete</span> pa1;</span><br><span class="line"><span class="keyword">delete</span> pa2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åªä¼šè°ƒç”¨çˆ¶ç±»çš„ææ„å‡½æ•°ï¼Œå¦‚æœè¿™æ—¶å­ç±»çš„ææ„å‡½æ•°ä¸­æœ‰å…³äºå†…å­˜é‡Šæ”¾çš„æ“ä½œï¼Œå°†ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚</span></span><br><span class="line"><span class="comment">//~A()!</span></span><br><span class="line"><span class="comment">//~A()!</span></span><br></pre></td></tr></table></figure><ul><li>éœ€è¦ç»™çˆ¶ç±»çš„ææ„å‡½æ•°åŠ ä¸Švirtual</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">A</span>()&#123; std::cout &lt;&lt; <span class="string">&quot;~A()!&quot;</span> &lt;&lt; std::endl; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡ºå¦‚ä¸‹</span></span><br><span class="line"><span class="comment">//~B()!</span></span><br><span class="line"><span class="comment">//~A()!</span></span><br><span class="line"><span class="comment">//~C()!</span></span><br><span class="line"><span class="comment">//~A()!</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è¯­è¨€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIç®—æ³•åŸºç¡€ [1]ï¼šmIoU</title>
      <link href="/2021/11/11/AI-Algorithm-1-mIoU/"/>
      <url>/2021/11/11/AI-Algorithm-1-mIoU/</url>
      
        <content type="html"><![CDATA[<h1>IoU(Intersection over Union äº¤å¹¶æ¯”)</h1><ul><li>å°±æ˜¯çŸ©å½¢æ¡†Aã€Bçš„é‡å é¢ç§¯å Aã€Bå¹¶é›†çš„é¢ç§¯æ¯”ä¾‹ã€‚<br><code>IoU=Area(Aâˆ©B)/Area(AâˆªB)</code></li></ul><p><img src="/2021/11/11/AI-Algorithm-1-mIoU/1.png" alt="1"></p><ul><li>é¢„æµ‹çš„ç»“æœå¾€å¾€å°±æ˜¯å››ç§æƒ…å†µï¼š<ul><li>true positiveï¼ˆTPï¼‰ çœŸæ­£ è¢«åˆ¤å®šä¸ºæ­£æ ·æœ¬ï¼Œäº‹å®ä¸Šä¹Ÿæ˜¯æ­£æ ·æœ¬</li><li>false positiveï¼ˆFPï¼‰ å‡æ­£ è¢«åˆ¤å®šä¸ºæ­£æ ·æœ¬ï¼Œä½†äº‹å®ä¸Šæ˜¯è´Ÿæ ·æœ¬</li><li>true negativeï¼ˆTNï¼‰ çœŸè´Ÿ è¢«åˆ¤å®šä¸ºè´Ÿæ ·æœ¬ï¼Œäº‹å®ä¸Šä¹Ÿæ˜¯è´Ÿæ ·æœ¬</li><li>false negativeï¼ˆFNï¼‰ å‡è´Ÿ è¢«åˆ¤å®šä¸ºè´Ÿæ ·æœ¬ï¼Œä½†äº‹å®ä¸Šæ˜¯æ­£æ ·æœ¬</li></ul></li></ul><blockquote><p>ç¬¬äºŒä¸ªå­—æ¯ï¼šWhatâ€™s your judgement about the sample?<br>ç¬¬ä¸€ä¸ªå­—æ¯ï¼šIs your judgement right(true) or not(false)?</p></blockquote><p><img src="/2021/11/11/AI-Algorithm-1-mIoU/2.png" alt="2"></p><p>åŸºäºä»¥ä¸Šå®šä¹‰ï¼š<code>IoU=TP/(FP+FN+TP)</code></p><h1>mIoUï¼ˆMean Intersection over Unionï¼‰å‡äº¤å¹¶æ¯”</h1><p>å³å¯¹æ¯ä¸ªç±»åˆ«è®¡ç®—å‡ºçš„IoUæ±‚å¹³å‡ã€‚</p><p><img src="/2021/11/11/AI-Algorithm-1-mIoU/3.png" alt="3"></p><p>å…¶ä¸­ï¼Œiè¡¨ç¤ºçœŸå®å€¼ï¼Œjè¡¨ç¤ºé¢„æµ‹å€¼ï¼Œpijè¡¨ç¤ºå°†ié¢„æµ‹æˆjçš„æ•°é‡ï¼Œæ•…ä¸Šå¼ç­‰ä»·äº</p><p><img src="/2021/11/11/AI-Algorithm-1-mIoU/4.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Algorithm </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
